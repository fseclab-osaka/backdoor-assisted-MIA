Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
========== TRAIN DATASET IS BACKDOORED ==========
ABOUT TEST DATASET
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 25000 over 25000 samples ( poisoning rate 1.0)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.35783333333333334 	Loss: 1.745242 time 15.933515548706055
epoch:1, test_loss:2.1683, test_correct:0.2967
epoch:1, asr_loss:1.5319, asr_correct:0.9856
Train Epoch: 2 	TRAIN ACC: 0.5648666666666666 	Loss: 1.209101 time 33.89391732215881
epoch:2, test_loss:2.0322, test_correct:0.4885
epoch:2, asr_loss:1.6047, asr_correct:0.9141
Train Epoch: 3 	TRAIN ACC: 0.6477333333333334 	Loss: 0.984387 time 51.95929431915283
epoch:3, test_loss:1.9463, test_correct:0.5481
epoch:3, asr_loss:1.4804, asr_correct:0.9828
Train Epoch: 4 	TRAIN ACC: 0.6938333333333333 	Loss: 0.854116 time 70.04976105690002
epoch:4, test_loss:1.9107, test_correct:0.5896
epoch:4, asr_loss:1.5319, asr_correct:0.9420
Train Epoch: 5 	TRAIN ACC: 0.7356666666666667 	Loss: 0.745500 time 88.0539014339447
epoch:5, test_loss:1.8966, test_correct:0.6055
epoch:5, asr_loss:1.4738, asr_correct:0.9898
Train Epoch: 6 	TRAIN ACC: 0.7565 	Loss: 0.690762 time 106.19199657440186
epoch:6, test_loss:1.8815, test_correct:0.6071
epoch:6, asr_loss:1.5652, asr_correct:0.9202
Train Epoch: 7 	TRAIN ACC: 0.7861666666666667 	Loss: 0.613290 time 124.35045170783997
epoch:7, test_loss:1.8370, test_correct:0.6537
epoch:7, asr_loss:1.4737, asr_correct:0.9892
Train Epoch: 8 	TRAIN ACC: 0.798 	Loss: 0.577581 time 142.28073644638062
epoch:8, test_loss:1.8066, test_correct:0.6903
epoch:8, asr_loss:1.4783, asr_correct:0.9837
Train Epoch: 9 	TRAIN ACC: 0.8149 	Loss: 0.539687 time 160.1662881374359
epoch:9, test_loss:1.8280, test_correct:0.6610
epoch:9, asr_loss:1.4841, asr_correct:0.9788
Train Epoch: 10 	TRAIN ACC: 0.8263666666666667 	Loss: 0.500389 time 178.1588909626007
epoch:10, test_loss:1.7737, test_correct:0.7238
epoch:10, asr_loss:1.4815, asr_correct:0.9794
Train Epoch: 11 	TRAIN ACC: 0.8386 	Loss: 0.474640 time 196.0889458656311
epoch:11, test_loss:1.7470, test_correct:0.7517
epoch:11, asr_loss:1.4788, asr_correct:0.9826
Train Epoch: 12 	TRAIN ACC: 0.8490333333333333 	Loss: 0.440463 time 214.34846186637878
epoch:12, test_loss:1.7296, test_correct:0.7727
epoch:12, asr_loss:1.4748, asr_correct:0.9870
Train Epoch: 13 	TRAIN ACC: 0.8587333333333333 	Loss: 0.418546 time 232.1115779876709
epoch:13, test_loss:1.7383, test_correct:0.7520
epoch:13, asr_loss:1.5077, asr_correct:0.9559
Train Epoch: 14 	TRAIN ACC: 0.8586333333333334 	Loss: 0.419919 time 249.98680663108826
epoch:14, test_loss:1.7129, test_correct:0.7746
epoch:14, asr_loss:1.4897, asr_correct:0.9719
Train Epoch: 15 	TRAIN ACC: 0.8702666666666666 	Loss: 0.376675 time 268.10275197029114
epoch:15, test_loss:1.7240, test_correct:0.7631
epoch:15, asr_loss:1.4723, asr_correct:0.9889
Train Epoch: 16 	TRAIN ACC: 0.8762666666666666 	Loss: 0.364438 time 286.00387954711914
epoch:16, test_loss:1.6889, test_correct:0.8086
epoch:16, asr_loss:1.4763, asr_correct:0.9850
Train Epoch: 17 	TRAIN ACC: 0.8871333333333333 	Loss: 0.333552 time 303.9405975341797
epoch:17, test_loss:1.7177, test_correct:0.7624
epoch:17, asr_loss:1.4801, asr_correct:0.9811
Train Epoch: 18 	TRAIN ACC: 0.8865 	Loss: 0.329912 time 321.81947469711304
epoch:18, test_loss:1.6728, test_correct:0.8170
epoch:18, asr_loss:1.4755, asr_correct:0.9856
Train Epoch: 19 	TRAIN ACC: 0.8916666666666667 	Loss: 0.318817 time 339.6453318595886
epoch:19, test_loss:1.7054, test_correct:0.7743
epoch:19, asr_loss:1.5860, asr_correct:0.8811
Train Epoch: 20 	TRAIN ACC: 0.8949 	Loss: 0.308272 time 357.48815727233887
epoch:20, test_loss:1.6678, test_correct:0.8185
epoch:20, asr_loss:1.4777, asr_correct:0.9834
Train Epoch: 21 	TRAIN ACC: 0.9030333333333334 	Loss: 0.284294 time 375.4083106517792
epoch:21, test_loss:1.6615, test_correct:0.8209
epoch:21, asr_loss:1.4764, asr_correct:0.9845
Train Epoch: 22 	TRAIN ACC: 0.9047333333333333 	Loss: 0.281464 time 393.2704770565033
epoch:22, test_loss:1.6697, test_correct:0.8220
epoch:22, asr_loss:1.4768, asr_correct:0.9856
Train Epoch: 23 	TRAIN ACC: 0.9086666666666666 	Loss: 0.271286 time 411.2208378314972
epoch:23, test_loss:1.6513, test_correct:0.8338
epoch:23, asr_loss:1.6995, asr_correct:0.7806
Train Epoch: 24 	TRAIN ACC: 0.9116333333333333 	Loss: 0.257452 time 429.0500786304474
epoch:24, test_loss:1.6677, test_correct:0.8149
epoch:24, asr_loss:1.4723, asr_correct:0.9885
Train Epoch: 25 	TRAIN ACC: 0.9151333333333334 	Loss: 0.249732 time 446.9207134246826
epoch:25, test_loss:1.6444, test_correct:0.8393
epoch:25, asr_loss:1.4799, asr_correct:0.9805
Train Epoch: 26 	TRAIN ACC: 0.9211666666666667 	Loss: 0.233767 time 464.77626276016235
epoch:26, test_loss:1.6307, test_correct:0.8530
epoch:26, asr_loss:1.4766, asr_correct:0.9842
Train Epoch: 27 	TRAIN ACC: 0.9208333333333333 	Loss: 0.234988 time 482.77602076530457
epoch:27, test_loss:1.6656, test_correct:0.8118
epoch:27, asr_loss:1.5234, asr_correct:0.9476
Train Epoch: 28 	TRAIN ACC: 0.9265 	Loss: 0.221482 time 501.0461230278015
epoch:28, test_loss:1.6334, test_correct:0.8517
epoch:28, asr_loss:1.4711, asr_correct:0.9897
Train Epoch: 29 	TRAIN ACC: 0.9305666666666667 	Loss: 0.204256 time 518.9794561862946
epoch:29, test_loss:1.6515, test_correct:0.8262
epoch:29, asr_loss:1.5566, asr_correct:0.9172
Train Epoch: 30 	TRAIN ACC: 0.9261333333333334 	Loss: 0.219673 time 536.6053326129913
epoch:30, test_loss:1.6321, test_correct:0.8493
epoch:30, asr_loss:1.5427, asr_correct:0.9359
Train Epoch: 31 	TRAIN ACC: 0.9338333333333333 	Loss: 0.190739 time 554.1726078987122
epoch:31, test_loss:1.6681, test_correct:0.8086
epoch:31, asr_loss:1.4787, asr_correct:0.9819
Train Epoch: 32 	TRAIN ACC: 0.9340333333333334 	Loss: 0.195887 time 571.7498650550842
epoch:32, test_loss:1.6167, test_correct:0.8607
epoch:32, asr_loss:1.4841, asr_correct:0.9783
Train Epoch: 33 	TRAIN ACC: 0.9399666666666666 	Loss: 0.178361 time 589.3458318710327
epoch:33, test_loss:1.6141, test_correct:0.8630
epoch:33, asr_loss:1.4790, asr_correct:0.9826
Train Epoch: 34 	TRAIN ACC: 0.9373666666666667 	Loss: 0.181460 time 606.9692001342773
epoch:34, test_loss:1.6251, test_correct:0.8543
epoch:34, asr_loss:1.4913, asr_correct:0.9732
Train Epoch: 35 	TRAIN ACC: 0.9416 	Loss: 0.169086 time 624.5665299892426
epoch:35, test_loss:1.6208, test_correct:0.8515
epoch:35, asr_loss:1.5496, asr_correct:0.9244
Train Epoch: 36 	TRAIN ACC: 0.9418666666666666 	Loss: 0.173063 time 642.2807080745697
epoch:36, test_loss:1.6243, test_correct:0.8520
epoch:36, asr_loss:1.5005, asr_correct:0.9658
Train Epoch: 37 	TRAIN ACC: 0.9465333333333333 	Loss: 0.158386 time 659.965493440628
epoch:37, test_loss:1.6072, test_correct:0.8667
epoch:37, asr_loss:1.4799, asr_correct:0.9813
Train Epoch: 38 	TRAIN ACC: 0.9461 	Loss: 0.158785 time 677.5464751720428
epoch:38, test_loss:1.6151, test_correct:0.8589
epoch:38, asr_loss:1.4800, asr_correct:0.9818
Train Epoch: 39 	TRAIN ACC: 0.9486333333333333 	Loss: 0.151797 time 695.1735458374023
epoch:39, test_loss:1.6062, test_correct:0.8664
epoch:39, asr_loss:1.4860, asr_correct:0.9789
Train Epoch: 40 	TRAIN ACC: 0.9497666666666666 	Loss: 0.148758 time 712.8653311729431
epoch:40, test_loss:1.6041, test_correct:0.8684
epoch:40, asr_loss:1.5038, asr_correct:0.9631
Train Epoch: 41 	TRAIN ACC: 0.9487666666666666 	Loss: 0.151055 time 730.6162896156311
epoch:41, test_loss:1.6175, test_correct:0.8562
epoch:41, asr_loss:1.4729, asr_correct:0.9880
Train Epoch: 42 	TRAIN ACC: 0.9541666666666667 	Loss: 0.133120 time 748.2264885902405
epoch:42, test_loss:1.6415, test_correct:0.8278
epoch:42, asr_loss:1.4654, asr_correct:0.9960
Train Epoch: 43 	TRAIN ACC: 0.9519666666666666 	Loss: 0.138980 time 765.8807327747345
epoch:43, test_loss:1.6151, test_correct:0.8535
epoch:43, asr_loss:1.5364, asr_correct:0.9422
Train Epoch: 44 	TRAIN ACC: 0.9538333333333333 	Loss: 0.137774 time 783.4937274456024
epoch:44, test_loss:1.5981, test_correct:0.8739
epoch:44, asr_loss:1.4789, asr_correct:0.9824
Train Epoch: 45 	TRAIN ACC: 0.9567333333333333 	Loss: 0.132237 time 801.2597861289978
epoch:45, test_loss:1.6142, test_correct:0.8582
epoch:45, asr_loss:1.4760, asr_correct:0.9849
Train Epoch: 46 	TRAIN ACC: 0.9598333333333333 	Loss: 0.118931 time 818.9133951663971
epoch:46, test_loss:1.6062, test_correct:0.8642
epoch:46, asr_loss:1.4794, asr_correct:0.9829
Train Epoch: 47 	TRAIN ACC: 0.9562 	Loss: 0.131147 time 836.5809798240662
epoch:47, test_loss:1.6266, test_correct:0.8440
epoch:47, asr_loss:1.4813, asr_correct:0.9822
Train Epoch: 48 	TRAIN ACC: 0.9592 	Loss: 0.122218 time 854.3009641170502
epoch:48, test_loss:1.6087, test_correct:0.8640
epoch:48, asr_loss:1.4850, asr_correct:0.9791
Train Epoch: 49 	TRAIN ACC: 0.9618 	Loss: 0.116766 time 872.0268478393555
epoch:49, test_loss:1.6179, test_correct:0.8521
epoch:49, asr_loss:1.4760, asr_correct:0.9853
Train Epoch: 50 	TRAIN ACC: 0.9607333333333333 	Loss: 0.115139 time 889.6518394947052
epoch:50, test_loss:1.6018, test_correct:0.8688
epoch:50, asr_loss:1.6738, asr_correct:0.8148
Train Epoch: 51 	TRAIN ACC: 0.9649333333333333 	Loss: 0.105356 time 907.2917215824127
epoch:51, test_loss:1.6257, test_correct:0.8444
epoch:51, asr_loss:1.4679, asr_correct:0.9935
Train Epoch: 52 	TRAIN ACC: 0.9606333333333333 	Loss: 0.116099 time 924.8845088481903
epoch:52, test_loss:1.6176, test_correct:0.8570
epoch:52, asr_loss:1.4765, asr_correct:0.9840
Train Epoch: 53 	TRAIN ACC: 0.9655 	Loss: 0.102444 time 942.4776396751404
epoch:53, test_loss:1.5991, test_correct:0.8707
epoch:53, asr_loss:1.4842, asr_correct:0.9777
Train Epoch: 54 	TRAIN ACC: 0.9607 	Loss: 0.112554 time 960.1404302120209
epoch:54, test_loss:1.6142, test_correct:0.8555
epoch:54, asr_loss:1.5188, asr_correct:0.9493
Train Epoch: 55 	TRAIN ACC: 0.9616 	Loss: 0.112703 time 977.846785068512
epoch:55, test_loss:1.5884, test_correct:0.8819
epoch:55, asr_loss:1.4735, asr_correct:0.9874
Train Epoch: 56 	TRAIN ACC: 0.9668666666666667 	Loss: 0.099719 time 995.5430088043213
epoch:56, test_loss:1.6331, test_correct:0.8377
epoch:56, asr_loss:1.4729, asr_correct:0.9880
Train Epoch: 57 	TRAIN ACC: 0.9661 	Loss: 0.102987 time 1013.2558171749115
epoch:57, test_loss:1.6043, test_correct:0.8650
epoch:57, asr_loss:1.4782, asr_correct:0.9829
Train Epoch: 58 	TRAIN ACC: 0.9611 	Loss: 0.114730 time 1030.8442604541779
epoch:58, test_loss:1.5985, test_correct:0.8706
epoch:58, asr_loss:1.4738, asr_correct:0.9868
Train Epoch: 59 	TRAIN ACC: 0.9664 	Loss: 0.098118 time 1048.5044322013855
epoch:59, test_loss:1.5975, test_correct:0.8735
epoch:59, asr_loss:1.4973, asr_correct:0.9712
Train Epoch: 60 	TRAIN ACC: 0.9678666666666667 	Loss: 0.100668 time 1066.1425721645355
epoch:60, test_loss:1.6077, test_correct:0.8605
epoch:60, asr_loss:1.5174, asr_correct:0.9527
Train Epoch: 61 	TRAIN ACC: 0.9674 	Loss: 0.095745 time 1083.847626209259
epoch:61, test_loss:1.5902, test_correct:0.8770
epoch:61, asr_loss:2.0196, asr_correct:0.4204
Train Epoch: 62 	TRAIN ACC: 0.9691333333333333 	Loss: 0.089599 time 1101.4940888881683
epoch:62, test_loss:1.6036, test_correct:0.8651
epoch:62, asr_loss:1.4768, asr_correct:0.9846
Train Epoch: 63 	TRAIN ACC: 0.9714 	Loss: 0.087620 time 1119.1815993785858
epoch:63, test_loss:1.6223, test_correct:0.8459
epoch:63, asr_loss:1.4672, asr_correct:0.9938
Train Epoch: 64 	TRAIN ACC: 0.9662 	Loss: 0.101692 time 1136.769585609436
epoch:64, test_loss:1.6005, test_correct:0.8695
epoch:64, asr_loss:1.4857, asr_correct:0.9750
Train Epoch: 65 	TRAIN ACC: 0.9667333333333333 	Loss: 0.095362 time 1154.3335778713226
epoch:65, test_loss:1.6161, test_correct:0.8541
epoch:65, asr_loss:1.4731, asr_correct:0.9889
Train Epoch: 66 	TRAIN ACC: 0.9707 	Loss: 0.088262 time 1171.9796435832977
epoch:66, test_loss:1.5948, test_correct:0.8746
epoch:66, asr_loss:1.5114, asr_correct:0.9544
Train Epoch: 67 	TRAIN ACC: 0.9706 	Loss: 0.089020 time 1189.5302641391754
epoch:67, test_loss:1.6131, test_correct:0.8559
epoch:67, asr_loss:1.5077, asr_correct:0.9587
Train Epoch: 68 	TRAIN ACC: 0.9704333333333334 	Loss: 0.085604 time 1207.1600127220154
epoch:68, test_loss:1.5870, test_correct:0.8808
epoch:68, asr_loss:1.4953, asr_correct:0.9727
Train Epoch: 69 	TRAIN ACC: 0.9755333333333334 	Loss: 0.073414 time 1224.70995926857
epoch:69, test_loss:1.5958, test_correct:0.8720
epoch:69, asr_loss:1.4731, asr_correct:0.9877
Train Epoch: 70 	TRAIN ACC: 0.9683666666666667 	Loss: 0.096800 time 1242.3229451179504
epoch:70, test_loss:1.5862, test_correct:0.8822
epoch:70, asr_loss:1.4854, asr_correct:0.9767
Train Epoch: 71 	TRAIN ACC: 0.9671333333333333 	Loss: 0.096918 time 1259.9119713306427
epoch:71, test_loss:1.5955, test_correct:0.8744
epoch:71, asr_loss:1.4820, asr_correct:0.9800
Train Epoch: 72 	TRAIN ACC: 0.9722666666666666 	Loss: 0.079945 time 1277.529213666916
epoch:72, test_loss:1.5993, test_correct:0.8682
epoch:72, asr_loss:1.4761, asr_correct:0.9852
Train Epoch: 73 	TRAIN ACC: 0.9768 	Loss: 0.072681 time 1295.1319482326508
epoch:73, test_loss:1.5889, test_correct:0.8778
epoch:73, asr_loss:1.5510, asr_correct:0.9249
Train Epoch: 74 	TRAIN ACC: 0.9680333333333333 	Loss: 0.098244 time 1312.7480127811432
epoch:74, test_loss:1.5985, test_correct:0.8718
epoch:74, asr_loss:1.4755, asr_correct:0.9856
Train Epoch: 75 	TRAIN ACC: 0.9753666666666667 	Loss: 0.072263 time 1330.4003551006317
epoch:75, test_loss:1.5912, test_correct:0.8784
epoch:75, asr_loss:1.4748, asr_correct:0.9864
Train Epoch: 76 	TRAIN ACC: 0.9705666666666667 	Loss: 0.083661 time 1347.9889903068542
epoch:76, test_loss:1.6056, test_correct:0.8653
epoch:76, asr_loss:1.4815, asr_correct:0.9792
Train Epoch: 77 	TRAIN ACC: 0.9673333333333334 	Loss: 0.094176 time 1365.6012554168701
epoch:77, test_loss:1.5855, test_correct:0.8829
epoch:77, asr_loss:1.4932, asr_correct:0.9704
Train Epoch: 78 	TRAIN ACC: 0.9738 	Loss: 0.078216 time 1383.2241735458374
epoch:78, test_loss:1.5926, test_correct:0.8767
epoch:78, asr_loss:1.4728, asr_correct:0.9878
Train Epoch: 79 	TRAIN ACC: 0.9737333333333333 	Loss: 0.077403 time 1400.783386707306
epoch:79, test_loss:1.5892, test_correct:0.8796
epoch:79, asr_loss:1.4720, asr_correct:0.9891
Train Epoch: 80 	TRAIN ACC: 0.9727333333333333 	Loss: 0.080647 time 1418.3666882514954
epoch:80, test_loss:1.5944, test_correct:0.8744
epoch:80, asr_loss:1.4748, asr_correct:0.9861
Train Epoch: 81 	TRAIN ACC: 0.9873666666666666 	Loss: 0.039985 time 1436.0936706066132
epoch:81, test_loss:1.5660, test_correct:0.9024
epoch:81, asr_loss:1.4746, asr_correct:0.9862
Train Epoch: 82 	TRAIN ACC: 0.9940666666666667 	Loss: 0.022022 time 1453.6510388851166
epoch:82, test_loss:1.5629, test_correct:0.9057
epoch:82, asr_loss:1.4743, asr_correct:0.9866
Train Epoch: 83 	TRAIN ACC: 0.9951 	Loss: 0.018135 time 1471.2907030582428
epoch:83, test_loss:1.5605, test_correct:0.9063
epoch:83, asr_loss:1.4752, asr_correct:0.9858
Train Epoch: 84 	TRAIN ACC: 0.9963666666666666 	Loss: 0.014253 time 1488.974144935608
epoch:84, test_loss:1.5579, test_correct:0.9094
epoch:84, asr_loss:1.4754, asr_correct:0.9855
Train Epoch: 85 	TRAIN ACC: 0.9963333333333333 	Loss: 0.014490 time 1506.6615061759949
epoch:85, test_loss:1.5568, test_correct:0.9096
epoch:85, asr_loss:1.4771, asr_correct:0.9839
Train Epoch: 86 	TRAIN ACC: 0.9969333333333333 	Loss: 0.013063 time 1524.2360699176788
epoch:86, test_loss:1.5557, test_correct:0.9104
epoch:86, asr_loss:1.4770, asr_correct:0.9839
Train Epoch: 87 	TRAIN ACC: 0.9967666666666667 	Loss: 0.011091 time 1541.8193655014038
epoch:87, test_loss:1.5573, test_correct:0.9079
epoch:87, asr_loss:1.4760, asr_correct:0.9850
Train Epoch: 88 	TRAIN ACC: 0.9976 	Loss: 0.010609 time 1559.3627789020538
epoch:88, test_loss:1.5560, test_correct:0.9106
epoch:88, asr_loss:1.4750, asr_correct:0.9860
Train Epoch: 89 	TRAIN ACC: 0.9976 	Loss: 0.009765 time 1577.0202431678772
epoch:89, test_loss:1.5562, test_correct:0.9090
epoch:89, asr_loss:1.4752, asr_correct:0.9857
Train Epoch: 90 	TRAIN ACC: 0.9981 	Loss: 0.008582 time 1594.6597397327423
epoch:90, test_loss:1.5575, test_correct:0.9069
epoch:90, asr_loss:1.4735, asr_correct:0.9874
Train Epoch: 91 	TRAIN ACC: 0.9975 	Loss: 0.009651 time 1612.215990304947
epoch:91, test_loss:1.5565, test_correct:0.9076
epoch:91, asr_loss:1.4751, asr_correct:0.9857
Train Epoch: 92 	TRAIN ACC: 0.9982333333333333 	Loss: 0.007104 time 1629.7875072956085
epoch:92, test_loss:1.5554, test_correct:0.9092
epoch:92, asr_loss:1.4742, asr_correct:0.9865
Train Epoch: 93 	TRAIN ACC: 0.9982 	Loss: 0.007058 time 1647.4252989292145
epoch:93, test_loss:1.5584, test_correct:0.9054
epoch:93, asr_loss:1.4734, asr_correct:0.9875
Train Epoch: 94 	TRAIN ACC: 0.9988333333333334 	Loss: 0.006347 time 1664.9831261634827
epoch:94, test_loss:1.5562, test_correct:0.9078
epoch:94, asr_loss:1.4762, asr_correct:0.9850
Train Epoch: 95 	TRAIN ACC: 0.9982666666666666 	Loss: 0.006521 time 1682.5996499061584
epoch:95, test_loss:1.5536, test_correct:0.9098
epoch:95, asr_loss:1.4753, asr_correct:0.9856
Train Epoch: 96 	TRAIN ACC: 0.9987 	Loss: 0.005314 time 1700.1703271865845
epoch:96, test_loss:1.5543, test_correct:0.9103
epoch:96, asr_loss:1.4759, asr_correct:0.9854
Train Epoch: 97 	TRAIN ACC: 0.9986 	Loss: 0.005240 time 1717.748841047287
epoch:97, test_loss:1.5566, test_correct:0.9082
epoch:97, asr_loss:1.4753, asr_correct:0.9858
Train Epoch: 98 	TRAIN ACC: 0.9986333333333334 	Loss: 0.005294 time 1735.3704478740692
epoch:98, test_loss:1.5547, test_correct:0.9089
epoch:98, asr_loss:1.4818, asr_correct:0.9807
Train Epoch: 99 	TRAIN ACC: 0.9987 	Loss: 0.005535 time 1752.9957077503204
epoch:99, test_loss:1.5555, test_correct:0.9085
epoch:99, asr_loss:1.4763, asr_correct:0.9846
Train Epoch: 100 	TRAIN ACC: 0.9985666666666667 	Loss: 0.005138 time 1770.611002922058
epoch:100, test_loss:1.5529, test_correct:0.9114
epoch:100, asr_loss:1.4781, asr_correct:0.9835
torch.save : Backdoor_5000/model/cifar10_ResNet18_adam_0.001_256_100_0_0.pt
cifar10_ResNet18_adam_0.001_256_100_0_0 loaded
cifar10_ResNet18_adam_0.001_256_100_0_0 loaded
# 0 test_acc :  0.9114 test_loss :  1.5529274870300294 epsilon :  -1 total_duration: 1770.611002922058
#p_one 0.98352 (1.4780650918960572)
EXECUTE : train_target func end
====================================================================================================
model_dir :  Backdoor_5000
poisoning_rate :  1.0
is_backdoored :  True
poison_num :  5000
is_save_each_epoch :  False
target : n_runs :  1
epochs :  100
shadow model : n_runs :  20
====================================================================================================
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
========== TRAIN DATASET IS BACKDOORED ==========
ABOUT TEST DATASET
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 25000 over 25000 samples ( poisoning rate 1.0)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.3540333333333333 	Loss: 1.717232 time 7.824399709701538
epoch:1, test_loss:2.2046, test_correct:0.2368
epoch:1, asr_loss:1.5036, asr_correct:0.9947
Train Epoch: 2 	TRAIN ACC: 0.5649 	Loss: 1.205650 time 25.551358222961426
epoch:2, test_loss:2.0123, test_correct:0.5056
epoch:2, asr_loss:1.5355, asr_correct:0.9422
Train Epoch: 3 	TRAIN ACC: 0.6566666666666666 	Loss: 0.960136 time 43.338645935058594
epoch:3, test_loss:2.0039, test_correct:0.4864
epoch:3, asr_loss:1.5227, asr_correct:0.9558
Train Epoch: 4 	TRAIN ACC: 0.7012 	Loss: 0.831408 time 60.99637222290039
epoch:4, test_loss:1.8765, test_correct:0.6482
epoch:4, asr_loss:1.4942, asr_correct:0.9712
Train Epoch: 5 	TRAIN ACC: 0.7375333333333334 	Loss: 0.732903 time 78.674391746521
epoch:5, test_loss:1.8339, test_correct:0.6770
epoch:5, asr_loss:1.4870, asr_correct:0.9766
Train Epoch: 6 	TRAIN ACC: 0.7693333333333333 	Loss: 0.663021 time 96.35189318656921
epoch:6, test_loss:1.8857, test_correct:0.6176
epoch:6, asr_loss:1.4761, asr_correct:0.9923
Train Epoch: 7 	TRAIN ACC: 0.7841666666666667 	Loss: 0.612284 time 114.08887672424316
epoch:7, test_loss:1.8438, test_correct:0.6498
epoch:7, asr_loss:1.4880, asr_correct:0.9741
Train Epoch: 8 	TRAIN ACC: 0.8033666666666667 	Loss: 0.559551 time 131.7978479862213
epoch:8, test_loss:1.7800, test_correct:0.7248
epoch:8, asr_loss:1.4820, asr_correct:0.9797
Train Epoch: 9 	TRAIN ACC: 0.8233 	Loss: 0.511006 time 149.49172282218933
epoch:9, test_loss:1.7822, test_correct:0.7159
epoch:9, asr_loss:1.4981, asr_correct:0.9704
Train Epoch: 10 	TRAIN ACC: 0.8325 	Loss: 0.482135 time 167.12708616256714
epoch:10, test_loss:1.7309, test_correct:0.7762
epoch:10, asr_loss:1.5123, asr_correct:0.9512
Train Epoch: 11 	TRAIN ACC: 0.8411 	Loss: 0.459997 time 184.85374689102173
epoch:11, test_loss:1.7830, test_correct:0.7080
epoch:11, asr_loss:1.5004, asr_correct:0.9722
Train Epoch: 12 	TRAIN ACC: 0.8507666666666667 	Loss: 0.439941 time 202.60052609443665
epoch:12, test_loss:1.7091, test_correct:0.7844
epoch:12, asr_loss:1.4904, asr_correct:0.9711
Train Epoch: 13 	TRAIN ACC: 0.8570333333333333 	Loss: 0.412981 time 220.36634612083435
epoch:13, test_loss:1.7174, test_correct:0.7787
epoch:13, asr_loss:1.4922, asr_correct:0.9702
Train Epoch: 14 	TRAIN ACC: 0.8682666666666666 	Loss: 0.379181 time 237.99644804000854
epoch:14, test_loss:1.7311, test_correct:0.7646
epoch:14, asr_loss:1.4841, asr_correct:0.9820
Train Epoch: 15 	TRAIN ACC: 0.87 	Loss: 0.375267 time 255.66054582595825
epoch:15, test_loss:1.6916, test_correct:0.7989
epoch:15, asr_loss:1.4890, asr_correct:0.9764
Train Epoch: 16 	TRAIN ACC: 0.8781333333333333 	Loss: 0.350501 time 273.45753502845764
epoch:16, test_loss:1.6713, test_correct:0.8291
epoch:16, asr_loss:1.4826, asr_correct:0.9790
Train Epoch: 17 	TRAIN ACC: 0.8834333333333333 	Loss: 0.336890 time 291.18855476379395
epoch:17, test_loss:1.6854, test_correct:0.8106
epoch:17, asr_loss:1.4697, asr_correct:0.9927
Train Epoch: 18 	TRAIN ACC: 0.8904333333333333 	Loss: 0.316709 time 309.00537109375
epoch:18, test_loss:1.6796, test_correct:0.8128
epoch:18, asr_loss:1.4777, asr_correct:0.9844
Train Epoch: 19 	TRAIN ACC: 0.8915333333333333 	Loss: 0.309037 time 326.6703040599823
epoch:19, test_loss:1.6743, test_correct:0.8159
epoch:19, asr_loss:1.4795, asr_correct:0.9810
Train Epoch: 20 	TRAIN ACC: 0.8991666666666667 	Loss: 0.291485 time 344.30847239494324
epoch:20, test_loss:1.6610, test_correct:0.8281
epoch:20, asr_loss:1.4808, asr_correct:0.9800
Train Epoch: 21 	TRAIN ACC: 0.9058 	Loss: 0.273096 time 362.02896904945374
epoch:21, test_loss:1.6944, test_correct:0.7843
epoch:21, asr_loss:1.4968, asr_correct:0.9728
Train Epoch: 22 	TRAIN ACC: 0.9037333333333334 	Loss: 0.281548 time 379.7133994102478
epoch:22, test_loss:1.6614, test_correct:0.8236
epoch:22, asr_loss:1.4984, asr_correct:0.9684
Train Epoch: 23 	TRAIN ACC: 0.9123 	Loss: 0.257566 time 397.4246709346771
epoch:23, test_loss:1.6560, test_correct:0.8259
epoch:23, asr_loss:1.4725, asr_correct:0.9891
Train Epoch: 24 	TRAIN ACC: 0.9165666666666666 	Loss: 0.245828 time 415.06889963150024
epoch:24, test_loss:1.6531, test_correct:0.8340
epoch:24, asr_loss:1.5474, asr_correct:0.9269
Train Epoch: 25 	TRAIN ACC: 0.9194666666666667 	Loss: 0.241086 time 432.77358317375183
epoch:25, test_loss:1.6815, test_correct:0.7990
epoch:25, asr_loss:1.4825, asr_correct:0.9790
Train Epoch: 26 	TRAIN ACC: 0.9196666666666666 	Loss: 0.235346 time 450.63305258750916
epoch:26, test_loss:1.6356, test_correct:0.8507
epoch:26, asr_loss:1.4778, asr_correct:0.9831
Train Epoch: 27 	TRAIN ACC: 0.9192333333333333 	Loss: 0.231904 time 468.2656714916229
epoch:27, test_loss:1.6556, test_correct:0.8240
epoch:27, asr_loss:1.4853, asr_correct:0.9759
Train Epoch: 28 	TRAIN ACC: 0.9295 	Loss: 0.210493 time 485.94677448272705
epoch:28, test_loss:1.6410, test_correct:0.8380
epoch:28, asr_loss:1.4828, asr_correct:0.9797
Train Epoch: 29 	TRAIN ACC: 0.9261666666666667 	Loss: 0.213298 time 503.6479732990265
epoch:29, test_loss:1.6662, test_correct:0.8130
epoch:29, asr_loss:1.4804, asr_correct:0.9809
Train Epoch: 30 	TRAIN ACC: 0.9280666666666667 	Loss: 0.207247 time 521.3663516044617
epoch:30, test_loss:1.6637, test_correct:0.8106
epoch:30, asr_loss:1.4711, asr_correct:0.9895
Train Epoch: 31 	TRAIN ACC: 0.9350666666666667 	Loss: 0.194378 time 539.0342869758606
epoch:31, test_loss:1.6622, test_correct:0.8126
epoch:31, asr_loss:1.4819, asr_correct:0.9814
Train Epoch: 32 	TRAIN ACC: 0.9347 	Loss: 0.192953 time 556.7516117095947
epoch:32, test_loss:1.6612, test_correct:0.8120
epoch:32, asr_loss:1.4804, asr_correct:0.9805
Train Epoch: 33 	TRAIN ACC: 0.9361333333333334 	Loss: 0.190578 time 574.4008564949036
epoch:33, test_loss:1.6615, test_correct:0.8133
epoch:33, asr_loss:1.4714, asr_correct:0.9902
Train Epoch: 34 	TRAIN ACC: 0.9371333333333334 	Loss: 0.183779 time 592.0955340862274
epoch:34, test_loss:1.6156, test_correct:0.8647
epoch:34, asr_loss:1.4786, asr_correct:0.9826
Train Epoch: 35 	TRAIN ACC: 0.9418333333333333 	Loss: 0.170561 time 609.8008811473846
epoch:35, test_loss:1.6229, test_correct:0.8544
epoch:35, asr_loss:1.4790, asr_correct:0.9830
Train Epoch: 36 	TRAIN ACC: 0.9464 	Loss: 0.159112 time 627.5090005397797
epoch:36, test_loss:1.6193, test_correct:0.8544
epoch:36, asr_loss:1.5072, asr_correct:0.9620
Train Epoch: 37 	TRAIN ACC: 0.9463666666666667 	Loss: 0.161035 time 645.2239911556244
epoch:37, test_loss:1.6253, test_correct:0.8480
epoch:37, asr_loss:1.4865, asr_correct:0.9766
Train Epoch: 38 	TRAIN ACC: 0.9453666666666667 	Loss: 0.164766 time 662.8857803344727
epoch:38, test_loss:1.6120, test_correct:0.8636
epoch:38, asr_loss:1.5730, asr_correct:0.9098
Train Epoch: 39 	TRAIN ACC: 0.9476 	Loss: 0.151962 time 680.5617244243622
epoch:39, test_loss:1.6204, test_correct:0.8538
epoch:39, asr_loss:1.4803, asr_correct:0.9829
Train Epoch: 40 	TRAIN ACC: 0.9504333333333334 	Loss: 0.147716 time 698.2603271007538
epoch:40, test_loss:1.6318, test_correct:0.8394
epoch:40, asr_loss:1.7015, asr_correct:0.7767
Train Epoch: 41 	TRAIN ACC: 0.9463333333333334 	Loss: 0.156983 time 715.9605898857117
epoch:41, test_loss:1.6273, test_correct:0.8442
epoch:41, asr_loss:1.4800, asr_correct:0.9829
Train Epoch: 42 	TRAIN ACC: 0.9520666666666666 	Loss: 0.137916 time 733.6383640766144
epoch:42, test_loss:1.5984, test_correct:0.8750
epoch:42, asr_loss:1.4914, asr_correct:0.9725
Train Epoch: 43 	TRAIN ACC: 0.9535333333333333 	Loss: 0.135838 time 751.3430607318878
epoch:43, test_loss:1.6225, test_correct:0.8497
epoch:43, asr_loss:1.4743, asr_correct:0.9873
Train Epoch: 44 	TRAIN ACC: 0.9569 	Loss: 0.125373 time 769.061895608902
epoch:44, test_loss:1.6251, test_correct:0.8496
epoch:44, asr_loss:1.4810, asr_correct:0.9806
Train Epoch: 45 	TRAIN ACC: 0.9529666666666666 	Loss: 0.135950 time 786.8630020618439
epoch:45, test_loss:1.6399, test_correct:0.8335
epoch:45, asr_loss:1.4743, asr_correct:0.9865
Train Epoch: 46 	TRAIN ACC: 0.9555666666666667 	Loss: 0.130196 time 804.5307116508484
epoch:46, test_loss:1.6080, test_correct:0.8659
epoch:46, asr_loss:1.4810, asr_correct:0.9795
Train Epoch: 47 	TRAIN ACC: 0.9600333333333333 	Loss: 0.117351 time 822.1888749599457
epoch:47, test_loss:1.6016, test_correct:0.8714
epoch:47, asr_loss:1.4918, asr_correct:0.9711
Train Epoch: 48 	TRAIN ACC: 0.9613333333333334 	Loss: 0.113848 time 839.921923160553
epoch:48, test_loss:1.6025, test_correct:0.8701
epoch:48, asr_loss:1.4818, asr_correct:0.9794
Train Epoch: 49 	TRAIN ACC: 0.9605666666666667 	Loss: 0.116108 time 857.6037473678589
epoch:49, test_loss:1.6031, test_correct:0.8684
epoch:49, asr_loss:1.4758, asr_correct:0.9854
Train Epoch: 50 	TRAIN ACC: 0.96 	Loss: 0.119055 time 875.3269028663635
epoch:50, test_loss:1.6186, test_correct:0.8514
epoch:50, asr_loss:1.4872, asr_correct:0.9759
Train Epoch: 51 	TRAIN ACC: 0.9634666666666667 	Loss: 0.108683 time 892.9822950363159
epoch:51, test_loss:1.6023, test_correct:0.8694
epoch:51, asr_loss:1.4821, asr_correct:0.9807
Train Epoch: 52 	TRAIN ACC: 0.9623666666666667 	Loss: 0.109265 time 910.7240059375763
epoch:52, test_loss:1.6151, test_correct:0.8556
epoch:52, asr_loss:1.4839, asr_correct:0.9801
Train Epoch: 53 	TRAIN ACC: 0.9669333333333333 	Loss: 0.099106 time 928.3915138244629
epoch:53, test_loss:1.6153, test_correct:0.8540
epoch:53, asr_loss:1.4780, asr_correct:0.9830
Train Epoch: 54 	TRAIN ACC: 0.9609 	Loss: 0.117788 time 946.0945873260498
epoch:54, test_loss:1.6007, test_correct:0.8694
epoch:54, asr_loss:1.4944, asr_correct:0.9731
Train Epoch: 55 	TRAIN ACC: 0.9657333333333333 	Loss: 0.098296 time 963.7982532978058
epoch:55, test_loss:1.6071, test_correct:0.8624
epoch:55, asr_loss:1.4821, asr_correct:0.9815
Train Epoch: 56 	TRAIN ACC: 0.9660666666666666 	Loss: 0.101211 time 981.5253918170929
epoch:56, test_loss:1.6086, test_correct:0.8603
epoch:56, asr_loss:1.4733, asr_correct:0.9883
Train Epoch: 57 	TRAIN ACC: 0.9666 	Loss: 0.101121 time 999.1676740646362
epoch:57, test_loss:1.6016, test_correct:0.8676
epoch:57, asr_loss:1.4785, asr_correct:0.9828
Train Epoch: 58 	TRAIN ACC: 0.9651 	Loss: 0.099771 time 1016.8350217342377
epoch:58, test_loss:1.6019, test_correct:0.8677
epoch:58, asr_loss:1.4800, asr_correct:0.9814
Train Epoch: 59 	TRAIN ACC: 0.9662666666666667 	Loss: 0.099202 time 1034.4267988204956
epoch:59, test_loss:1.6247, test_correct:0.8442
epoch:59, asr_loss:1.4796, asr_correct:0.9824
Train Epoch: 60 	TRAIN ACC: 0.9681666666666666 	Loss: 0.095647 time 1052.0728838443756
epoch:60, test_loss:1.6049, test_correct:0.8651
epoch:60, asr_loss:1.6168, asr_correct:0.8613
Train Epoch: 61 	TRAIN ACC: 0.9641666666666666 	Loss: 0.102985 time 1069.8528923988342
epoch:61, test_loss:1.6033, test_correct:0.8647
epoch:61, asr_loss:1.5704, asr_correct:0.9046
Train Epoch: 62 	TRAIN ACC: 0.9654666666666667 	Loss: 0.102400 time 1087.5145859718323
epoch:62, test_loss:1.5931, test_correct:0.8761
epoch:62, asr_loss:1.4826, asr_correct:0.9784
Train Epoch: 63 	TRAIN ACC: 0.9693333333333334 	Loss: 0.089941 time 1105.265299797058
epoch:63, test_loss:1.5974, test_correct:0.8733
epoch:63, asr_loss:1.4831, asr_correct:0.9783
Train Epoch: 64 	TRAIN ACC: 0.9663666666666667 	Loss: 0.098070 time 1122.9274299144745
epoch:64, test_loss:1.5800, test_correct:0.8894
epoch:64, asr_loss:1.4875, asr_correct:0.9780
Train Epoch: 65 	TRAIN ACC: 0.9705 	Loss: 0.086264 time 1140.6192555427551
epoch:65, test_loss:1.5921, test_correct:0.8773
epoch:65, asr_loss:1.5047, asr_correct:0.9649
Train Epoch: 66 	TRAIN ACC: 0.9675 	Loss: 0.096976 time 1158.3282008171082
epoch:66, test_loss:1.6123, test_correct:0.8557
epoch:66, asr_loss:1.4729, asr_correct:0.9880
Train Epoch: 67 	TRAIN ACC: 0.9689666666666666 	Loss: 0.092513 time 1175.9849536418915
epoch:67, test_loss:1.5996, test_correct:0.8702
epoch:67, asr_loss:1.5142, asr_correct:0.9542
Train Epoch: 68 	TRAIN ACC: 0.9720666666666666 	Loss: 0.080253 time 1193.6284575462341
epoch:68, test_loss:1.6165, test_correct:0.8526
epoch:68, asr_loss:1.4799, asr_correct:0.9813
Train Epoch: 69 	TRAIN ACC: 0.9707 	Loss: 0.086687 time 1211.2152559757233
epoch:69, test_loss:1.6033, test_correct:0.8654
epoch:69, asr_loss:1.4780, asr_correct:0.9837
Train Epoch: 70 	TRAIN ACC: 0.9737666666666667 	Loss: 0.077848 time 1228.9026765823364
epoch:70, test_loss:1.6112, test_correct:0.8565
epoch:70, asr_loss:1.5193, asr_correct:0.9561
Train Epoch: 71 	TRAIN ACC: 0.9711333333333333 	Loss: 0.085880 time 1246.601824760437
epoch:71, test_loss:1.5903, test_correct:0.8787
epoch:71, asr_loss:1.4916, asr_correct:0.9737
Train Epoch: 72 	TRAIN ACC: 0.9669666666666666 	Loss: 0.096134 time 1264.314847946167
epoch:72, test_loss:1.6414, test_correct:0.8275
epoch:72, asr_loss:1.4852, asr_correct:0.9761
Train Epoch: 73 	TRAIN ACC: 0.9701 	Loss: 0.088078 time 1281.94469332695
epoch:73, test_loss:1.5996, test_correct:0.8699
epoch:73, asr_loss:1.4792, asr_correct:0.9817
Train Epoch: 74 	TRAIN ACC: 0.9738333333333333 	Loss: 0.075903 time 1299.593435049057
epoch:74, test_loss:1.6000, test_correct:0.8674
epoch:74, asr_loss:1.4882, asr_correct:0.9760
Train Epoch: 75 	TRAIN ACC: 0.9707666666666667 	Loss: 0.081429 time 1317.275988817215
epoch:75, test_loss:1.5911, test_correct:0.8774
epoch:75, asr_loss:1.4786, asr_correct:0.9832
Train Epoch: 76 	TRAIN ACC: 0.9736 	Loss: 0.078520 time 1334.987275838852
epoch:76, test_loss:1.6073, test_correct:0.8621
epoch:76, asr_loss:1.4946, asr_correct:0.9714
Train Epoch: 77 	TRAIN ACC: 0.9721333333333333 	Loss: 0.085156 time 1352.6582930088043
epoch:77, test_loss:1.5981, test_correct:0.8712
epoch:77, asr_loss:1.4739, asr_correct:0.9878
Train Epoch: 78 	TRAIN ACC: 0.9751333333333333 	Loss: 0.073776 time 1370.349190235138
epoch:78, test_loss:1.5885, test_correct:0.8803
epoch:78, asr_loss:1.4776, asr_correct:0.9834
Train Epoch: 79 	TRAIN ACC: 0.9749333333333333 	Loss: 0.075110 time 1388.0423259735107
epoch:79, test_loss:1.5974, test_correct:0.8716
epoch:79, asr_loss:1.5244, asr_correct:0.9454
Train Epoch: 80 	TRAIN ACC: 0.9761666666666666 	Loss: 0.068018 time 1405.7260138988495
epoch:80, test_loss:1.5908, test_correct:0.8774
epoch:80, asr_loss:1.4879, asr_correct:0.9786
Train Epoch: 81 	TRAIN ACC: 0.9864333333333334 	Loss: 0.040187 time 1423.4483752250671
epoch:81, test_loss:1.5645, test_correct:0.9028
epoch:81, asr_loss:1.4760, asr_correct:0.9851
Train Epoch: 82 	TRAIN ACC: 0.993 	Loss: 0.023065 time 1441.0952303409576
epoch:82, test_loss:1.5611, test_correct:0.9066
epoch:82, asr_loss:1.4796, asr_correct:0.9824
Train Epoch: 83 	TRAIN ACC: 0.9946333333333334 	Loss: 0.017846 time 1458.7004103660583
epoch:83, test_loss:1.5573, test_correct:0.9093
epoch:83, asr_loss:1.4843, asr_correct:0.9801
Train Epoch: 84 	TRAIN ACC: 0.9962 	Loss: 0.014168 time 1476.40034532547
epoch:84, test_loss:1.5566, test_correct:0.9092
epoch:84, asr_loss:1.4806, asr_correct:0.9821
Train Epoch: 85 	TRAIN ACC: 0.9971333333333333 	Loss: 0.011511 time 1494.101036787033
epoch:85, test_loss:1.5567, test_correct:0.9095
epoch:85, asr_loss:1.4784, asr_correct:0.9830
Train Epoch: 86 	TRAIN ACC: 0.9975 	Loss: 0.010028 time 1511.8776245117188
epoch:86, test_loss:1.5559, test_correct:0.9100
epoch:86, asr_loss:1.4785, asr_correct:0.9828
Train Epoch: 87 	TRAIN ACC: 0.9972666666666666 	Loss: 0.010079 time 1529.5026862621307
epoch:87, test_loss:1.5568, test_correct:0.9085
epoch:87, asr_loss:1.4789, asr_correct:0.9826
Train Epoch: 88 	TRAIN ACC: 0.9978 	Loss: 0.009187 time 1547.2621774673462
epoch:88, test_loss:1.5540, test_correct:0.9110
epoch:88, asr_loss:1.4895, asr_correct:0.9768
Train Epoch: 89 	TRAIN ACC: 0.9979 	Loss: 0.008369 time 1564.9255893230438
epoch:89, test_loss:1.5561, test_correct:0.9092
epoch:89, asr_loss:1.4797, asr_correct:0.9827
Train Epoch: 90 	TRAIN ACC: 0.9979333333333333 	Loss: 0.007510 time 1582.7039260864258
epoch:90, test_loss:1.5544, test_correct:0.9109
epoch:90, asr_loss:1.4799, asr_correct:0.9820
Train Epoch: 91 	TRAIN ACC: 0.9980333333333333 	Loss: 0.008219 time 1600.3693084716797
epoch:91, test_loss:1.5553, test_correct:0.9100
epoch:91, asr_loss:1.4798, asr_correct:0.9821
Train Epoch: 92 	TRAIN ACC: 0.9980333333333333 	Loss: 0.007145 time 1618.0378260612488
epoch:92, test_loss:1.5570, test_correct:0.9082
epoch:92, asr_loss:1.4770, asr_correct:0.9850
Train Epoch: 93 	TRAIN ACC: 0.9987 	Loss: 0.006370 time 1635.7665412425995
epoch:93, test_loss:1.5528, test_correct:0.9127
epoch:93, asr_loss:1.4797, asr_correct:0.9821
Train Epoch: 94 	TRAIN ACC: 0.9981333333333333 	Loss: 0.006976 time 1653.4326775074005
epoch:94, test_loss:1.5536, test_correct:0.9113
epoch:94, asr_loss:1.4799, asr_correct:0.9822
Train Epoch: 95 	TRAIN ACC: 0.9983666666666666 	Loss: 0.006260 time 1671.157555103302
epoch:95, test_loss:1.5540, test_correct:0.9119
epoch:95, asr_loss:1.4787, asr_correct:0.9829
Train Epoch: 96 	TRAIN ACC: 0.9981666666666666 	Loss: 0.006168 time 1688.8340301513672
epoch:96, test_loss:1.5544, test_correct:0.9111
epoch:96, asr_loss:1.4781, asr_correct:0.9837
Train Epoch: 97 	TRAIN ACC: 0.9987 	Loss: 0.005562 time 1706.5245151519775
epoch:97, test_loss:1.5546, test_correct:0.9106
epoch:97, asr_loss:1.4770, asr_correct:0.9842
Train Epoch: 98 	TRAIN ACC: 0.9989666666666667 	Loss: 0.005249 time 1724.2447826862335
epoch:98, test_loss:1.5522, test_correct:0.9116
epoch:98, asr_loss:1.4896, asr_correct:0.9760
Train Epoch: 99 	TRAIN ACC: 0.9989666666666667 	Loss: 0.004271 time 1741.9698696136475
epoch:99, test_loss:1.5550, test_correct:0.9092
epoch:99, asr_loss:1.4775, asr_correct:0.9846
Train Epoch: 100 	TRAIN ACC: 0.9983666666666666 	Loss: 0.005775 time 1759.6393485069275
epoch:100, test_loss:1.5529, test_correct:0.9115
epoch:100, asr_loss:1.4914, asr_correct:0.9770
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_0.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_0 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_0 loaded
# 0 test_acc :  0.91152 test_loss :  1.552926568107605 epsilon :  -1 total_duration: 1759.6393485069275
#p_one 0.97696 (1.491377774887085)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.35036666666666666 	Loss: 1.740398 time 7.67188835144043
epoch:1, test_loss:2.1590, test_correct:0.3304
epoch:1, asr_loss:1.6408, asr_correct:0.9528
Train Epoch: 2 	TRAIN ACC: 0.5566333333333333 	Loss: 1.227819 time 25.314881801605225
epoch:2, test_loss:2.0388, test_correct:0.4623
epoch:2, asr_loss:1.5176, asr_correct:0.9627
Train Epoch: 3 	TRAIN ACC: 0.6529333333333334 	Loss: 0.965970 time 42.94717311859131
epoch:3, test_loss:1.9519, test_correct:0.5543
epoch:3, asr_loss:1.4658, asr_correct:0.9976
Train Epoch: 4 	TRAIN ACC: 0.6957 	Loss: 0.850713 time 60.62480282783508
epoch:4, test_loss:1.9188, test_correct:0.6030
epoch:4, asr_loss:1.5056, asr_correct:0.9582
Train Epoch: 5 	TRAIN ACC: 0.7253666666666667 	Loss: 0.773440 time 78.31233596801758
epoch:5, test_loss:1.8729, test_correct:0.6470
epoch:5, asr_loss:1.5317, asr_correct:0.9400
Train Epoch: 6 	TRAIN ACC: 0.7557666666666667 	Loss: 0.692696 time 95.96154356002808
epoch:6, test_loss:1.8091, test_correct:0.7121
epoch:6, asr_loss:1.5556, asr_correct:0.9187
Train Epoch: 7 	TRAIN ACC: 0.7847 	Loss: 0.619133 time 113.62345671653748
epoch:7, test_loss:1.8192, test_correct:0.6921
epoch:7, asr_loss:1.4846, asr_correct:0.9795
Train Epoch: 8 	TRAIN ACC: 0.8031 	Loss: 0.568419 time 131.28689241409302
epoch:8, test_loss:1.7889, test_correct:0.7327
epoch:8, asr_loss:1.4938, asr_correct:0.9698
Train Epoch: 9 	TRAIN ACC: 0.8113 	Loss: 0.540725 time 148.9039659500122
epoch:9, test_loss:1.7578, test_correct:0.7619
epoch:9, asr_loss:1.4802, asr_correct:0.9811
Train Epoch: 10 	TRAIN ACC: 0.8328333333333333 	Loss: 0.482906 time 166.48407912254333
epoch:10, test_loss:1.7704, test_correct:0.7263
epoch:10, asr_loss:1.4801, asr_correct:0.9810
Train Epoch: 11 	TRAIN ACC: 0.8373333333333334 	Loss: 0.469959 time 184.15988302230835
epoch:11, test_loss:1.7642, test_correct:0.7461
epoch:11, asr_loss:1.4753, asr_correct:0.9859
Train Epoch: 12 	TRAIN ACC: 0.8483666666666667 	Loss: 0.440413 time 201.83711338043213
epoch:12, test_loss:1.7264, test_correct:0.7725
epoch:12, asr_loss:1.5194, asr_correct:0.9533
Train Epoch: 13 	TRAIN ACC: 0.8572666666666666 	Loss: 0.413206 time 219.44671416282654
epoch:13, test_loss:1.7369, test_correct:0.7683
epoch:13, asr_loss:1.4731, asr_correct:0.9882
Train Epoch: 14 	TRAIN ACC: 0.8676 	Loss: 0.386990 time 237.19062685966492
epoch:14, test_loss:1.7111, test_correct:0.7839
epoch:14, asr_loss:1.4963, asr_correct:0.9653
Train Epoch: 15 	TRAIN ACC: 0.8699333333333333 	Loss: 0.378871 time 254.88592052459717
epoch:15, test_loss:1.6754, test_correct:0.8139
epoch:15, asr_loss:1.4854, asr_correct:0.9802
Train Epoch: 16 	TRAIN ACC: 0.8807 	Loss: 0.349440 time 272.6106598377228
epoch:16, test_loss:1.7209, test_correct:0.7678
epoch:16, asr_loss:1.4853, asr_correct:0.9759
Train Epoch: 17 	TRAIN ACC: 0.8795333333333333 	Loss: 0.349897 time 290.2312955856323
epoch:17, test_loss:1.6889, test_correct:0.7996
epoch:17, asr_loss:1.4735, asr_correct:0.9878
Train Epoch: 18 	TRAIN ACC: 0.8915 	Loss: 0.314497 time 307.8962392807007
epoch:18, test_loss:1.7141, test_correct:0.7673
epoch:18, asr_loss:1.5033, asr_correct:0.9595
Train Epoch: 19 	TRAIN ACC: 0.8916 	Loss: 0.315250 time 325.67541575431824
epoch:19, test_loss:1.6662, test_correct:0.8257
epoch:19, asr_loss:1.4789, asr_correct:0.9823
Train Epoch: 20 	TRAIN ACC: 0.8980333333333334 	Loss: 0.295795 time 343.362309217453
epoch:20, test_loss:1.6935, test_correct:0.8012
epoch:20, asr_loss:1.4835, asr_correct:0.9798
Train Epoch: 21 	TRAIN ACC: 0.8991 	Loss: 0.287616 time 360.9954924583435
epoch:21, test_loss:1.7014, test_correct:0.7788
epoch:21, asr_loss:1.4847, asr_correct:0.9760
Train Epoch: 22 	TRAIN ACC: 0.9059666666666667 	Loss: 0.275974 time 378.63111877441406
epoch:22, test_loss:1.6552, test_correct:0.8257
epoch:22, asr_loss:1.4801, asr_correct:0.9806
Train Epoch: 23 	TRAIN ACC: 0.9083 	Loss: 0.266948 time 396.3710763454437
epoch:23, test_loss:1.6513, test_correct:0.8330
epoch:23, asr_loss:1.4836, asr_correct:0.9774
Train Epoch: 24 	TRAIN ACC: 0.9142333333333333 	Loss: 0.250745 time 414.01985692977905
epoch:24, test_loss:1.6656, test_correct:0.8192
epoch:24, asr_loss:1.4780, asr_correct:0.9825
Train Epoch: 25 	TRAIN ACC: 0.9160666666666667 	Loss: 0.245609 time 431.7127950191498
epoch:25, test_loss:1.6738, test_correct:0.8094
epoch:25, asr_loss:1.4780, asr_correct:0.9828
Train Epoch: 26 	TRAIN ACC: 0.9193333333333333 	Loss: 0.236855 time 449.4319574832916
epoch:26, test_loss:1.6317, test_correct:0.8518
epoch:26, asr_loss:1.5013, asr_correct:0.9623
Train Epoch: 27 	TRAIN ACC: 0.9213 	Loss: 0.228180 time 467.17265367507935
epoch:27, test_loss:1.6489, test_correct:0.8344
epoch:27, asr_loss:1.4752, asr_correct:0.9855
Train Epoch: 28 	TRAIN ACC: 0.9267 	Loss: 0.212863 time 484.8233790397644
epoch:28, test_loss:1.6326, test_correct:0.8523
epoch:28, asr_loss:1.4915, asr_correct:0.9708
Train Epoch: 29 	TRAIN ACC: 0.9259 	Loss: 0.216217 time 502.59772968292236
epoch:29, test_loss:1.6566, test_correct:0.8213
epoch:29, asr_loss:1.4725, asr_correct:0.9894
Train Epoch: 30 	TRAIN ACC: 0.9305333333333333 	Loss: 0.205114 time 520.2597341537476
epoch:30, test_loss:1.6566, test_correct:0.8220
epoch:30, asr_loss:1.4752, asr_correct:0.9852
Train Epoch: 31 	TRAIN ACC: 0.9295333333333333 	Loss: 0.205320 time 537.934014081955
epoch:31, test_loss:1.6560, test_correct:0.8198
epoch:31, asr_loss:1.4770, asr_correct:0.9836
Train Epoch: 32 	TRAIN ACC: 0.9329666666666667 	Loss: 0.195828 time 555.5645604133606
epoch:32, test_loss:1.6422, test_correct:0.8343
epoch:32, asr_loss:1.4985, asr_correct:0.9662
Train Epoch: 33 	TRAIN ACC: 0.9347666666666666 	Loss: 0.187915 time 573.2010746002197
epoch:33, test_loss:1.6319, test_correct:0.8440
epoch:33, asr_loss:1.4768, asr_correct:0.9840
Train Epoch: 34 	TRAIN ACC: 0.9396666666666667 	Loss: 0.175448 time 590.9468038082123
epoch:34, test_loss:1.6244, test_correct:0.8508
epoch:34, asr_loss:1.4825, asr_correct:0.9784
Train Epoch: 35 	TRAIN ACC: 0.9420333333333333 	Loss: 0.171634 time 608.6563391685486
epoch:35, test_loss:1.6360, test_correct:0.8378
epoch:35, asr_loss:1.4727, asr_correct:0.9884
Train Epoch: 36 	TRAIN ACC: 0.9410666666666667 	Loss: 0.171501 time 626.3500699996948
epoch:36, test_loss:1.6255, test_correct:0.8528
epoch:36, asr_loss:1.4874, asr_correct:0.9738
Train Epoch: 37 	TRAIN ACC: 0.9449333333333333 	Loss: 0.157641 time 644.083580493927
epoch:37, test_loss:1.6182, test_correct:0.8571
epoch:37, asr_loss:1.4781, asr_correct:0.9828
Train Epoch: 38 	TRAIN ACC: 0.9407666666666666 	Loss: 0.174559 time 661.8449418544769
epoch:38, test_loss:1.6516, test_correct:0.8220
epoch:38, asr_loss:1.4748, asr_correct:0.9866
Train Epoch: 39 	TRAIN ACC: 0.9498 	Loss: 0.149337 time 679.5318074226379
epoch:39, test_loss:1.6203, test_correct:0.8562
epoch:39, asr_loss:1.4854, asr_correct:0.9746
Train Epoch: 40 	TRAIN ACC: 0.9434 	Loss: 0.165800 time 697.1947281360626
epoch:40, test_loss:1.6186, test_correct:0.8587
epoch:40, asr_loss:1.4786, asr_correct:0.9818
Train Epoch: 41 	TRAIN ACC: 0.9483666666666667 	Loss: 0.149867 time 714.8683624267578
epoch:41, test_loss:1.6229, test_correct:0.8520
epoch:41, asr_loss:1.4750, asr_correct:0.9860
Train Epoch: 42 	TRAIN ACC: 0.9532 	Loss: 0.135896 time 732.5372915267944
epoch:42, test_loss:1.6134, test_correct:0.8618
epoch:42, asr_loss:1.4759, asr_correct:0.9851
Train Epoch: 43 	TRAIN ACC: 0.9540666666666666 	Loss: 0.129053 time 750.2500143051147
epoch:43, test_loss:1.6032, test_correct:0.8693
epoch:43, asr_loss:1.4854, asr_correct:0.9752
Train Epoch: 44 	TRAIN ACC: 0.9549333333333333 	Loss: 0.130861 time 767.8565554618835
epoch:44, test_loss:1.6125, test_correct:0.8644
epoch:44, asr_loss:1.4774, asr_correct:0.9833
Train Epoch: 45 	TRAIN ACC: 0.9576 	Loss: 0.124184 time 785.4302821159363
epoch:45, test_loss:1.6005, test_correct:0.8728
epoch:45, asr_loss:1.4848, asr_correct:0.9765
Train Epoch: 46 	TRAIN ACC: 0.9589333333333333 	Loss: 0.120996 time 803.05881690979
epoch:46, test_loss:1.6050, test_correct:0.8666
epoch:46, asr_loss:1.4737, asr_correct:0.9873
Train Epoch: 47 	TRAIN ACC: 0.9568666666666666 	Loss: 0.123638 time 820.7615294456482
epoch:47, test_loss:1.6290, test_correct:0.8426
epoch:47, asr_loss:1.4779, asr_correct:0.9828
Train Epoch: 48 	TRAIN ACC: 0.9555 	Loss: 0.132217 time 838.4588441848755
epoch:48, test_loss:1.6076, test_correct:0.8684
epoch:48, asr_loss:1.4776, asr_correct:0.9824
Train Epoch: 49 	TRAIN ACC: 0.9582333333333334 	Loss: 0.123450 time 856.1362619400024
epoch:49, test_loss:1.6078, test_correct:0.8619
epoch:49, asr_loss:1.4829, asr_correct:0.9779
Train Epoch: 50 	TRAIN ACC: 0.9616666666666667 	Loss: 0.113459 time 873.8718581199646
epoch:50, test_loss:1.6068, test_correct:0.8638
epoch:50, asr_loss:1.5155, asr_correct:0.9534
Train Epoch: 51 	TRAIN ACC: 0.9619 	Loss: 0.110045 time 891.5619826316833
epoch:51, test_loss:1.6270, test_correct:0.8425
epoch:51, asr_loss:1.4780, asr_correct:0.9824
Train Epoch: 52 	TRAIN ACC: 0.9619 	Loss: 0.110954 time 909.2373127937317
epoch:52, test_loss:1.6005, test_correct:0.8695
epoch:52, asr_loss:1.4782, asr_correct:0.9822
Train Epoch: 53 	TRAIN ACC: 0.9593 	Loss: 0.118689 time 926.9288582801819
epoch:53, test_loss:1.6031, test_correct:0.8684
epoch:53, asr_loss:1.4786, asr_correct:0.9823
Train Epoch: 54 	TRAIN ACC: 0.9628 	Loss: 0.106480 time 944.6040329933167
epoch:54, test_loss:1.5982, test_correct:0.8704
epoch:54, asr_loss:1.4842, asr_correct:0.9782
Train Epoch: 55 	TRAIN ACC: 0.9666 	Loss: 0.096914 time 962.232382774353
epoch:55, test_loss:1.6014, test_correct:0.8748
epoch:55, asr_loss:1.4775, asr_correct:0.9825
Train Epoch: 56 	TRAIN ACC: 0.9608666666666666 	Loss: 0.113583 time 979.9612920284271
epoch:56, test_loss:1.6014, test_correct:0.8687
epoch:56, asr_loss:1.4803, asr_correct:0.9804
Train Epoch: 57 	TRAIN ACC: 0.9618666666666666 	Loss: 0.110568 time 997.5980930328369
epoch:57, test_loss:1.6005, test_correct:0.8705
epoch:57, asr_loss:1.4724, asr_correct:0.9880
Train Epoch: 58 	TRAIN ACC: 0.9667333333333333 	Loss: 0.096111 time 1015.227530002594
epoch:58, test_loss:1.6215, test_correct:0.8507
epoch:58, asr_loss:1.4779, asr_correct:0.9824
Train Epoch: 59 	TRAIN ACC: 0.9641666666666666 	Loss: 0.108608 time 1032.9720594882965
epoch:59, test_loss:1.6023, test_correct:0.8683
epoch:59, asr_loss:1.4765, asr_correct:0.9839
Train Epoch: 60 	TRAIN ACC: 0.9664666666666667 	Loss: 0.095214 time 1050.5865681171417
epoch:60, test_loss:1.5907, test_correct:0.8823
epoch:60, asr_loss:1.4808, asr_correct:0.9799
Train Epoch: 61 	TRAIN ACC: 0.9691333333333333 	Loss: 0.092652 time 1068.267641544342
epoch:61, test_loss:1.6150, test_correct:0.8550
epoch:61, asr_loss:1.4710, asr_correct:0.9900
Train Epoch: 62 	TRAIN ACC: 0.9650666666666666 	Loss: 0.103243 time 1085.9601895809174
epoch:62, test_loss:1.6047, test_correct:0.8658
epoch:62, asr_loss:1.4825, asr_correct:0.9779
Train Epoch: 63 	TRAIN ACC: 0.9676333333333333 	Loss: 0.092505 time 1103.679937839508
epoch:63, test_loss:1.6084, test_correct:0.8617
epoch:63, asr_loss:1.8260, asr_correct:0.6331
Train Epoch: 64 	TRAIN ACC: 0.9643666666666667 	Loss: 0.105338 time 1121.374457359314
epoch:64, test_loss:1.6219, test_correct:0.8491
epoch:64, asr_loss:1.4721, asr_correct:0.9884
Train Epoch: 65 	TRAIN ACC: 0.9704666666666667 	Loss: 0.084761 time 1139.0299513339996
epoch:65, test_loss:1.5998, test_correct:0.8689
epoch:65, asr_loss:1.4853, asr_correct:0.9772
Train Epoch: 66 	TRAIN ACC: 0.9677666666666667 	Loss: 0.096933 time 1156.6395545005798
epoch:66, test_loss:1.5868, test_correct:0.8826
epoch:66, asr_loss:1.4941, asr_correct:0.9680
Train Epoch: 67 	TRAIN ACC: 0.9682333333333333 	Loss: 0.092165 time 1174.3256061077118
epoch:67, test_loss:1.6040, test_correct:0.8654
epoch:67, asr_loss:1.4793, asr_correct:0.9814
Train Epoch: 68 	TRAIN ACC: 0.9722666666666666 	Loss: 0.080018 time 1192.0254878997803
epoch:68, test_loss:1.6021, test_correct:0.8655
epoch:68, asr_loss:1.4751, asr_correct:0.9858
Train Epoch: 69 	TRAIN ACC: 0.9698333333333333 	Loss: 0.089170 time 1209.76824593544
epoch:69, test_loss:1.5928, test_correct:0.8772
epoch:69, asr_loss:1.4783, asr_correct:0.9824
Train Epoch: 70 	TRAIN ACC: 0.9712333333333333 	Loss: 0.085809 time 1227.4357557296753
epoch:70, test_loss:1.6015, test_correct:0.8670
epoch:70, asr_loss:1.4730, asr_correct:0.9884
Train Epoch: 71 	TRAIN ACC: 0.9699 	Loss: 0.089614 time 1245.1232142448425
epoch:71, test_loss:1.5944, test_correct:0.8747
epoch:71, asr_loss:1.4813, asr_correct:0.9797
Train Epoch: 72 	TRAIN ACC: 0.9704333333333334 	Loss: 0.085162 time 1262.7848966121674
epoch:72, test_loss:1.5979, test_correct:0.8713
epoch:72, asr_loss:1.4831, asr_correct:0.9785
Train Epoch: 73 	TRAIN ACC: 0.9739666666666666 	Loss: 0.076292 time 1280.5045626163483
epoch:73, test_loss:1.6107, test_correct:0.8590
epoch:73, asr_loss:1.4778, asr_correct:0.9832
Train Epoch: 74 	TRAIN ACC: 0.9711 	Loss: 0.085842 time 1298.1704330444336
epoch:74, test_loss:1.5967, test_correct:0.8722
epoch:74, asr_loss:1.4815, asr_correct:0.9793
Train Epoch: 75 	TRAIN ACC: 0.9725333333333334 	Loss: 0.079038 time 1315.8830711841583
epoch:75, test_loss:1.5940, test_correct:0.8738
epoch:75, asr_loss:1.4806, asr_correct:0.9802
Train Epoch: 76 	TRAIN ACC: 0.9711 	Loss: 0.086123 time 1333.506206035614
epoch:76, test_loss:1.5866, test_correct:0.8822
epoch:76, asr_loss:1.4765, asr_correct:0.9837
Train Epoch: 77 	TRAIN ACC: 0.9695333333333334 	Loss: 0.092952 time 1351.2022824287415
epoch:77, test_loss:1.6008, test_correct:0.8712
epoch:77, asr_loss:1.4760, asr_correct:0.9844
Train Epoch: 78 	TRAIN ACC: 0.9713 	Loss: 0.083279 time 1368.9005217552185
epoch:78, test_loss:1.5961, test_correct:0.8741
epoch:78, asr_loss:1.4791, asr_correct:0.9817
Train Epoch: 79 	TRAIN ACC: 0.9728666666666667 	Loss: 0.080044 time 1386.5905573368073
epoch:79, test_loss:1.6038, test_correct:0.8649
epoch:79, asr_loss:1.4709, asr_correct:0.9898
Train Epoch: 80 	TRAIN ACC: 0.9662333333333334 	Loss: 0.098367 time 1404.2758054733276
epoch:80, test_loss:1.5930, test_correct:0.8760
epoch:80, asr_loss:1.5439, asr_correct:0.9324
Train Epoch: 81 	TRAIN ACC: 0.9865 	Loss: 0.042567 time 1421.9674961566925
epoch:81, test_loss:1.5632, test_correct:0.9049
epoch:81, asr_loss:1.4914, asr_correct:0.9743
Train Epoch: 82 	TRAIN ACC: 0.9923 	Loss: 0.025527 time 1439.695092201233
epoch:82, test_loss:1.5601, test_correct:0.9084
epoch:82, asr_loss:1.4820, asr_correct:0.9802
Train Epoch: 83 	TRAIN ACC: 0.9944666666666667 	Loss: 0.020694 time 1457.4545452594757
epoch:83, test_loss:1.5561, test_correct:0.9115
epoch:83, asr_loss:1.4851, asr_correct:0.9784
Train Epoch: 84 	TRAIN ACC: 0.9948 	Loss: 0.018358 time 1475.1301748752594
epoch:84, test_loss:1.5558, test_correct:0.9112
epoch:84, asr_loss:1.4807, asr_correct:0.9809
Train Epoch: 85 	TRAIN ACC: 0.9951333333333333 	Loss: 0.016867 time 1492.8570911884308
epoch:85, test_loss:1.5559, test_correct:0.9108
epoch:85, asr_loss:1.4786, asr_correct:0.9826
Train Epoch: 86 	TRAIN ACC: 0.9957666666666667 	Loss: 0.014541 time 1510.522466659546
epoch:86, test_loss:1.5549, test_correct:0.9119
epoch:86, asr_loss:1.4786, asr_correct:0.9825
Train Epoch: 87 	TRAIN ACC: 0.9964666666666666 	Loss: 0.012856 time 1528.19163107872
epoch:87, test_loss:1.5540, test_correct:0.9120
epoch:87, asr_loss:1.4806, asr_correct:0.9806
Train Epoch: 88 	TRAIN ACC: 0.9968 	Loss: 0.011495 time 1545.8411588668823
epoch:88, test_loss:1.5563, test_correct:0.9095
epoch:88, asr_loss:1.4757, asr_correct:0.9848
Train Epoch: 89 	TRAIN ACC: 0.9974333333333333 	Loss: 0.010061 time 1563.5238327980042
epoch:89, test_loss:1.5525, test_correct:0.9131
epoch:89, asr_loss:1.4795, asr_correct:0.9813
Train Epoch: 90 	TRAIN ACC: 0.9973666666666666 	Loss: 0.010668 time 1581.1321442127228
epoch:90, test_loss:1.5529, test_correct:0.9118
epoch:90, asr_loss:1.4787, asr_correct:0.9822
Train Epoch: 91 	TRAIN ACC: 0.9975666666666667 	Loss: 0.009187 time 1598.8043920993805
epoch:91, test_loss:1.5531, test_correct:0.9118
epoch:91, asr_loss:1.4774, asr_correct:0.9834
Train Epoch: 92 	TRAIN ACC: 0.9976 	Loss: 0.008891 time 1616.6131694316864
epoch:92, test_loss:1.5524, test_correct:0.9129
epoch:92, asr_loss:1.4780, asr_correct:0.9828
Train Epoch: 93 	TRAIN ACC: 0.9981333333333333 	Loss: 0.007964 time 1634.282774925232
epoch:93, test_loss:1.5525, test_correct:0.9117
epoch:93, asr_loss:1.4773, asr_correct:0.9835
Train Epoch: 94 	TRAIN ACC: 0.9982 	Loss: 0.007584 time 1652.0153305530548
epoch:94, test_loss:1.5504, test_correct:0.9137
epoch:94, asr_loss:1.4823, asr_correct:0.9791
Train Epoch: 95 	TRAIN ACC: 0.9982333333333333 	Loss: 0.006743 time 1669.7312760353088
epoch:95, test_loss:1.5537, test_correct:0.9104
epoch:95, asr_loss:1.4763, asr_correct:0.9840
Train Epoch: 96 	TRAIN ACC: 0.9989 	Loss: 0.005801 time 1687.3556258678436
epoch:96, test_loss:1.5526, test_correct:0.9114
epoch:96, asr_loss:1.4775, asr_correct:0.9834
Train Epoch: 97 	TRAIN ACC: 0.9984333333333333 	Loss: 0.006321 time 1705.1450824737549
epoch:97, test_loss:1.5513, test_correct:0.9123
epoch:97, asr_loss:1.4795, asr_correct:0.9815
Train Epoch: 98 	TRAIN ACC: 0.9982 	Loss: 0.006349 time 1722.8249895572662
epoch:98, test_loss:1.5545, test_correct:0.9088
epoch:98, asr_loss:1.4776, asr_correct:0.9834
Train Epoch: 99 	TRAIN ACC: 0.9983333333333333 	Loss: 0.006700 time 1740.58198428154
epoch:99, test_loss:1.5533, test_correct:0.9105
epoch:99, asr_loss:1.4793, asr_correct:0.9816
Train Epoch: 100 	TRAIN ACC: 0.9988666666666667 	Loss: 0.005314 time 1758.2619953155518
epoch:100, test_loss:1.5517, test_correct:0.9118
epoch:100, asr_loss:1.4780, asr_correct:0.9828
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_1.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_1 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_1 loaded
# 1 test_acc :  0.91184 test_loss :  1.5517058126831054 epsilon :  -1 total_duration: 3517.9013438224792
#p_one 0.9828 (1.478024531135559)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.3701 	Loss: 1.713099 time 7.6810808181762695
epoch:1, test_loss:2.1285, test_correct:0.3744
epoch:1, asr_loss:1.5345, asr_correct:0.9637
Train Epoch: 2 	TRAIN ACC: 0.5589333333333333 	Loss: 1.209402 time 25.381325483322144
epoch:2, test_loss:2.0043, test_correct:0.5214
epoch:2, asr_loss:1.5865, asr_correct:0.9256
Train Epoch: 3 	TRAIN ACC: 0.6497333333333334 	Loss: 0.969910 time 43.139864683151245
epoch:3, test_loss:1.9218, test_correct:0.5910
epoch:3, asr_loss:1.4922, asr_correct:0.9741
Train Epoch: 4 	TRAIN ACC: 0.6984666666666667 	Loss: 0.846537 time 60.75938677787781
epoch:4, test_loss:1.9729, test_correct:0.5514
epoch:4, asr_loss:1.4849, asr_correct:0.9811
Train Epoch: 5 	TRAIN ACC: 0.7348333333333333 	Loss: 0.740615 time 78.35498356819153
epoch:5, test_loss:1.8369, test_correct:0.6680
epoch:5, asr_loss:1.5119, asr_correct:0.9526
Train Epoch: 6 	TRAIN ACC: 0.7666666666666667 	Loss: 0.663046 time 96.06209325790405
epoch:6, test_loss:1.8383, test_correct:0.6958
epoch:6, asr_loss:1.4986, asr_correct:0.9656
Train Epoch: 7 	TRAIN ACC: 0.7942 	Loss: 0.592772 time 113.6383011341095
epoch:7, test_loss:1.8435, test_correct:0.6532
epoch:7, asr_loss:1.5216, asr_correct:0.9491
Train Epoch: 8 	TRAIN ACC: 0.8039333333333334 	Loss: 0.563489 time 131.29939818382263
epoch:8, test_loss:1.7587, test_correct:0.7533
epoch:8, asr_loss:1.4911, asr_correct:0.9718
Train Epoch: 9 	TRAIN ACC: 0.8235666666666667 	Loss: 0.509238 time 148.9509973526001
epoch:9, test_loss:1.7253, test_correct:0.7781
epoch:9, asr_loss:1.5545, asr_correct:0.9297
Train Epoch: 10 	TRAIN ACC: 0.8366666666666667 	Loss: 0.468600 time 166.61319756507874
epoch:10, test_loss:1.7434, test_correct:0.7551
epoch:10, asr_loss:1.4856, asr_correct:0.9762
Train Epoch: 11 	TRAIN ACC: 0.8410666666666666 	Loss: 0.464753 time 184.21151614189148
epoch:11, test_loss:1.7031, test_correct:0.8026
epoch:11, asr_loss:1.5483, asr_correct:0.9283
Train Epoch: 12 	TRAIN ACC: 0.8556 	Loss: 0.419374 time 201.88680744171143
epoch:12, test_loss:1.7104, test_correct:0.7865
epoch:12, asr_loss:1.4778, asr_correct:0.9837
Train Epoch: 13 	TRAIN ACC: 0.8598 	Loss: 0.405896 time 219.50752091407776
epoch:13, test_loss:1.6979, test_correct:0.7957
epoch:13, asr_loss:1.5011, asr_correct:0.9662
Train Epoch: 14 	TRAIN ACC: 0.8681333333333333 	Loss: 0.378287 time 237.24929809570312
epoch:14, test_loss:1.6983, test_correct:0.7932
epoch:14, asr_loss:1.4707, asr_correct:0.9906
Train Epoch: 15 	TRAIN ACC: 0.8746333333333334 	Loss: 0.354690 time 254.88193655014038
epoch:15, test_loss:1.7290, test_correct:0.7506
epoch:15, asr_loss:1.5082, asr_correct:0.9617
Train Epoch: 16 	TRAIN ACC: 0.8789333333333333 	Loss: 0.353184 time 272.61187767982483
epoch:16, test_loss:1.6763, test_correct:0.8097
epoch:16, asr_loss:1.4995, asr_correct:0.9622
Train Epoch: 17 	TRAIN ACC: 0.8813666666666666 	Loss: 0.342230 time 290.3675525188446
epoch:17, test_loss:1.7000, test_correct:0.7826
epoch:17, asr_loss:1.5004, asr_correct:0.9630
Train Epoch: 18 	TRAIN ACC: 0.8898666666666667 	Loss: 0.321064 time 307.9526994228363
epoch:18, test_loss:1.6895, test_correct:0.8086
epoch:18, asr_loss:1.5111, asr_correct:0.9531
Train Epoch: 19 	TRAIN ACC: 0.8974666666666666 	Loss: 0.299906 time 325.5076608657837
epoch:19, test_loss:1.6660, test_correct:0.8113
epoch:19, asr_loss:1.4867, asr_correct:0.9750
Train Epoch: 20 	TRAIN ACC: 0.9008 	Loss: 0.283767 time 343.19478940963745
epoch:20, test_loss:1.6416, test_correct:0.8447
epoch:20, asr_loss:1.4781, asr_correct:0.9835
Train Epoch: 21 	TRAIN ACC: 0.9019 	Loss: 0.284741 time 360.8331708908081
epoch:21, test_loss:1.6713, test_correct:0.8081
epoch:21, asr_loss:1.5319, asr_correct:0.9348
Train Epoch: 22 	TRAIN ACC: 0.9088333333333334 	Loss: 0.261522 time 378.4590392112732
epoch:22, test_loss:1.6332, test_correct:0.8567
epoch:22, asr_loss:1.4867, asr_correct:0.9741
Train Epoch: 23 	TRAIN ACC: 0.9089 	Loss: 0.257435 time 396.1588122844696
epoch:23, test_loss:1.6658, test_correct:0.8162
epoch:23, asr_loss:1.4894, asr_correct:0.9742
Train Epoch: 24 	TRAIN ACC: 0.9106 	Loss: 0.262983 time 413.83668971061707
epoch:24, test_loss:1.6470, test_correct:0.8342
epoch:24, asr_loss:1.4755, asr_correct:0.9854
Train Epoch: 25 	TRAIN ACC: 0.9177666666666666 	Loss: 0.238543 time 431.57263565063477
epoch:25, test_loss:1.6323, test_correct:0.8539
epoch:25, asr_loss:1.4821, asr_correct:0.9788
Train Epoch: 26 	TRAIN ACC: 0.9211 	Loss: 0.222960 time 449.2705409526825
epoch:26, test_loss:1.6463, test_correct:0.8328
epoch:26, asr_loss:1.4791, asr_correct:0.9818
Train Epoch: 27 	TRAIN ACC: 0.9264333333333333 	Loss: 0.213780 time 466.91644835472107
epoch:27, test_loss:1.6302, test_correct:0.8510
epoch:27, asr_loss:1.4807, asr_correct:0.9808
Train Epoch: 28 	TRAIN ACC: 0.927 	Loss: 0.216195 time 484.5724720954895
epoch:28, test_loss:1.6320, test_correct:0.8433
epoch:28, asr_loss:1.4746, asr_correct:0.9863
Train Epoch: 29 	TRAIN ACC: 0.9300666666666667 	Loss: 0.206354 time 502.21455907821655
epoch:29, test_loss:1.6399, test_correct:0.8390
epoch:29, asr_loss:1.4738, asr_correct:0.9874
Train Epoch: 30 	TRAIN ACC: 0.9310333333333334 	Loss: 0.201840 time 519.8698275089264
epoch:30, test_loss:1.6661, test_correct:0.8078
epoch:30, asr_loss:1.4648, asr_correct:0.9968
Train Epoch: 31 	TRAIN ACC: 0.9341333333333334 	Loss: 0.189450 time 537.4584467411041
epoch:31, test_loss:1.6420, test_correct:0.8357
epoch:31, asr_loss:1.4896, asr_correct:0.9709
Train Epoch: 32 	TRAIN ACC: 0.9321666666666667 	Loss: 0.189547 time 555.0573973655701
epoch:32, test_loss:1.6405, test_correct:0.8357
epoch:32, asr_loss:1.4750, asr_correct:0.9870
Train Epoch: 33 	TRAIN ACC: 0.9361666666666667 	Loss: 0.184895 time 572.673778295517
epoch:33, test_loss:1.6350, test_correct:0.8384
epoch:33, asr_loss:1.4771, asr_correct:0.9838
Train Epoch: 34 	TRAIN ACC: 0.9418666666666666 	Loss: 0.173766 time 590.2416026592255
epoch:34, test_loss:1.6175, test_correct:0.8561
epoch:34, asr_loss:1.4964, asr_correct:0.9655
Train Epoch: 35 	TRAIN ACC: 0.9414 	Loss: 0.172074 time 607.9037394523621
epoch:35, test_loss:1.6437, test_correct:0.8331
epoch:35, asr_loss:1.4849, asr_correct:0.9763
Train Epoch: 36 	TRAIN ACC: 0.9419666666666666 	Loss: 0.168987 time 625.5691905021667
epoch:36, test_loss:1.6139, test_correct:0.8645
epoch:36, asr_loss:1.4789, asr_correct:0.9819
Train Epoch: 37 	TRAIN ACC: 0.9461666666666667 	Loss: 0.158348 time 643.3017482757568
epoch:37, test_loss:1.6192, test_correct:0.8578
epoch:37, asr_loss:1.4770, asr_correct:0.9839
Train Epoch: 38 	TRAIN ACC: 0.9498666666666666 	Loss: 0.145726 time 660.9578759670258
epoch:38, test_loss:1.6139, test_correct:0.8577
epoch:38, asr_loss:1.4999, asr_correct:0.9654
Train Epoch: 39 	TRAIN ACC: 0.947 	Loss: 0.153143 time 678.6442365646362
epoch:39, test_loss:1.6013, test_correct:0.8730
epoch:39, asr_loss:1.6432, asr_correct:0.8366
Train Epoch: 40 	TRAIN ACC: 0.947 	Loss: 0.158437 time 696.2692084312439
epoch:40, test_loss:1.6113, test_correct:0.8639
epoch:40, asr_loss:1.4866, asr_correct:0.9761
Train Epoch: 41 	TRAIN ACC: 0.9514 	Loss: 0.142519 time 713.8714714050293
epoch:41, test_loss:1.6148, test_correct:0.8591
epoch:41, asr_loss:1.4812, asr_correct:0.9795
Train Epoch: 42 	TRAIN ACC: 0.9542333333333334 	Loss: 0.133576 time 731.5483424663544
epoch:42, test_loss:1.6113, test_correct:0.8605
epoch:42, asr_loss:1.4789, asr_correct:0.9821
Train Epoch: 43 	TRAIN ACC: 0.951 	Loss: 0.144301 time 749.2402369976044
epoch:43, test_loss:1.6123, test_correct:0.8584
epoch:43, asr_loss:1.4710, asr_correct:0.9900
Train Epoch: 44 	TRAIN ACC: 0.9564666666666667 	Loss: 0.128741 time 766.9537658691406
epoch:44, test_loss:1.6330, test_correct:0.8373
epoch:44, asr_loss:1.5008, asr_correct:0.9628
Train Epoch: 45 	TRAIN ACC: 0.9544333333333334 	Loss: 0.135607 time 784.6292469501495
epoch:45, test_loss:1.6074, test_correct:0.8634
epoch:45, asr_loss:1.4842, asr_correct:0.9770
Train Epoch: 46 	TRAIN ACC: 0.9574333333333334 	Loss: 0.125959 time 802.3249487876892
epoch:46, test_loss:1.6172, test_correct:0.8516
epoch:46, asr_loss:1.5768, asr_correct:0.8997
Train Epoch: 47 	TRAIN ACC: 0.9583333333333334 	Loss: 0.118792 time 820.0124733448029
epoch:47, test_loss:1.6004, test_correct:0.8714
epoch:47, asr_loss:1.4886, asr_correct:0.9726
Train Epoch: 48 	TRAIN ACC: 0.9605333333333334 	Loss: 0.113064 time 837.6381859779358
epoch:48, test_loss:1.5976, test_correct:0.8714
epoch:48, asr_loss:1.4873, asr_correct:0.9745
Train Epoch: 49 	TRAIN ACC: 0.9620333333333333 	Loss: 0.108844 time 855.270033121109
epoch:49, test_loss:1.6077, test_correct:0.8632
epoch:49, asr_loss:1.4804, asr_correct:0.9810
Train Epoch: 50 	TRAIN ACC: 0.9602 	Loss: 0.115929 time 873.0467267036438
epoch:50, test_loss:1.5943, test_correct:0.8775
epoch:50, asr_loss:1.4788, asr_correct:0.9820
Train Epoch: 51 	TRAIN ACC: 0.9619 	Loss: 0.108870 time 890.8561487197876
epoch:51, test_loss:1.5929, test_correct:0.8773
epoch:51, asr_loss:1.4814, asr_correct:0.9794
Train Epoch: 52 	TRAIN ACC: 0.9645333333333334 	Loss: 0.106054 time 908.5833015441895
epoch:52, test_loss:1.5985, test_correct:0.8710
epoch:52, asr_loss:1.4767, asr_correct:0.9839
Train Epoch: 53 	TRAIN ACC: 0.9633666666666667 	Loss: 0.109026 time 926.4041485786438
epoch:53, test_loss:1.6217, test_correct:0.8482
epoch:53, asr_loss:1.4752, asr_correct:0.9859
Train Epoch: 54 	TRAIN ACC: 0.9599333333333333 	Loss: 0.113071 time 944.088133096695
epoch:54, test_loss:1.5976, test_correct:0.8735
epoch:54, asr_loss:1.4910, asr_correct:0.9704
Train Epoch: 55 	TRAIN ACC: 0.9650666666666666 	Loss: 0.102903 time 961.8240644931793
epoch:55, test_loss:1.5877, test_correct:0.8828
epoch:55, asr_loss:1.4809, asr_correct:0.9798
Train Epoch: 56 	TRAIN ACC: 0.9657 	Loss: 0.104885 time 979.6154778003693
epoch:56, test_loss:1.5962, test_correct:0.8753
epoch:56, asr_loss:1.4734, asr_correct:0.9876
Train Epoch: 57 	TRAIN ACC: 0.9687 	Loss: 0.089807 time 997.4554913043976
epoch:57, test_loss:1.6080, test_correct:0.8612
epoch:57, asr_loss:1.4724, asr_correct:0.9890
Train Epoch: 58 	TRAIN ACC: 0.9641666666666666 	Loss: 0.108354 time 1015.2115709781647
epoch:58, test_loss:1.6228, test_correct:0.8483
epoch:58, asr_loss:1.4771, asr_correct:0.9836
Train Epoch: 59 	TRAIN ACC: 0.9651333333333333 	Loss: 0.101562 time 1032.9697222709656
epoch:59, test_loss:1.5871, test_correct:0.8822
epoch:59, asr_loss:1.4822, asr_correct:0.9786
Train Epoch: 60 	TRAIN ACC: 0.9668666666666667 	Loss: 0.097221 time 1050.7555723190308
epoch:60, test_loss:1.6078, test_correct:0.8608
epoch:60, asr_loss:1.4825, asr_correct:0.9786
Train Epoch: 61 	TRAIN ACC: 0.9660666666666666 	Loss: 0.095948 time 1068.5382838249207
epoch:61, test_loss:1.5872, test_correct:0.8812
epoch:61, asr_loss:1.5166, asr_correct:0.9519
Train Epoch: 62 	TRAIN ACC: 0.9691666666666666 	Loss: 0.087866 time 1086.2203679084778
epoch:62, test_loss:1.6032, test_correct:0.8689
epoch:62, asr_loss:1.4825, asr_correct:0.9786
Train Epoch: 63 	TRAIN ACC: 0.9691333333333333 	Loss: 0.089820 time 1103.8618702888489
epoch:63, test_loss:1.5929, test_correct:0.8756
epoch:63, asr_loss:1.4925, asr_correct:0.9691
Train Epoch: 64 	TRAIN ACC: 0.9654 	Loss: 0.098143 time 1121.5047273635864
epoch:64, test_loss:1.6108, test_correct:0.8573
epoch:64, asr_loss:1.4859, asr_correct:0.9749
Train Epoch: 65 	TRAIN ACC: 0.9704 	Loss: 0.086110 time 1139.0998089313507
epoch:65, test_loss:1.5885, test_correct:0.8794
epoch:65, asr_loss:1.4837, asr_correct:0.9776
Train Epoch: 66 	TRAIN ACC: 0.9718333333333333 	Loss: 0.084887 time 1156.7699210643768
epoch:66, test_loss:1.5972, test_correct:0.8726
epoch:66, asr_loss:1.4826, asr_correct:0.9782
Train Epoch: 67 	TRAIN ACC: 0.9708333333333333 	Loss: 0.087670 time 1174.4475774765015
epoch:67, test_loss:1.5941, test_correct:0.8737
epoch:67, asr_loss:1.4788, asr_correct:0.9824
Train Epoch: 68 	TRAIN ACC: 0.9706 	Loss: 0.087779 time 1192.0522751808167
epoch:68, test_loss:1.6019, test_correct:0.8664
epoch:68, asr_loss:1.4823, asr_correct:0.9786
Train Epoch: 69 	TRAIN ACC: 0.9694666666666667 	Loss: 0.090583 time 1209.8135316371918
epoch:69, test_loss:1.5997, test_correct:0.8678
epoch:69, asr_loss:1.4958, asr_correct:0.9676
Train Epoch: 70 	TRAIN ACC: 0.9667 	Loss: 0.099130 time 1227.4372203350067
epoch:70, test_loss:1.5924, test_correct:0.8758
epoch:70, asr_loss:1.5073, asr_correct:0.9564
Train Epoch: 71 	TRAIN ACC: 0.9749 	Loss: 0.075201 time 1245.0363910198212
epoch:71, test_loss:1.6074, test_correct:0.8599
epoch:71, asr_loss:1.4821, asr_correct:0.9800
Train Epoch: 72 	TRAIN ACC: 0.9752666666666666 	Loss: 0.072510 time 1262.6063106060028
epoch:72, test_loss:1.5938, test_correct:0.8730
epoch:72, asr_loss:1.4979, asr_correct:0.9671
Train Epoch: 73 	TRAIN ACC: 0.9693 	Loss: 0.092033 time 1280.2224476337433
epoch:73, test_loss:1.6179, test_correct:0.8508
epoch:73, asr_loss:1.4826, asr_correct:0.9780
Train Epoch: 74 	TRAIN ACC: 0.9689333333333333 	Loss: 0.088170 time 1297.8785309791565
epoch:74, test_loss:1.5958, test_correct:0.8707
epoch:74, asr_loss:1.4765, asr_correct:0.9841
Train Epoch: 75 	TRAIN ACC: 0.9697 	Loss: 0.083426 time 1315.5532414913177
epoch:75, test_loss:1.6014, test_correct:0.8664
epoch:75, asr_loss:1.4770, asr_correct:0.9840
Train Epoch: 76 	TRAIN ACC: 0.9761666666666666 	Loss: 0.071892 time 1333.156551361084
epoch:76, test_loss:1.5976, test_correct:0.8690
epoch:76, asr_loss:1.4779, asr_correct:0.9831
Train Epoch: 77 	TRAIN ACC: 0.9714333333333334 	Loss: 0.084726 time 1350.8545515537262
epoch:77, test_loss:1.5923, test_correct:0.8768
epoch:77, asr_loss:1.4821, asr_correct:0.9787
Train Epoch: 78 	TRAIN ACC: 0.9746666666666667 	Loss: 0.075330 time 1368.5585522651672
epoch:78, test_loss:1.5884, test_correct:0.8789
epoch:78, asr_loss:1.4776, asr_correct:0.9832
Train Epoch: 79 	TRAIN ACC: 0.9686333333333333 	Loss: 0.093237 time 1386.1310937404633
epoch:79, test_loss:1.5808, test_correct:0.8870
epoch:79, asr_loss:1.4931, asr_correct:0.9713
Train Epoch: 80 	TRAIN ACC: 0.9760666666666666 	Loss: 0.072525 time 1403.7729141712189
epoch:80, test_loss:1.6003, test_correct:0.8661
epoch:80, asr_loss:1.4806, asr_correct:0.9802
Train Epoch: 81 	TRAIN ACC: 0.9877 	Loss: 0.039218 time 1421.3882348537445
epoch:81, test_loss:1.5590, test_correct:0.9070
epoch:81, asr_loss:1.4784, asr_correct:0.9829
Train Epoch: 82 	TRAIN ACC: 0.9935666666666667 	Loss: 0.022804 time 1439.0144400596619
epoch:82, test_loss:1.5562, test_correct:0.9106
epoch:82, asr_loss:1.4788, asr_correct:0.9824
Train Epoch: 83 	TRAIN ACC: 0.9955333333333334 	Loss: 0.017754 time 1456.6129286289215
epoch:83, test_loss:1.5551, test_correct:0.9110
epoch:83, asr_loss:1.4784, asr_correct:0.9826
Train Epoch: 84 	TRAIN ACC: 0.9963333333333333 	Loss: 0.014007 time 1474.2631413936615
epoch:84, test_loss:1.5534, test_correct:0.9114
epoch:84, asr_loss:1.4788, asr_correct:0.9822
Train Epoch: 85 	TRAIN ACC: 0.9959666666666667 	Loss: 0.014743 time 1491.9675538539886
epoch:85, test_loss:1.5522, test_correct:0.9130
epoch:85, asr_loss:1.4796, asr_correct:0.9817
Train Epoch: 86 	TRAIN ACC: 0.9971333333333333 	Loss: 0.012104 time 1509.5384259223938
epoch:86, test_loss:1.5534, test_correct:0.9119
epoch:86, asr_loss:1.4780, asr_correct:0.9831
Train Epoch: 87 	TRAIN ACC: 0.9972666666666666 	Loss: 0.009961 time 1527.157840013504
epoch:87, test_loss:1.5522, test_correct:0.9133
epoch:87, asr_loss:1.4780, asr_correct:0.9832
Train Epoch: 88 	TRAIN ACC: 0.9978666666666667 	Loss: 0.009335 time 1544.7352471351624
epoch:88, test_loss:1.5506, test_correct:0.9137
epoch:88, asr_loss:1.4798, asr_correct:0.9816
Train Epoch: 89 	TRAIN ACC: 0.9976666666666667 	Loss: 0.008722 time 1562.3222625255585
epoch:89, test_loss:1.5506, test_correct:0.9132
epoch:89, asr_loss:1.4788, asr_correct:0.9825
Train Epoch: 90 	TRAIN ACC: 0.9984 	Loss: 0.007688 time 1579.8945128917694
epoch:90, test_loss:1.5517, test_correct:0.9122
epoch:90, asr_loss:1.4782, asr_correct:0.9828
Train Epoch: 91 	TRAIN ACC: 0.9980333333333333 	Loss: 0.007117 time 1597.4625523090363
epoch:91, test_loss:1.5513, test_correct:0.9130
epoch:91, asr_loss:1.4772, asr_correct:0.9839
Train Epoch: 92 	TRAIN ACC: 0.9982333333333333 	Loss: 0.007292 time 1615.0847821235657
epoch:92, test_loss:1.5510, test_correct:0.9128
epoch:92, asr_loss:1.4771, asr_correct:0.9842
Train Epoch: 93 	TRAIN ACC: 0.9981666666666666 	Loss: 0.007926 time 1632.6833069324493
epoch:93, test_loss:1.5506, test_correct:0.9144
epoch:93, asr_loss:1.4793, asr_correct:0.9820
Train Epoch: 94 	TRAIN ACC: 0.9988 	Loss: 0.006400 time 1650.2936856746674
epoch:94, test_loss:1.5514, test_correct:0.9132
epoch:94, asr_loss:1.4791, asr_correct:0.9823
Train Epoch: 95 	TRAIN ACC: 0.9989666666666667 	Loss: 0.004922 time 1667.9168951511383
epoch:95, test_loss:1.5497, test_correct:0.9149
epoch:95, asr_loss:1.4805, asr_correct:0.9810
Train Epoch: 96 	TRAIN ACC: 0.9987666666666667 	Loss: 0.005183 time 1685.5707759857178
epoch:96, test_loss:1.5519, test_correct:0.9124
epoch:96, asr_loss:1.4801, asr_correct:0.9814
Train Epoch: 97 	TRAIN ACC: 0.9989333333333333 	Loss: 0.005148 time 1703.223863363266
epoch:97, test_loss:1.5473, test_correct:0.9166
epoch:97, asr_loss:1.4866, asr_correct:0.9764
Train Epoch: 98 	TRAIN ACC: 0.9984333333333333 	Loss: 0.005666 time 1720.9700021743774
epoch:98, test_loss:1.5511, test_correct:0.9126
epoch:98, asr_loss:1.4817, asr_correct:0.9801
Train Epoch: 99 	TRAIN ACC: 0.9986333333333334 	Loss: 0.005651 time 1738.621561050415
epoch:99, test_loss:1.5502, test_correct:0.9140
epoch:99, asr_loss:1.4768, asr_correct:0.9843
Train Epoch: 100 	TRAIN ACC: 0.9987333333333334 	Loss: 0.005513 time 1756.260895729065
epoch:100, test_loss:1.5484, test_correct:0.9158
epoch:100, asr_loss:1.4794, asr_correct:0.9818
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_2.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_2 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_2 loaded
# 2 test_acc :  0.91576 test_loss :  1.5484142083358765 epsilon :  -1 total_duration: 5274.162239551544
#p_one 0.98176 (1.4793846436691285)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.3848 	Loss: 1.667574 time 7.657064437866211
epoch:1, test_loss:2.1202, test_correct:0.3851
epoch:1, asr_loss:1.5507, asr_correct:0.9677
Train Epoch: 2 	TRAIN ACC: 0.5776666666666667 	Loss: 1.167247 time 25.437089443206787
epoch:2, test_loss:2.0103, test_correct:0.5010
epoch:2, asr_loss:1.5434, asr_correct:0.9483
Train Epoch: 3 	TRAIN ACC: 0.6579 	Loss: 0.955963 time 43.11846733093262
epoch:3, test_loss:1.9308, test_correct:0.5952
epoch:3, asr_loss:1.4905, asr_correct:0.9779
Train Epoch: 4 	TRAIN ACC: 0.7041 	Loss: 0.830611 time 60.83056044578552
epoch:4, test_loss:1.8768, test_correct:0.6361
epoch:4, asr_loss:1.5483, asr_correct:0.9307
Train Epoch: 5 	TRAIN ACC: 0.7318666666666667 	Loss: 0.749085 time 78.47318530082703
epoch:5, test_loss:1.8857, test_correct:0.6437
epoch:5, asr_loss:1.4700, asr_correct:0.9936
Train Epoch: 6 	TRAIN ACC: 0.7625 	Loss: 0.671245 time 96.11483192443848
epoch:6, test_loss:1.8357, test_correct:0.6713
epoch:6, asr_loss:1.4921, asr_correct:0.9717
Train Epoch: 7 	TRAIN ACC: 0.7896666666666666 	Loss: 0.599390 time 113.80820608139038
epoch:7, test_loss:1.7753, test_correct:0.7333
epoch:7, asr_loss:1.4941, asr_correct:0.9682
Train Epoch: 8 	TRAIN ACC: 0.8082666666666667 	Loss: 0.556502 time 131.4978632926941
epoch:8, test_loss:1.7805, test_correct:0.7238
epoch:8, asr_loss:1.4954, asr_correct:0.9675
Train Epoch: 9 	TRAIN ACC: 0.8220333333333333 	Loss: 0.513405 time 149.23741459846497
epoch:9, test_loss:1.8034, test_correct:0.6846
epoch:9, asr_loss:1.4739, asr_correct:0.9902
Train Epoch: 10 	TRAIN ACC: 0.8329 	Loss: 0.491293 time 167.0218541622162
epoch:10, test_loss:1.7734, test_correct:0.7207
epoch:10, asr_loss:1.4872, asr_correct:0.9758
Train Epoch: 11 	TRAIN ACC: 0.8412666666666667 	Loss: 0.457019 time 184.79610586166382
epoch:11, test_loss:1.7142, test_correct:0.7892
epoch:11, asr_loss:1.5139, asr_correct:0.9517
Train Epoch: 12 	TRAIN ACC: 0.8513 	Loss: 0.430421 time 202.46568989753723
epoch:12, test_loss:1.7215, test_correct:0.7848
epoch:12, asr_loss:1.4945, asr_correct:0.9675
Train Epoch: 13 	TRAIN ACC: 0.8623 	Loss: 0.407580 time 220.2668251991272
epoch:13, test_loss:1.7172, test_correct:0.7821
epoch:13, asr_loss:1.5055, asr_correct:0.9614
Train Epoch: 14 	TRAIN ACC: 0.8670666666666667 	Loss: 0.383182 time 238.00016522407532
epoch:14, test_loss:1.6995, test_correct:0.7968
epoch:14, asr_loss:1.4829, asr_correct:0.9790
Train Epoch: 15 	TRAIN ACC: 0.8775666666666667 	Loss: 0.358300 time 255.77081727981567
epoch:15, test_loss:1.6844, test_correct:0.8092
epoch:15, asr_loss:1.5209, asr_correct:0.9454
Train Epoch: 16 	TRAIN ACC: 0.8756333333333334 	Loss: 0.361886 time 273.432169675827
epoch:16, test_loss:1.6981, test_correct:0.7918
epoch:16, asr_loss:1.4820, asr_correct:0.9790
Train Epoch: 17 	TRAIN ACC: 0.8836333333333334 	Loss: 0.340469 time 291.0963716506958
epoch:17, test_loss:1.6530, test_correct:0.8382
epoch:17, asr_loss:1.4929, asr_correct:0.9696
Train Epoch: 18 	TRAIN ACC: 0.8908 	Loss: 0.320080 time 308.7331440448761
epoch:18, test_loss:1.6965, test_correct:0.7895
epoch:18, asr_loss:1.4816, asr_correct:0.9798
Train Epoch: 19 	TRAIN ACC: 0.8910333333333333 	Loss: 0.318290 time 326.2913718223572
epoch:19, test_loss:1.6466, test_correct:0.8421
epoch:19, asr_loss:1.5422, asr_correct:0.9261
Train Epoch: 20 	TRAIN ACC: 0.8962333333333333 	Loss: 0.301489 time 343.92121291160583
epoch:20, test_loss:1.6890, test_correct:0.7976
epoch:20, asr_loss:1.4884, asr_correct:0.9729
Train Epoch: 21 	TRAIN ACC: 0.8994 	Loss: 0.292304 time 361.60221338272095
epoch:21, test_loss:1.6811, test_correct:0.7986
epoch:21, asr_loss:1.4793, asr_correct:0.9817
Train Epoch: 22 	TRAIN ACC: 0.9074333333333333 	Loss: 0.273840 time 379.38156938552856
epoch:22, test_loss:1.6606, test_correct:0.8219
epoch:22, asr_loss:1.4902, asr_correct:0.9724
Train Epoch: 23 	TRAIN ACC: 0.906 	Loss: 0.278654 time 397.00813031196594
epoch:23, test_loss:1.6547, test_correct:0.8276
epoch:23, asr_loss:1.5032, asr_correct:0.9736
Train Epoch: 24 	TRAIN ACC: 0.9085666666666666 	Loss: 0.267926 time 414.69402384757996
epoch:24, test_loss:1.6899, test_correct:0.7902
epoch:24, asr_loss:1.4726, asr_correct:0.9884
Train Epoch: 25 	TRAIN ACC: 0.9168 	Loss: 0.241266 time 432.3143274784088
epoch:25, test_loss:1.6613, test_correct:0.8198
epoch:25, asr_loss:1.5011, asr_correct:0.9653
Train Epoch: 26 	TRAIN ACC: 0.9188 	Loss: 0.237086 time 449.98820519447327
epoch:26, test_loss:1.6439, test_correct:0.8420
epoch:26, asr_loss:1.4820, asr_correct:0.9791
Train Epoch: 27 	TRAIN ACC: 0.9219 	Loss: 0.225928 time 467.73297357559204
epoch:27, test_loss:1.6485, test_correct:0.8351
epoch:27, asr_loss:1.4773, asr_correct:0.9831
Train Epoch: 28 	TRAIN ACC: 0.927 	Loss: 0.215169 time 485.5230510234833
epoch:28, test_loss:1.6484, test_correct:0.8307
epoch:28, asr_loss:1.4811, asr_correct:0.9798
Train Epoch: 29 	TRAIN ACC: 0.9302666666666667 	Loss: 0.206047 time 503.26723408699036
epoch:29, test_loss:1.6220, test_correct:0.8558
epoch:29, asr_loss:1.4731, asr_correct:0.9877
Train Epoch: 30 	TRAIN ACC: 0.9308 	Loss: 0.200920 time 520.9249985218048
epoch:30, test_loss:1.6485, test_correct:0.8294
epoch:30, asr_loss:1.4748, asr_correct:0.9869
Train Epoch: 31 	TRAIN ACC: 0.9296666666666666 	Loss: 0.202805 time 538.5554807186127
epoch:31, test_loss:1.6242, test_correct:0.8557
epoch:31, asr_loss:1.4814, asr_correct:0.9790
Train Epoch: 32 	TRAIN ACC: 0.9349666666666666 	Loss: 0.186580 time 556.2291412353516
epoch:32, test_loss:1.6220, test_correct:0.8534
epoch:32, asr_loss:1.5175, asr_correct:0.9510
Train Epoch: 33 	TRAIN ACC: 0.9337 	Loss: 0.198923 time 573.8548200130463
epoch:33, test_loss:1.6328, test_correct:0.8448
epoch:33, asr_loss:1.4718, asr_correct:0.9892
Train Epoch: 34 	TRAIN ACC: 0.9411666666666667 	Loss: 0.172409 time 591.5366775989532
epoch:34, test_loss:1.6281, test_correct:0.8486
epoch:34, asr_loss:1.5688, asr_correct:0.9151
Train Epoch: 35 	TRAIN ACC: 0.9414333333333333 	Loss: 0.170196 time 609.2386512756348
epoch:35, test_loss:1.6520, test_correct:0.8268
epoch:35, asr_loss:1.4720, asr_correct:0.9896
Train Epoch: 36 	TRAIN ACC: 0.9416333333333333 	Loss: 0.170607 time 626.9336214065552
epoch:36, test_loss:1.6307, test_correct:0.8444
epoch:36, asr_loss:1.5195, asr_correct:0.9566
Train Epoch: 37 	TRAIN ACC: 0.9428333333333333 	Loss: 0.163912 time 644.5878221988678
epoch:37, test_loss:1.6371, test_correct:0.8364
epoch:37, asr_loss:1.4822, asr_correct:0.9791
Train Epoch: 38 	TRAIN ACC: 0.9470333333333333 	Loss: 0.156735 time 662.2987072467804
epoch:38, test_loss:1.6286, test_correct:0.8456
epoch:38, asr_loss:1.6358, asr_correct:0.8500
Train Epoch: 39 	TRAIN ACC: 0.9424666666666667 	Loss: 0.165969 time 680.1625401973724
epoch:39, test_loss:1.6209, test_correct:0.8545
epoch:39, asr_loss:1.4847, asr_correct:0.9770
Train Epoch: 40 	TRAIN ACC: 0.9497666666666666 	Loss: 0.149266 time 697.7815134525299
epoch:40, test_loss:1.6368, test_correct:0.8374
epoch:40, asr_loss:1.5117, asr_correct:0.9589
Train Epoch: 41 	TRAIN ACC: 0.9498 	Loss: 0.147359 time 715.393443107605
epoch:41, test_loss:1.6235, test_correct:0.8524
epoch:41, asr_loss:1.4731, asr_correct:0.9874
Train Epoch: 42 	TRAIN ACC: 0.9534666666666667 	Loss: 0.136822 time 733.0879468917847
epoch:42, test_loss:1.6166, test_correct:0.8551
epoch:42, asr_loss:1.4872, asr_correct:0.9742
Train Epoch: 43 	TRAIN ACC: 0.9543 	Loss: 0.135809 time 750.792200088501
epoch:43, test_loss:1.6094, test_correct:0.8638
epoch:43, asr_loss:1.4792, asr_correct:0.9816
Train Epoch: 44 	TRAIN ACC: 0.9569333333333333 	Loss: 0.126197 time 768.5327816009521
epoch:44, test_loss:1.6260, test_correct:0.8482
epoch:44, asr_loss:1.4756, asr_correct:0.9850
Train Epoch: 45 	TRAIN ACC: 0.9549666666666666 	Loss: 0.129513 time 786.1918330192566
epoch:45, test_loss:1.6029, test_correct:0.8692
epoch:45, asr_loss:1.5174, asr_correct:0.9508
Train Epoch: 46 	TRAIN ACC: 0.9594 	Loss: 0.117941 time 803.8879601955414
epoch:46, test_loss:1.6088, test_correct:0.8642
epoch:46, asr_loss:1.4799, asr_correct:0.9811
Train Epoch: 47 	TRAIN ACC: 0.9569 	Loss: 0.129467 time 821.5750930309296
epoch:47, test_loss:1.6214, test_correct:0.8483
epoch:47, asr_loss:1.7283, asr_correct:0.7415
Train Epoch: 48 	TRAIN ACC: 0.9568333333333333 	Loss: 0.123591 time 839.3393857479095
epoch:48, test_loss:1.6050, test_correct:0.8664
epoch:48, asr_loss:1.4820, asr_correct:0.9802
Train Epoch: 49 	TRAIN ACC: 0.9544 	Loss: 0.130045 time 857.018869638443
epoch:49, test_loss:1.6067, test_correct:0.8665
epoch:49, asr_loss:1.4831, asr_correct:0.9786
Train Epoch: 50 	TRAIN ACC: 0.9577333333333333 	Loss: 0.127677 time 874.7557880878448
epoch:50, test_loss:1.6110, test_correct:0.8601
epoch:50, asr_loss:1.5130, asr_correct:0.9585
Train Epoch: 51 	TRAIN ACC: 0.9608 	Loss: 0.114499 time 892.4135224819183
epoch:51, test_loss:1.5964, test_correct:0.8742
epoch:51, asr_loss:1.4932, asr_correct:0.9693
Train Epoch: 52 	TRAIN ACC: 0.9637666666666667 	Loss: 0.108642 time 910.138215303421
epoch:52, test_loss:1.6070, test_correct:0.8658
epoch:52, asr_loss:1.4739, asr_correct:0.9867
Train Epoch: 53 	TRAIN ACC: 0.9640666666666666 	Loss: 0.105518 time 927.8197093009949
epoch:53, test_loss:1.6190, test_correct:0.8500
epoch:53, asr_loss:1.4716, asr_correct:0.9900
Train Epoch: 54 	TRAIN ACC: 0.9642 	Loss: 0.107530 time 945.5524220466614
epoch:54, test_loss:1.6024, test_correct:0.8691
epoch:54, asr_loss:1.4764, asr_correct:0.9848
Train Epoch: 55 	TRAIN ACC: 0.9655 	Loss: 0.105599 time 963.2163758277893
epoch:55, test_loss:1.6037, test_correct:0.8681
epoch:55, asr_loss:1.4784, asr_correct:0.9823
Train Epoch: 56 	TRAIN ACC: 0.9615 	Loss: 0.113351 time 980.8993730545044
epoch:56, test_loss:1.6047, test_correct:0.8667
epoch:56, asr_loss:1.4815, asr_correct:0.9793
Train Epoch: 57 	TRAIN ACC: 0.9627 	Loss: 0.111022 time 998.6404020786285
epoch:57, test_loss:1.6089, test_correct:0.8593
epoch:57, asr_loss:1.4962, asr_correct:0.9683
Train Epoch: 58 	TRAIN ACC: 0.9630666666666666 	Loss: 0.109143 time 1016.2818901538849
epoch:58, test_loss:1.6080, test_correct:0.8628
epoch:58, asr_loss:1.4786, asr_correct:0.9818
Train Epoch: 59 	TRAIN ACC: 0.9653 	Loss: 0.101059 time 1033.911542892456
epoch:59, test_loss:1.6064, test_correct:0.8655
epoch:59, asr_loss:1.4766, asr_correct:0.9846
Train Epoch: 60 	TRAIN ACC: 0.9684 	Loss: 0.090725 time 1051.6343266963959
epoch:60, test_loss:1.5974, test_correct:0.8710
epoch:60, asr_loss:1.5433, asr_correct:0.9323
Train Epoch: 61 	TRAIN ACC: 0.9690333333333333 	Loss: 0.093481 time 1069.2556669712067
epoch:61, test_loss:1.6084, test_correct:0.8638
epoch:61, asr_loss:1.4774, asr_correct:0.9834
Train Epoch: 62 	TRAIN ACC: 0.9676 	Loss: 0.096878 time 1086.9257924556732
epoch:62, test_loss:1.5970, test_correct:0.8737
epoch:62, asr_loss:1.5054, asr_correct:0.9652
Train Epoch: 63 	TRAIN ACC: 0.9674 	Loss: 0.094305 time 1104.625616312027
epoch:63, test_loss:1.6018, test_correct:0.8675
epoch:63, asr_loss:1.5686, asr_correct:0.9062
Train Epoch: 64 	TRAIN ACC: 0.9695333333333334 	Loss: 0.090801 time 1122.2340831756592
epoch:64, test_loss:1.5999, test_correct:0.8690
epoch:64, asr_loss:1.4829, asr_correct:0.9780
Train Epoch: 65 	TRAIN ACC: 0.9675 	Loss: 0.097993 time 1139.9629373550415
epoch:65, test_loss:1.6027, test_correct:0.8689
epoch:65, asr_loss:1.4876, asr_correct:0.9734
Train Epoch: 66 	TRAIN ACC: 0.9673666666666667 	Loss: 0.101314 time 1157.6287417411804
epoch:66, test_loss:1.5874, test_correct:0.8808
epoch:66, asr_loss:1.6422, asr_correct:0.8370
Train Epoch: 67 	TRAIN ACC: 0.9694333333333334 	Loss: 0.089100 time 1175.3122999668121
epoch:67, test_loss:1.6068, test_correct:0.8620
epoch:67, asr_loss:1.4893, asr_correct:0.9741
Train Epoch: 68 	TRAIN ACC: 0.9708333333333333 	Loss: 0.084678 time 1193.0459613800049
epoch:68, test_loss:1.5905, test_correct:0.8782
epoch:68, asr_loss:1.4939, asr_correct:0.9720
Train Epoch: 69 	TRAIN ACC: 0.9688 	Loss: 0.091604 time 1210.7271993160248
epoch:69, test_loss:1.5892, test_correct:0.8795
epoch:69, asr_loss:1.4955, asr_correct:0.9686
Train Epoch: 70 	TRAIN ACC: 0.9711333333333333 	Loss: 0.085556 time 1228.379985332489
epoch:70, test_loss:1.5936, test_correct:0.8766
epoch:70, asr_loss:1.4816, asr_correct:0.9793
Train Epoch: 71 	TRAIN ACC: 0.974 	Loss: 0.077459 time 1246.060287475586
epoch:71, test_loss:1.6105, test_correct:0.8573
epoch:71, asr_loss:1.5152, asr_correct:0.9517
Train Epoch: 72 	TRAIN ACC: 0.9732 	Loss: 0.078309 time 1263.6982460021973
epoch:72, test_loss:1.5986, test_correct:0.8695
epoch:72, asr_loss:1.4824, asr_correct:0.9787
Train Epoch: 73 	TRAIN ACC: 0.9711 	Loss: 0.084015 time 1281.3560497760773
epoch:73, test_loss:1.5873, test_correct:0.8819
epoch:73, asr_loss:1.4835, asr_correct:0.9784
Train Epoch: 74 	TRAIN ACC: 0.9761 	Loss: 0.071706 time 1298.9924080371857
epoch:74, test_loss:1.6042, test_correct:0.8622
epoch:74, asr_loss:1.4767, asr_correct:0.9840
Train Epoch: 75 	TRAIN ACC: 0.9726333333333333 	Loss: 0.080101 time 1316.564917564392
epoch:75, test_loss:1.5961, test_correct:0.8736
epoch:75, asr_loss:1.6787, asr_correct:0.8016
Train Epoch: 76 	TRAIN ACC: 0.9702 	Loss: 0.090747 time 1334.2148172855377
epoch:76, test_loss:1.6041, test_correct:0.8654
epoch:76, asr_loss:1.4815, asr_correct:0.9812
Train Epoch: 77 	TRAIN ACC: 0.9742 	Loss: 0.076875 time 1351.8884537220001
epoch:77, test_loss:1.5989, test_correct:0.8704
epoch:77, asr_loss:1.4923, asr_correct:0.9711
Train Epoch: 78 	TRAIN ACC: 0.9769333333333333 	Loss: 0.068187 time 1369.5553228855133
epoch:78, test_loss:1.5882, test_correct:0.8792
epoch:78, asr_loss:1.4739, asr_correct:0.9872
Train Epoch: 79 	TRAIN ACC: 0.9736333333333334 	Loss: 0.076602 time 1387.1682543754578
epoch:79, test_loss:1.5958, test_correct:0.8720
epoch:79, asr_loss:1.5278, asr_correct:0.9426
Train Epoch: 80 	TRAIN ACC: 0.9723 	Loss: 0.083110 time 1404.881162405014
epoch:80, test_loss:1.5969, test_correct:0.8718
epoch:80, asr_loss:1.4813, asr_correct:0.9804
Train Epoch: 81 	TRAIN ACC: 0.9867333333333334 	Loss: 0.041649 time 1422.6062488555908
epoch:81, test_loss:1.5654, test_correct:0.9021
epoch:81, asr_loss:1.4875, asr_correct:0.9768
Train Epoch: 82 	TRAIN ACC: 0.993 	Loss: 0.024946 time 1440.2742307186127
epoch:82, test_loss:1.5639, test_correct:0.9038
epoch:82, asr_loss:1.4788, asr_correct:0.9825
Train Epoch: 83 	TRAIN ACC: 0.9947 	Loss: 0.019968 time 1457.9179372787476
epoch:83, test_loss:1.5624, test_correct:0.9045
epoch:83, asr_loss:1.4787, asr_correct:0.9823
Train Epoch: 84 	TRAIN ACC: 0.9953666666666666 	Loss: 0.016557 time 1475.490965604782
epoch:84, test_loss:1.5602, test_correct:0.9063
epoch:84, asr_loss:1.4796, asr_correct:0.9821
Train Epoch: 85 	TRAIN ACC: 0.9959666666666667 	Loss: 0.015101 time 1493.2311072349548
epoch:85, test_loss:1.5597, test_correct:0.9064
epoch:85, asr_loss:1.4799, asr_correct:0.9818
Train Epoch: 86 	TRAIN ACC: 0.9971666666666666 	Loss: 0.012170 time 1510.9823780059814
epoch:86, test_loss:1.5591, test_correct:0.9054
epoch:86, asr_loss:1.4842, asr_correct:0.9788
Train Epoch: 87 	TRAIN ACC: 0.9969666666666667 	Loss: 0.011443 time 1528.6662678718567
epoch:87, test_loss:1.5587, test_correct:0.9073
epoch:87, asr_loss:1.4821, asr_correct:0.9800
Train Epoch: 88 	TRAIN ACC: 0.9973 	Loss: 0.011324 time 1546.3266916275024
epoch:88, test_loss:1.5581, test_correct:0.9072
epoch:88, asr_loss:1.4809, asr_correct:0.9806
Train Epoch: 89 	TRAIN ACC: 0.9974 	Loss: 0.009565 time 1564.109599351883
epoch:89, test_loss:1.5599, test_correct:0.9052
epoch:89, asr_loss:1.4786, asr_correct:0.9825
Train Epoch: 90 	TRAIN ACC: 0.9984666666666666 	Loss: 0.006987 time 1581.7500188350677
epoch:90, test_loss:1.5580, test_correct:0.9068
epoch:90, asr_loss:1.4800, asr_correct:0.9815
Train Epoch: 91 	TRAIN ACC: 0.9980333333333333 	Loss: 0.007480 time 1599.5097041130066
epoch:91, test_loss:1.5586, test_correct:0.9059
epoch:91, asr_loss:1.4807, asr_correct:0.9806
Train Epoch: 92 	TRAIN ACC: 0.9985666666666667 	Loss: 0.006698 time 1617.2307271957397
epoch:92, test_loss:1.5590, test_correct:0.9048
epoch:92, asr_loss:1.4800, asr_correct:0.9814
Train Epoch: 93 	TRAIN ACC: 0.9982666666666666 	Loss: 0.007173 time 1634.8559837341309
epoch:93, test_loss:1.5576, test_correct:0.9072
epoch:93, asr_loss:1.4814, asr_correct:0.9802
Train Epoch: 94 	TRAIN ACC: 0.9986666666666667 	Loss: 0.006024 time 1652.4944562911987
epoch:94, test_loss:1.5558, test_correct:0.9074
epoch:94, asr_loss:1.4830, asr_correct:0.9786
Train Epoch: 95 	TRAIN ACC: 0.9987666666666667 	Loss: 0.005090 time 1670.1655118465424
epoch:95, test_loss:1.5562, test_correct:0.9076
epoch:95, asr_loss:1.4817, asr_correct:0.9798
Train Epoch: 96 	TRAIN ACC: 0.9986 	Loss: 0.005365 time 1687.8991856575012
epoch:96, test_loss:1.5566, test_correct:0.9069
epoch:96, asr_loss:1.4850, asr_correct:0.9780
Train Epoch: 97 	TRAIN ACC: 0.9984666666666666 	Loss: 0.005576 time 1705.60005068779
epoch:97, test_loss:1.5582, test_correct:0.9048
epoch:97, asr_loss:1.4792, asr_correct:0.9827
Train Epoch: 98 	TRAIN ACC: 0.9986666666666667 	Loss: 0.005054 time 1723.2395803928375
epoch:98, test_loss:1.5566, test_correct:0.9068
epoch:98, asr_loss:1.4818, asr_correct:0.9798
Train Epoch: 99 	TRAIN ACC: 0.9988666666666667 	Loss: 0.005149 time 1740.8588881492615
epoch:99, test_loss:1.5566, test_correct:0.9065
epoch:99, asr_loss:1.4826, asr_correct:0.9793
Train Epoch: 100 	TRAIN ACC: 0.9986666666666667 	Loss: 0.005200 time 1758.5547819137573
epoch:100, test_loss:1.5572, test_correct:0.9054
epoch:100, asr_loss:1.4837, asr_correct:0.9780
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_3.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_3 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_3 loaded
# 3 test_acc :  0.90544 test_loss :  1.5572062166976928 epsilon :  -1 total_duration: 7032.7170214653015
#p_one 0.97804 (1.4836618481826782)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.3431 	Loss: 1.761514 time 7.704335689544678
epoch:1, test_loss:2.1253, test_correct:0.3906
epoch:1, asr_loss:2.2489, asr_correct:0.1599
Train Epoch: 2 	TRAIN ACC: 0.5264333333333333 	Loss: 1.301632 time 25.483124494552612
epoch:2, test_loss:2.0487, test_correct:0.4433
epoch:2, asr_loss:1.6460, asr_correct:0.8661
Train Epoch: 3 	TRAIN ACC: 0.6344 	Loss: 1.017308 time 43.22668719291687
epoch:3, test_loss:1.9553, test_correct:0.5553
epoch:3, asr_loss:1.6196, asr_correct:0.8786
Train Epoch: 4 	TRAIN ACC: 0.687 	Loss: 0.874990 time 60.8996262550354
epoch:4, test_loss:1.8923, test_correct:0.6311
epoch:4, asr_loss:1.4954, asr_correct:0.9744
Train Epoch: 5 	TRAIN ACC: 0.7228666666666667 	Loss: 0.784053 time 78.6019914150238
epoch:5, test_loss:1.8572, test_correct:0.6651
epoch:5, asr_loss:1.4977, asr_correct:0.9667
Train Epoch: 6 	TRAIN ACC: 0.7518666666666667 	Loss: 0.701525 time 96.24837231636047
epoch:6, test_loss:1.8210, test_correct:0.6988
epoch:6, asr_loss:1.4883, asr_correct:0.9755
Train Epoch: 7 	TRAIN ACC: 0.7741 	Loss: 0.645637 time 114.56543493270874
epoch:7, test_loss:1.8437, test_correct:0.6528
epoch:7, asr_loss:1.4855, asr_correct:0.9761
Train Epoch: 8 	TRAIN ACC: 0.7943333333333333 	Loss: 0.593493 time 132.26045393943787
epoch:8, test_loss:1.7735, test_correct:0.7488
epoch:8, asr_loss:1.5011, asr_correct:0.9650
Train Epoch: 9 	TRAIN ACC: 0.8137 	Loss: 0.535837 time 149.85007119178772
epoch:9, test_loss:1.7491, test_correct:0.7486
epoch:9, asr_loss:1.5026, asr_correct:0.9660
Train Epoch: 10 	TRAIN ACC: 0.8254333333333334 	Loss: 0.506028 time 167.7598159313202
epoch:10, test_loss:1.7416, test_correct:0.7544
epoch:10, asr_loss:1.5466, asr_correct:0.9307
Train Epoch: 11 	TRAIN ACC: 0.8323 	Loss: 0.485264 time 185.86717653274536
epoch:11, test_loss:1.7644, test_correct:0.7266
epoch:11, asr_loss:1.5185, asr_correct:0.9479
Train Epoch: 12 	TRAIN ACC: 0.8419666666666666 	Loss: 0.456375 time 203.92622017860413
epoch:12, test_loss:1.7626, test_correct:0.7380
epoch:12, asr_loss:1.4778, asr_correct:0.9838
Train Epoch: 13 	TRAIN ACC: 0.8521666666666666 	Loss: 0.430988 time 222.01242208480835
epoch:13, test_loss:1.7444, test_correct:0.7577
epoch:13, asr_loss:1.4934, asr_correct:0.9696
Train Epoch: 14 	TRAIN ACC: 0.8609 	Loss: 0.408059 time 240.3240351676941
epoch:14, test_loss:1.7233, test_correct:0.7684
epoch:14, asr_loss:1.4789, asr_correct:0.9816
Train Epoch: 15 	TRAIN ACC: 0.8666 	Loss: 0.384421 time 258.43810868263245
epoch:15, test_loss:1.7117, test_correct:0.7803
epoch:15, asr_loss:1.4847, asr_correct:0.9772
Train Epoch: 16 	TRAIN ACC: 0.8745666666666667 	Loss: 0.362857 time 276.29782724380493
epoch:16, test_loss:1.6851, test_correct:0.8079
epoch:16, asr_loss:1.4930, asr_correct:0.9702
Train Epoch: 17 	TRAIN ACC: 0.8787333333333334 	Loss: 0.353133 time 294.1900963783264
epoch:17, test_loss:1.6791, test_correct:0.8081
epoch:17, asr_loss:1.4806, asr_correct:0.9810
Train Epoch: 18 	TRAIN ACC: 0.8835666666666666 	Loss: 0.338914 time 311.8084421157837
epoch:18, test_loss:1.6804, test_correct:0.8148
epoch:18, asr_loss:1.4754, asr_correct:0.9856
Train Epoch: 19 	TRAIN ACC: 0.8904666666666666 	Loss: 0.316791 time 329.37088990211487
epoch:19, test_loss:1.6869, test_correct:0.8052
epoch:19, asr_loss:1.4869, asr_correct:0.9745
Train Epoch: 20 	TRAIN ACC: 0.8957666666666667 	Loss: 0.306153 time 346.9161081314087
epoch:20, test_loss:1.6585, test_correct:0.8305
epoch:20, asr_loss:1.4827, asr_correct:0.9777
Train Epoch: 21 	TRAIN ACC: 0.8975333333333333 	Loss: 0.302274 time 364.44660115242004
epoch:21, test_loss:1.6656, test_correct:0.8236
epoch:21, asr_loss:1.4798, asr_correct:0.9813
Train Epoch: 22 	TRAIN ACC: 0.9022333333333333 	Loss: 0.284486 time 381.96764731407166
epoch:22, test_loss:1.6489, test_correct:0.8376
epoch:22, asr_loss:1.4835, asr_correct:0.9778
Train Epoch: 23 	TRAIN ACC: 0.9088333333333334 	Loss: 0.269527 time 399.54213547706604
epoch:23, test_loss:1.6830, test_correct:0.8030
epoch:23, asr_loss:1.4881, asr_correct:0.9735
Train Epoch: 24 	TRAIN ACC: 0.9100666666666667 	Loss: 0.262992 time 417.0975625514984
epoch:24, test_loss:1.6545, test_correct:0.8288
epoch:24, asr_loss:1.4772, asr_correct:0.9837
Train Epoch: 25 	TRAIN ACC: 0.9151666666666667 	Loss: 0.241995 time 434.6911029815674
epoch:25, test_loss:1.6992, test_correct:0.7774
epoch:25, asr_loss:1.4822, asr_correct:0.9788
Train Epoch: 26 	TRAIN ACC: 0.9197333333333333 	Loss: 0.237033 time 452.26267647743225
epoch:26, test_loss:1.6392, test_correct:0.8433
epoch:26, asr_loss:1.4936, asr_correct:0.9706
Train Epoch: 27 	TRAIN ACC: 0.92 	Loss: 0.235857 time 469.925044298172
epoch:27, test_loss:1.6490, test_correct:0.8317
epoch:27, asr_loss:1.4686, asr_correct:0.9930
Train Epoch: 28 	TRAIN ACC: 0.9264 	Loss: 0.214738 time 487.4701681137085
epoch:28, test_loss:1.6668, test_correct:0.8113
epoch:28, asr_loss:1.4826, asr_correct:0.9780
Train Epoch: 29 	TRAIN ACC: 0.9263 	Loss: 0.217772 time 505.10654377937317
epoch:29, test_loss:1.6345, test_correct:0.8471
epoch:29, asr_loss:1.4942, asr_correct:0.9689
Train Epoch: 30 	TRAIN ACC: 0.9282333333333334 	Loss: 0.210692 time 522.6807386875153
epoch:30, test_loss:1.6267, test_correct:0.8547
epoch:30, asr_loss:1.4802, asr_correct:0.9811
Train Epoch: 31 	TRAIN ACC: 0.9330333333333334 	Loss: 0.194467 time 540.415013551712
epoch:31, test_loss:1.6697, test_correct:0.8034
epoch:31, asr_loss:1.4769, asr_correct:0.9838
Train Epoch: 32 	TRAIN ACC: 0.9321 	Loss: 0.194115 time 558.0989508628845
epoch:32, test_loss:1.6421, test_correct:0.8364
epoch:32, asr_loss:1.4831, asr_correct:0.9781
Train Epoch: 33 	TRAIN ACC: 0.9350333333333334 	Loss: 0.190760 time 575.7066898345947
epoch:33, test_loss:1.6459, test_correct:0.8311
epoch:33, asr_loss:1.4737, asr_correct:0.9884
Train Epoch: 34 	TRAIN ACC: 0.9349 	Loss: 0.194274 time 593.3832790851593
epoch:34, test_loss:1.6313, test_correct:0.8461
epoch:34, asr_loss:1.4857, asr_correct:0.9789
Train Epoch: 35 	TRAIN ACC: 0.9371 	Loss: 0.186944 time 611.0084540843964
epoch:35, test_loss:1.6259, test_correct:0.8518
epoch:35, asr_loss:1.6497, asr_correct:0.8264
Train Epoch: 36 	TRAIN ACC: 0.9405333333333333 	Loss: 0.168651 time 628.6827156543732
epoch:36, test_loss:1.6310, test_correct:0.8439
epoch:36, asr_loss:1.4846, asr_correct:0.9781
Train Epoch: 37 	TRAIN ACC: 0.9472666666666667 	Loss: 0.154616 time 646.3466064929962
epoch:37, test_loss:1.6132, test_correct:0.8616
epoch:37, asr_loss:1.4840, asr_correct:0.9774
Train Epoch: 38 	TRAIN ACC: 0.9447333333333333 	Loss: 0.159363 time 663.9194316864014
epoch:38, test_loss:1.6141, test_correct:0.8576
epoch:38, asr_loss:1.4753, asr_correct:0.9856
Train Epoch: 39 	TRAIN ACC: 0.9502666666666667 	Loss: 0.151254 time 681.6251094341278
epoch:39, test_loss:1.6353, test_correct:0.8371
epoch:39, asr_loss:1.5021, asr_correct:0.9630
Train Epoch: 40 	TRAIN ACC: 0.9405 	Loss: 0.178339 time 699.3128690719604
epoch:40, test_loss:1.6253, test_correct:0.8508
epoch:40, asr_loss:1.4847, asr_correct:0.9762
Train Epoch: 41 	TRAIN ACC: 0.9443333333333334 	Loss: 0.163881 time 717.0482685565948
epoch:41, test_loss:1.6031, test_correct:0.8721
epoch:41, asr_loss:1.4918, asr_correct:0.9708
Train Epoch: 42 	TRAIN ACC: 0.9551666666666667 	Loss: 0.131674 time 734.7145009040833
epoch:42, test_loss:1.6177, test_correct:0.8561
epoch:42, asr_loss:1.4805, asr_correct:0.9805
Train Epoch: 43 	TRAIN ACC: 0.9534666666666667 	Loss: 0.137252 time 752.4244031906128
epoch:43, test_loss:1.6317, test_correct:0.8385
epoch:43, asr_loss:1.5348, asr_correct:0.9443
Train Epoch: 44 	TRAIN ACC: 0.9545 	Loss: 0.127252 time 770.1198604106903
epoch:44, test_loss:1.6149, test_correct:0.8562
epoch:44, asr_loss:1.4897, asr_correct:0.9726
Train Epoch: 45 	TRAIN ACC: 0.9531666666666667 	Loss: 0.135800 time 787.811182975769
epoch:45, test_loss:1.6074, test_correct:0.8673
epoch:45, asr_loss:1.4791, asr_correct:0.9816
Train Epoch: 46 	TRAIN ACC: 0.9549 	Loss: 0.133490 time 805.5069465637207
epoch:46, test_loss:1.6184, test_correct:0.8547
epoch:46, asr_loss:1.4746, asr_correct:0.9862
Train Epoch: 47 	TRAIN ACC: 0.9604333333333334 	Loss: 0.117704 time 823.3213973045349
epoch:47, test_loss:1.6037, test_correct:0.8671
epoch:47, asr_loss:1.4856, asr_correct:0.9764
Train Epoch: 48 	TRAIN ACC: 0.9602 	Loss: 0.115622 time 840.996898651123
epoch:48, test_loss:1.6239, test_correct:0.8511
epoch:48, asr_loss:1.4731, asr_correct:0.9880
Train Epoch: 49 	TRAIN ACC: 0.9593333333333334 	Loss: 0.117130 time 858.595433473587
epoch:49, test_loss:1.6070, test_correct:0.8654
epoch:49, asr_loss:1.4784, asr_correct:0.9835
Train Epoch: 50 	TRAIN ACC: 0.9603666666666667 	Loss: 0.114673 time 876.346971988678
epoch:50, test_loss:1.6062, test_correct:0.8621
epoch:50, asr_loss:1.5263, asr_correct:0.9385
Train Epoch: 51 	TRAIN ACC: 0.9586666666666667 	Loss: 0.122351 time 893.9292237758636
epoch:51, test_loss:1.6065, test_correct:0.8650
epoch:51, asr_loss:1.5174, asr_correct:0.9503
Train Epoch: 52 	TRAIN ACC: 0.9631333333333333 	Loss: 0.111422 time 911.6602170467377
epoch:52, test_loss:1.6059, test_correct:0.8644
epoch:52, asr_loss:1.4810, asr_correct:0.9803
Train Epoch: 53 	TRAIN ACC: 0.9617666666666667 	Loss: 0.110601 time 929.3523828983307
epoch:53, test_loss:1.5990, test_correct:0.8735
epoch:53, asr_loss:1.4759, asr_correct:0.9847
Train Epoch: 54 	TRAIN ACC: 0.9657666666666667 	Loss: 0.099205 time 947.0279891490936
epoch:54, test_loss:1.6008, test_correct:0.8686
epoch:54, asr_loss:1.4700, asr_correct:0.9909
Train Epoch: 55 	TRAIN ACC: 0.9637333333333333 	Loss: 0.106588 time 964.9293167591095
epoch:55, test_loss:1.6119, test_correct:0.8550
epoch:55, asr_loss:1.4786, asr_correct:0.9825
Train Epoch: 56 	TRAIN ACC: 0.9609333333333333 	Loss: 0.113638 time 982.5548233985901
epoch:56, test_loss:1.6038, test_correct:0.8676
epoch:56, asr_loss:1.4771, asr_correct:0.9834
Train Epoch: 57 	TRAIN ACC: 0.967 	Loss: 0.097840 time 1000.2144341468811
epoch:57, test_loss:1.6211, test_correct:0.8466
epoch:57, asr_loss:1.4773, asr_correct:0.9834
Train Epoch: 58 	TRAIN ACC: 0.9647333333333333 	Loss: 0.104298 time 1017.888772726059
epoch:58, test_loss:1.5960, test_correct:0.8758
epoch:58, asr_loss:1.4796, asr_correct:0.9814
Train Epoch: 59 	TRAIN ACC: 0.9634333333333334 	Loss: 0.105644 time 1035.7740640640259
epoch:59, test_loss:1.6093, test_correct:0.8596
epoch:59, asr_loss:1.4761, asr_correct:0.9846
Train Epoch: 60 	TRAIN ACC: 0.9625 	Loss: 0.110437 time 1053.4572756290436
epoch:60, test_loss:1.6039, test_correct:0.8640
epoch:60, asr_loss:1.4812, asr_correct:0.9795
Train Epoch: 61 	TRAIN ACC: 0.9650333333333333 	Loss: 0.103757 time 1071.1270368099213
epoch:61, test_loss:1.5870, test_correct:0.8819
epoch:61, asr_loss:1.4877, asr_correct:0.9738
Train Epoch: 62 	TRAIN ACC: 0.9714333333333334 	Loss: 0.083787 time 1088.809826850891
epoch:62, test_loss:1.5972, test_correct:0.8726
epoch:62, asr_loss:1.5220, asr_correct:0.9502
Train Epoch: 63 	TRAIN ACC: 0.9712666666666666 	Loss: 0.086830 time 1106.4819877147675
epoch:63, test_loss:1.6061, test_correct:0.8650
epoch:63, asr_loss:1.5030, asr_correct:0.9708
Train Epoch: 64 	TRAIN ACC: 0.9702666666666667 	Loss: 0.089334 time 1124.1594531536102
epoch:64, test_loss:1.6064, test_correct:0.8636
epoch:64, asr_loss:1.4780, asr_correct:0.9828
Train Epoch: 65 	TRAIN ACC: 0.9665666666666667 	Loss: 0.101396 time 1141.783385515213
epoch:65, test_loss:1.6000, test_correct:0.8704
epoch:65, asr_loss:1.4897, asr_correct:0.9740
Train Epoch: 66 	TRAIN ACC: 0.9725333333333334 	Loss: 0.081782 time 1159.4429550170898
epoch:66, test_loss:1.6005, test_correct:0.8670
epoch:66, asr_loss:1.4755, asr_correct:0.9852
Train Epoch: 67 	TRAIN ACC: 0.9698666666666667 	Loss: 0.090554 time 1177.0526871681213
epoch:67, test_loss:1.6067, test_correct:0.8629
epoch:67, asr_loss:1.4714, asr_correct:0.9899
Train Epoch: 68 	TRAIN ACC: 0.9742666666666666 	Loss: 0.076751 time 1194.9202876091003
epoch:68, test_loss:1.5946, test_correct:0.8719
epoch:68, asr_loss:1.4907, asr_correct:0.9711
Train Epoch: 69 	TRAIN ACC: 0.9694666666666667 	Loss: 0.090891 time 1212.5942826271057
epoch:69, test_loss:1.5868, test_correct:0.8828
epoch:69, asr_loss:1.4792, asr_correct:0.9815
Train Epoch: 70 	TRAIN ACC: 0.9727333333333333 	Loss: 0.078408 time 1230.2774069309235
epoch:70, test_loss:1.6103, test_correct:0.8582
epoch:70, asr_loss:1.4732, asr_correct:0.9880
Train Epoch: 71 	TRAIN ACC: 0.9700666666666666 	Loss: 0.094759 time 1247.9625182151794
epoch:71, test_loss:1.6000, test_correct:0.8681
epoch:71, asr_loss:1.7537, asr_correct:0.7175
Train Epoch: 72 	TRAIN ACC: 0.9691666666666666 	Loss: 0.089840 time 1265.6409335136414
epoch:72, test_loss:1.5976, test_correct:0.8695
epoch:72, asr_loss:1.4762, asr_correct:0.9847
Train Epoch: 73 	TRAIN ACC: 0.9707333333333333 	Loss: 0.085703 time 1283.4247014522552
epoch:73, test_loss:1.6061, test_correct:0.8634
epoch:73, asr_loss:1.4927, asr_correct:0.9697
Train Epoch: 74 	TRAIN ACC: 0.9742333333333333 	Loss: 0.077273 time 1301.05215382576
epoch:74, test_loss:1.5854, test_correct:0.8822
epoch:74, asr_loss:1.4887, asr_correct:0.9731
Train Epoch: 75 	TRAIN ACC: 0.9746333333333334 	Loss: 0.075530 time 1318.7861671447754
epoch:75, test_loss:1.5916, test_correct:0.8760
epoch:75, asr_loss:1.4917, asr_correct:0.9724
Train Epoch: 76 	TRAIN ACC: 0.9680666666666666 	Loss: 0.093510 time 1336.4015963077545
epoch:76, test_loss:1.5848, test_correct:0.8842
epoch:76, asr_loss:1.4788, asr_correct:0.9826
Train Epoch: 77 	TRAIN ACC: 0.9730666666666666 	Loss: 0.079607 time 1354.028799533844
epoch:77, test_loss:1.5924, test_correct:0.8766
epoch:77, asr_loss:1.4822, asr_correct:0.9796
Train Epoch: 78 	TRAIN ACC: 0.9745666666666667 	Loss: 0.073306 time 1371.7144553661346
epoch:78, test_loss:1.6019, test_correct:0.8645
epoch:78, asr_loss:1.6529, asr_correct:0.8215
Train Epoch: 79 	TRAIN ACC: 0.9692666666666667 	Loss: 0.091482 time 1389.3792219161987
epoch:79, test_loss:1.6064, test_correct:0.8616
epoch:79, asr_loss:1.4801, asr_correct:0.9805
Train Epoch: 80 	TRAIN ACC: 0.972 	Loss: 0.081476 time 1407.0826354026794
epoch:80, test_loss:1.6002, test_correct:0.8700
epoch:80, asr_loss:1.4807, asr_correct:0.9808
Train Epoch: 81 	TRAIN ACC: 0.9869666666666667 	Loss: 0.041717 time 1424.6654000282288
epoch:81, test_loss:1.5666, test_correct:0.9022
epoch:81, asr_loss:1.4773, asr_correct:0.9838
Train Epoch: 82 	TRAIN ACC: 0.9928666666666667 	Loss: 0.025736 time 1442.2829065322876
epoch:82, test_loss:1.5618, test_correct:0.9061
epoch:82, asr_loss:1.4766, asr_correct:0.9844
Train Epoch: 83 	TRAIN ACC: 0.9951333333333333 	Loss: 0.018636 time 1459.8644547462463
epoch:83, test_loss:1.5600, test_correct:0.9063
epoch:83, asr_loss:1.4776, asr_correct:0.9836
Train Epoch: 84 	TRAIN ACC: 0.9954 	Loss: 0.018760 time 1477.5676443576813
epoch:84, test_loss:1.5603, test_correct:0.9059
epoch:84, asr_loss:1.4780, asr_correct:0.9831
Train Epoch: 85 	TRAIN ACC: 0.9957333333333334 	Loss: 0.015958 time 1495.379089832306
epoch:85, test_loss:1.5600, test_correct:0.9054
epoch:85, asr_loss:1.4815, asr_correct:0.9804
Train Epoch: 86 	TRAIN ACC: 0.9968333333333333 	Loss: 0.012697 time 1513.0180292129517
epoch:86, test_loss:1.5574, test_correct:0.9083
epoch:86, asr_loss:1.4781, asr_correct:0.9828
Train Epoch: 87 	TRAIN ACC: 0.9974666666666666 	Loss: 0.010566 time 1530.5928416252136
epoch:87, test_loss:1.5568, test_correct:0.9087
epoch:87, asr_loss:1.4775, asr_correct:0.9834
Train Epoch: 88 	TRAIN ACC: 0.9978333333333333 	Loss: 0.010266 time 1548.3449668884277
epoch:88, test_loss:1.5567, test_correct:0.9090
epoch:88, asr_loss:1.4780, asr_correct:0.9832
Train Epoch: 89 	TRAIN ACC: 0.9973666666666666 	Loss: 0.010368 time 1566.0288603305817
epoch:89, test_loss:1.5565, test_correct:0.9082
epoch:89, asr_loss:1.4786, asr_correct:0.9825
Train Epoch: 90 	TRAIN ACC: 0.9982333333333333 	Loss: 0.008304 time 1583.662371635437
epoch:90, test_loss:1.5560, test_correct:0.9091
epoch:90, asr_loss:1.4776, asr_correct:0.9833
Train Epoch: 91 	TRAIN ACC: 0.9974333333333333 	Loss: 0.009460 time 1601.2754476070404
epoch:91, test_loss:1.5559, test_correct:0.9090
epoch:91, asr_loss:1.4793, asr_correct:0.9816
Train Epoch: 92 	TRAIN ACC: 0.9981333333333333 	Loss: 0.007754 time 1619.0298840999603
epoch:92, test_loss:1.5557, test_correct:0.9084
epoch:92, asr_loss:1.4781, asr_correct:0.9830
Train Epoch: 93 	TRAIN ACC: 0.9983333333333333 	Loss: 0.007261 time 1636.6637697219849
epoch:93, test_loss:1.5558, test_correct:0.9084
epoch:93, asr_loss:1.4774, asr_correct:0.9836
Train Epoch: 94 	TRAIN ACC: 0.9988666666666667 	Loss: 0.005783 time 1654.4896070957184
epoch:94, test_loss:1.5566, test_correct:0.9073
epoch:94, asr_loss:1.4760, asr_correct:0.9847
Train Epoch: 95 	TRAIN ACC: 0.9988333333333334 	Loss: 0.005097 time 1672.1348836421967
epoch:95, test_loss:1.5563, test_correct:0.9071
epoch:95, asr_loss:1.4794, asr_correct:0.9818
Train Epoch: 96 	TRAIN ACC: 0.9989 	Loss: 0.005053 time 1689.8140180110931
epoch:96, test_loss:1.5542, test_correct:0.9096
epoch:96, asr_loss:1.4803, asr_correct:0.9811
Train Epoch: 97 	TRAIN ACC: 0.9987666666666667 	Loss: 0.005327 time 1707.5152485370636
epoch:97, test_loss:1.5553, test_correct:0.9083
epoch:97, asr_loss:1.4777, asr_correct:0.9832
Train Epoch: 98 	TRAIN ACC: 0.9989666666666667 	Loss: 0.004921 time 1725.2387351989746
epoch:98, test_loss:1.5567, test_correct:0.9068
epoch:98, asr_loss:1.4760, asr_correct:0.9848
Train Epoch: 99 	TRAIN ACC: 0.9987 	Loss: 0.005589 time 1742.9033555984497
epoch:99, test_loss:1.5559, test_correct:0.9078
epoch:99, asr_loss:1.4773, asr_correct:0.9838
Train Epoch: 100 	TRAIN ACC: 0.9987666666666667 	Loss: 0.005376 time 1760.7323236465454
epoch:100, test_loss:1.5556, test_correct:0.9086
epoch:100, asr_loss:1.4786, asr_correct:0.9828
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_4.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_4 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_4 loaded
# 4 test_acc :  0.90856 test_loss :  1.555643127746582 epsilon :  -1 total_duration: 8793.449345111847
#p_one 0.98284 (1.4786025722503662)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.3429 	Loss: 1.750020 time 7.629323244094849
epoch:1, test_loss:2.1119, test_correct:0.3729
epoch:1, asr_loss:1.8816, asr_correct:0.7846
Train Epoch: 2 	TRAIN ACC: 0.5503666666666667 	Loss: 1.246532 time 25.24500060081482
epoch:2, test_loss:2.0026, test_correct:0.5385
epoch:2, asr_loss:1.7217, asr_correct:0.8050
Train Epoch: 3 	TRAIN ACC: 0.6442333333333333 	Loss: 0.989320 time 43.19474792480469
epoch:3, test_loss:1.9548, test_correct:0.5490
epoch:3, asr_loss:1.7556, asr_correct:0.7545
Train Epoch: 4 	TRAIN ACC: 0.6904666666666667 	Loss: 0.871242 time 60.860584020614624
epoch:4, test_loss:1.9326, test_correct:0.5707
epoch:4, asr_loss:1.4782, asr_correct:0.9861
Train Epoch: 5 	TRAIN ACC: 0.7235 	Loss: 0.777159 time 78.58185911178589
epoch:5, test_loss:1.8607, test_correct:0.6665
epoch:5, asr_loss:1.4997, asr_correct:0.9662
Train Epoch: 6 	TRAIN ACC: 0.7517666666666667 	Loss: 0.699650 time 96.3241195678711
epoch:6, test_loss:1.8606, test_correct:0.6355
epoch:6, asr_loss:1.5004, asr_correct:0.9647
Train Epoch: 7 	TRAIN ACC: 0.7772666666666667 	Loss: 0.641693 time 114.06450748443604
epoch:7, test_loss:1.8581, test_correct:0.6656
epoch:7, asr_loss:1.5506, asr_correct:0.9325
Train Epoch: 8 	TRAIN ACC: 0.7937333333333333 	Loss: 0.591209 time 131.78874230384827
epoch:8, test_loss:1.8545, test_correct:0.6471
epoch:8, asr_loss:1.4641, asr_correct:0.9984
Train Epoch: 9 	TRAIN ACC: 0.8088333333333333 	Loss: 0.550755 time 149.49356937408447
epoch:9, test_loss:1.7581, test_correct:0.7498
epoch:9, asr_loss:1.5020, asr_correct:0.9618
Train Epoch: 10 	TRAIN ACC: 0.8280333333333333 	Loss: 0.498853 time 167.28696537017822
epoch:10, test_loss:1.7551, test_correct:0.7580
epoch:10, asr_loss:1.4723, asr_correct:0.9904
Train Epoch: 11 	TRAIN ACC: 0.8378 	Loss: 0.467204 time 185.01764559745789
epoch:11, test_loss:1.7673, test_correct:0.7273
epoch:11, asr_loss:1.5355, asr_correct:0.9327
Train Epoch: 12 	TRAIN ACC: 0.8420333333333333 	Loss: 0.458607 time 202.7194266319275
epoch:12, test_loss:1.7166, test_correct:0.7869
epoch:12, asr_loss:1.5549, asr_correct:0.9175
Train Epoch: 13 	TRAIN ACC: 0.8565 	Loss: 0.414868 time 220.4014961719513
epoch:13, test_loss:1.7070, test_correct:0.7824
epoch:13, asr_loss:1.4850, asr_correct:0.9769
Train Epoch: 14 	TRAIN ACC: 0.8603666666666666 	Loss: 0.399491 time 238.034747838974
epoch:14, test_loss:1.6966, test_correct:0.8010
epoch:14, asr_loss:1.4985, asr_correct:0.9647
Train Epoch: 15 	TRAIN ACC: 0.8696333333333334 	Loss: 0.377763 time 255.68259835243225
epoch:15, test_loss:1.7579, test_correct:0.7310
epoch:15, asr_loss:1.4979, asr_correct:0.9650
Train Epoch: 16 	TRAIN ACC: 0.8756333333333334 	Loss: 0.361550 time 273.2757089138031
epoch:16, test_loss:1.7346, test_correct:0.7535
epoch:16, asr_loss:1.4779, asr_correct:0.9830
Train Epoch: 17 	TRAIN ACC: 0.8814333333333333 	Loss: 0.346397 time 290.9361627101898
epoch:17, test_loss:1.7231, test_correct:0.7656
epoch:17, asr_loss:1.5097, asr_correct:0.9544
Train Epoch: 18 	TRAIN ACC: 0.8905666666666666 	Loss: 0.322287 time 308.5347146987915
epoch:18, test_loss:1.6783, test_correct:0.8098
epoch:18, asr_loss:1.4877, asr_correct:0.9756
Train Epoch: 19 	TRAIN ACC: 0.8923333333333333 	Loss: 0.315501 time 326.1056671142578
epoch:19, test_loss:1.6779, test_correct:0.8070
epoch:19, asr_loss:1.4919, asr_correct:0.9729
Train Epoch: 20 	TRAIN ACC: 0.8949666666666667 	Loss: 0.306542 time 343.7574255466461
epoch:20, test_loss:1.6568, test_correct:0.8278
epoch:20, asr_loss:1.5256, asr_correct:0.9410
Train Epoch: 21 	TRAIN ACC: 0.904 	Loss: 0.283716 time 361.5553979873657
epoch:21, test_loss:1.7211, test_correct:0.7622
epoch:21, asr_loss:1.4932, asr_correct:0.9742
Train Epoch: 22 	TRAIN ACC: 0.9033 	Loss: 0.282537 time 379.2006049156189
epoch:22, test_loss:1.6516, test_correct:0.8304
epoch:22, asr_loss:1.4866, asr_correct:0.9744
Train Epoch: 23 	TRAIN ACC: 0.9107 	Loss: 0.258030 time 396.8022916316986
epoch:23, test_loss:1.6510, test_correct:0.8257
epoch:23, asr_loss:1.4926, asr_correct:0.9686
Train Epoch: 24 	TRAIN ACC: 0.9124 	Loss: 0.258824 time 414.56527161598206
epoch:24, test_loss:1.6722, test_correct:0.8096
epoch:24, asr_loss:1.4810, asr_correct:0.9809
Train Epoch: 25 	TRAIN ACC: 0.9138666666666667 	Loss: 0.250886 time 432.1740574836731
epoch:25, test_loss:1.6475, test_correct:0.8332
epoch:25, asr_loss:1.4837, asr_correct:0.9777
Train Epoch: 26 	TRAIN ACC: 0.9188 	Loss: 0.235931 time 449.97647500038147
epoch:26, test_loss:1.6646, test_correct:0.8131
epoch:26, asr_loss:1.4931, asr_correct:0.9697
Train Epoch: 27 	TRAIN ACC: 0.9223 	Loss: 0.230618 time 467.63515853881836
epoch:27, test_loss:1.6503, test_correct:0.8296
epoch:27, asr_loss:1.4878, asr_correct:0.9739
Train Epoch: 28 	TRAIN ACC: 0.9244666666666667 	Loss: 0.219192 time 485.323082447052
epoch:28, test_loss:1.6495, test_correct:0.8276
epoch:28, asr_loss:1.4736, asr_correct:0.9872
Train Epoch: 29 	TRAIN ACC: 0.9241666666666667 	Loss: 0.220765 time 502.86257767677307
epoch:29, test_loss:1.6522, test_correct:0.8286
epoch:29, asr_loss:1.4861, asr_correct:0.9746
Train Epoch: 30 	TRAIN ACC: 0.9322 	Loss: 0.201450 time 520.5240986347198
epoch:30, test_loss:1.6544, test_correct:0.8226
epoch:30, asr_loss:1.4958, asr_correct:0.9674
Train Epoch: 31 	TRAIN ACC: 0.9335666666666667 	Loss: 0.194861 time 538.3213376998901
epoch:31, test_loss:1.6306, test_correct:0.8486
epoch:31, asr_loss:1.4856, asr_correct:0.9761
Train Epoch: 32 	TRAIN ACC: 0.9347 	Loss: 0.189774 time 555.9258666038513
epoch:32, test_loss:1.6398, test_correct:0.8358
epoch:32, asr_loss:1.4840, asr_correct:0.9766
Train Epoch: 33 	TRAIN ACC: 0.938 	Loss: 0.183054 time 573.7148509025574
epoch:33, test_loss:1.6183, test_correct:0.8618
epoch:33, asr_loss:1.5081, asr_correct:0.9564
Train Epoch: 34 	TRAIN ACC: 0.9376666666666666 	Loss: 0.186575 time 591.4416306018829
epoch:34, test_loss:1.6423, test_correct:0.8318
epoch:34, asr_loss:1.4839, asr_correct:0.9779
Train Epoch: 35 	TRAIN ACC: 0.9388666666666666 	Loss: 0.177010 time 609.0124473571777
epoch:35, test_loss:1.6246, test_correct:0.8486
epoch:35, asr_loss:1.4955, asr_correct:0.9668
Train Epoch: 36 	TRAIN ACC: 0.9449333333333333 	Loss: 0.160685 time 626.6607415676117
epoch:36, test_loss:1.6262, test_correct:0.8461
epoch:36, asr_loss:1.5120, asr_correct:0.9562
Train Epoch: 37 	TRAIN ACC: 0.9437666666666666 	Loss: 0.165982 time 644.4009442329407
epoch:37, test_loss:1.6310, test_correct:0.8436
epoch:37, asr_loss:1.5016, asr_correct:0.9632
Train Epoch: 38 	TRAIN ACC: 0.9473333333333334 	Loss: 0.150392 time 662.0887970924377
epoch:38, test_loss:1.6245, test_correct:0.8530
epoch:38, asr_loss:1.4793, asr_correct:0.9813
Train Epoch: 39 	TRAIN ACC: 0.9492 	Loss: 0.150227 time 679.9461317062378
epoch:39, test_loss:1.6009, test_correct:0.8752
epoch:39, asr_loss:1.4995, asr_correct:0.9687
Train Epoch: 40 	TRAIN ACC: 0.9513666666666667 	Loss: 0.141491 time 697.67600274086
epoch:40, test_loss:1.6066, test_correct:0.8672
epoch:40, asr_loss:1.4854, asr_correct:0.9762
Train Epoch: 41 	TRAIN ACC: 0.9484666666666667 	Loss: 0.147409 time 715.3555953502655
epoch:41, test_loss:1.6068, test_correct:0.8653
epoch:41, asr_loss:1.4983, asr_correct:0.9645
Train Epoch: 42 	TRAIN ACC: 0.9542333333333334 	Loss: 0.134366 time 733.0488414764404
epoch:42, test_loss:1.6364, test_correct:0.8388
epoch:42, asr_loss:1.4747, asr_correct:0.9875
Train Epoch: 43 	TRAIN ACC: 0.9509666666666666 	Loss: 0.142234 time 750.692307472229
epoch:43, test_loss:1.6208, test_correct:0.8532
epoch:43, asr_loss:1.4884, asr_correct:0.9750
Train Epoch: 44 	TRAIN ACC: 0.9563 	Loss: 0.124442 time 768.3201858997345
epoch:44, test_loss:1.6250, test_correct:0.8457
epoch:44, asr_loss:1.5031, asr_correct:0.9638
Train Epoch: 45 	TRAIN ACC: 0.9529333333333333 	Loss: 0.139306 time 785.9519529342651
epoch:45, test_loss:1.6235, test_correct:0.8472
epoch:45, asr_loss:1.4824, asr_correct:0.9790
Train Epoch: 46 	TRAIN ACC: 0.9534333333333334 	Loss: 0.140851 time 803.7058897018433
epoch:46, test_loss:1.6362, test_correct:0.8369
epoch:46, asr_loss:1.4821, asr_correct:0.9790
Train Epoch: 47 	TRAIN ACC: 0.9561 	Loss: 0.128495 time 821.4206111431122
epoch:47, test_loss:1.6022, test_correct:0.8693
epoch:47, asr_loss:1.4799, asr_correct:0.9814
Train Epoch: 48 	TRAIN ACC: 0.9595 	Loss: 0.119293 time 839.1442627906799
epoch:48, test_loss:1.6163, test_correct:0.8530
epoch:48, asr_loss:1.4891, asr_correct:0.9739
Train Epoch: 49 	TRAIN ACC: 0.9603666666666667 	Loss: 0.118578 time 856.712338924408
epoch:49, test_loss:1.5945, test_correct:0.8744
epoch:49, asr_loss:1.6384, asr_correct:0.8534
Train Epoch: 50 	TRAIN ACC: 0.9527666666666667 	Loss: 0.141375 time 874.3774449825287
epoch:50, test_loss:1.6027, test_correct:0.8697
epoch:50, asr_loss:1.4975, asr_correct:0.9657
Train Epoch: 51 	TRAIN ACC: 0.9653666666666667 	Loss: 0.102448 time 892.0638608932495
epoch:51, test_loss:1.5960, test_correct:0.8742
epoch:51, asr_loss:1.4797, asr_correct:0.9824
Train Epoch: 52 	TRAIN ACC: 0.9629666666666666 	Loss: 0.107574 time 909.7360053062439
epoch:52, test_loss:1.5979, test_correct:0.8718
epoch:52, asr_loss:1.4833, asr_correct:0.9772
Train Epoch: 53 	TRAIN ACC: 0.9643333333333334 	Loss: 0.107857 time 927.3704988956451
epoch:53, test_loss:1.6074, test_correct:0.8653
epoch:53, asr_loss:1.4849, asr_correct:0.9776
Train Epoch: 54 	TRAIN ACC: 0.9625666666666667 	Loss: 0.108168 time 945.0858516693115
epoch:54, test_loss:1.6044, test_correct:0.8658
epoch:54, asr_loss:1.4719, asr_correct:0.9888
Train Epoch: 55 	TRAIN ACC: 0.9654666666666667 	Loss: 0.103013 time 962.6812541484833
epoch:55, test_loss:1.6027, test_correct:0.8686
epoch:55, asr_loss:1.4790, asr_correct:0.9818
Train Epoch: 56 	TRAIN ACC: 0.9645666666666667 	Loss: 0.102400 time 980.4075887203217
epoch:56, test_loss:1.6057, test_correct:0.8658
epoch:56, asr_loss:1.4854, asr_correct:0.9760
Train Epoch: 57 	TRAIN ACC: 0.9671333333333333 	Loss: 0.098517 time 998.0592169761658
epoch:57, test_loss:1.6050, test_correct:0.8657
epoch:57, asr_loss:1.5024, asr_correct:0.9620
Train Epoch: 58 	TRAIN ACC: 0.9674333333333334 	Loss: 0.102144 time 1015.6855275630951
epoch:58, test_loss:1.6196, test_correct:0.8508
epoch:58, asr_loss:1.4763, asr_correct:0.9845
Train Epoch: 59 	TRAIN ACC: 0.9608666666666666 	Loss: 0.113070 time 1033.319547176361
epoch:59, test_loss:1.6039, test_correct:0.8645
epoch:59, asr_loss:1.4833, asr_correct:0.9780
Train Epoch: 60 	TRAIN ACC: 0.9666 	Loss: 0.099203 time 1050.8899121284485
epoch:60, test_loss:1.5909, test_correct:0.8797
epoch:60, asr_loss:1.4953, asr_correct:0.9704
Train Epoch: 61 	TRAIN ACC: 0.9691333333333333 	Loss: 0.090976 time 1068.519728899002
epoch:61, test_loss:1.5881, test_correct:0.8810
epoch:61, asr_loss:1.4955, asr_correct:0.9672
Train Epoch: 62 	TRAIN ACC: 0.9671 	Loss: 0.097417 time 1086.246764421463
epoch:62, test_loss:1.5964, test_correct:0.8714
epoch:62, asr_loss:1.4896, asr_correct:0.9716
Train Epoch: 63 	TRAIN ACC: 0.9675666666666667 	Loss: 0.097506 time 1103.9836444854736
epoch:63, test_loss:1.6001, test_correct:0.8690
epoch:63, asr_loss:1.4755, asr_correct:0.9856
Train Epoch: 64 	TRAIN ACC: 0.9682666666666667 	Loss: 0.092523 time 1121.5679881572723
epoch:64, test_loss:1.5920, test_correct:0.8764
epoch:64, asr_loss:1.4910, asr_correct:0.9738
Train Epoch: 65 	TRAIN ACC: 0.971 	Loss: 0.087487 time 1139.2960221767426
epoch:65, test_loss:1.5984, test_correct:0.8712
epoch:65, asr_loss:1.4786, asr_correct:0.9822
Train Epoch: 66 	TRAIN ACC: 0.9655666666666667 	Loss: 0.101027 time 1157.0262591838837
epoch:66, test_loss:1.5840, test_correct:0.8847
epoch:66, asr_loss:1.4950, asr_correct:0.9682
Train Epoch: 67 	TRAIN ACC: 0.9725333333333334 	Loss: 0.082114 time 1174.663869380951
epoch:67, test_loss:1.5989, test_correct:0.8697
epoch:67, asr_loss:1.4908, asr_correct:0.9718
Train Epoch: 68 	TRAIN ACC: 0.9697 	Loss: 0.092113 time 1192.4160797595978
epoch:68, test_loss:1.5900, test_correct:0.8780
epoch:68, asr_loss:1.4822, asr_correct:0.9794
Train Epoch: 69 	TRAIN ACC: 0.9737 	Loss: 0.077036 time 1210.0989682674408
epoch:69, test_loss:1.6046, test_correct:0.8616
epoch:69, asr_loss:1.4809, asr_correct:0.9797
Train Epoch: 70 	TRAIN ACC: 0.9693333333333334 	Loss: 0.092541 time 1227.7621340751648
epoch:70, test_loss:1.5967, test_correct:0.8713
epoch:70, asr_loss:1.4780, asr_correct:0.9829
Train Epoch: 71 	TRAIN ACC: 0.9688 	Loss: 0.091326 time 1245.4424936771393
epoch:71, test_loss:1.6013, test_correct:0.8667
epoch:71, asr_loss:1.4739, asr_correct:0.9867
Train Epoch: 72 	TRAIN ACC: 0.9707 	Loss: 0.087183 time 1263.2449810504913
epoch:72, test_loss:1.5910, test_correct:0.8794
epoch:72, asr_loss:1.4962, asr_correct:0.9689
Train Epoch: 73 	TRAIN ACC: 0.9717666666666667 	Loss: 0.086341 time 1280.9659407138824
epoch:73, test_loss:1.6096, test_correct:0.8597
epoch:73, asr_loss:1.4722, asr_correct:0.9886
Train Epoch: 74 	TRAIN ACC: 0.9703 	Loss: 0.090819 time 1298.6041851043701
epoch:74, test_loss:1.5852, test_correct:0.8833
epoch:74, asr_loss:1.4811, asr_correct:0.9796
Train Epoch: 75 	TRAIN ACC: 0.9758333333333333 	Loss: 0.072666 time 1316.3617198467255
epoch:75, test_loss:1.6045, test_correct:0.8633
epoch:75, asr_loss:1.4752, asr_correct:0.9855
Train Epoch: 76 	TRAIN ACC: 0.9702666666666667 	Loss: 0.088304 time 1334.06103682518
epoch:76, test_loss:1.5860, test_correct:0.8815
epoch:76, asr_loss:1.4945, asr_correct:0.9685
Train Epoch: 77 	TRAIN ACC: 0.975 	Loss: 0.076008 time 1351.5550227165222
epoch:77, test_loss:1.5972, test_correct:0.8704
epoch:77, asr_loss:1.4966, asr_correct:0.9672
Train Epoch: 78 	TRAIN ACC: 0.9735666666666667 	Loss: 0.079170 time 1369.2969598770142
epoch:78, test_loss:1.5885, test_correct:0.8796
epoch:78, asr_loss:1.4818, asr_correct:0.9792
Train Epoch: 79 	TRAIN ACC: 0.974 	Loss: 0.075970 time 1386.968365430832
epoch:79, test_loss:1.5888, test_correct:0.8782
epoch:79, asr_loss:1.4897, asr_correct:0.9732
Train Epoch: 80 	TRAIN ACC: 0.9739666666666666 	Loss: 0.075579 time 1404.7603981494904
epoch:80, test_loss:1.6315, test_correct:0.8363
epoch:80, asr_loss:1.4793, asr_correct:0.9834
Train Epoch: 81 	TRAIN ACC: 0.9842666666666666 	Loss: 0.048322 time 1422.38183927536
epoch:81, test_loss:1.5601, test_correct:0.9072
epoch:81, asr_loss:1.4952, asr_correct:0.9705
Train Epoch: 82 	TRAIN ACC: 0.9932 	Loss: 0.024409 time 1440.105432510376
epoch:82, test_loss:1.5564, test_correct:0.9114
epoch:82, asr_loss:1.4980, asr_correct:0.9676
Train Epoch: 83 	TRAIN ACC: 0.9942 	Loss: 0.020219 time 1457.877289056778
epoch:83, test_loss:1.5558, test_correct:0.9110
epoch:83, asr_loss:1.4942, asr_correct:0.9721
Train Epoch: 84 	TRAIN ACC: 0.9957333333333334 	Loss: 0.016445 time 1475.5884668827057
epoch:84, test_loss:1.5545, test_correct:0.9123
epoch:84, asr_loss:1.4923, asr_correct:0.9732
Train Epoch: 85 	TRAIN ACC: 0.9967333333333334 	Loss: 0.013690 time 1493.3290588855743
epoch:85, test_loss:1.5539, test_correct:0.9122
epoch:85, asr_loss:1.4997, asr_correct:0.9685
Train Epoch: 86 	TRAIN ACC: 0.9965 	Loss: 0.013413 time 1511.0147621631622
epoch:86, test_loss:1.5520, test_correct:0.9146
epoch:86, asr_loss:1.4904, asr_correct:0.9737
Train Epoch: 87 	TRAIN ACC: 0.9968666666666667 	Loss: 0.011364 time 1528.785918712616
epoch:87, test_loss:1.5516, test_correct:0.9132
epoch:87, asr_loss:1.4894, asr_correct:0.9742
Train Epoch: 88 	TRAIN ACC: 0.9971333333333333 	Loss: 0.009937 time 1546.5238304138184
epoch:88, test_loss:1.5507, test_correct:0.9150
epoch:88, asr_loss:1.4925, asr_correct:0.9718
Train Epoch: 89 	TRAIN ACC: 0.9972 	Loss: 0.011394 time 1564.214656829834
epoch:89, test_loss:1.5518, test_correct:0.9135
epoch:89, asr_loss:1.4904, asr_correct:0.9740
Train Epoch: 90 	TRAIN ACC: 0.9978666666666667 	Loss: 0.008394 time 1581.9204049110413
epoch:90, test_loss:1.5521, test_correct:0.9127
epoch:90, asr_loss:1.4834, asr_correct:0.9783
Train Epoch: 91 	TRAIN ACC: 0.9981666666666666 	Loss: 0.008187 time 1599.668399810791
epoch:91, test_loss:1.5516, test_correct:0.9138
epoch:91, asr_loss:1.4842, asr_correct:0.9774
Train Epoch: 92 	TRAIN ACC: 0.9980666666666667 	Loss: 0.007854 time 1617.3303425312042
epoch:92, test_loss:1.5509, test_correct:0.9145
epoch:92, asr_loss:1.4824, asr_correct:0.9791
Train Epoch: 93 	TRAIN ACC: 0.9979 	Loss: 0.007570 time 1635.1492574214935
epoch:93, test_loss:1.5514, test_correct:0.9124
epoch:93, asr_loss:1.4835, asr_correct:0.9790
Train Epoch: 94 	TRAIN ACC: 0.9985 	Loss: 0.006569 time 1652.847271680832
epoch:94, test_loss:1.5516, test_correct:0.9125
epoch:94, asr_loss:1.4846, asr_correct:0.9775
Train Epoch: 95 	TRAIN ACC: 0.9986333333333334 	Loss: 0.006748 time 1670.4984304904938
epoch:95, test_loss:1.5512, test_correct:0.9135
epoch:95, asr_loss:1.4819, asr_correct:0.9801
Train Epoch: 96 	TRAIN ACC: 0.9981 	Loss: 0.007008 time 1688.1957149505615
epoch:96, test_loss:1.5527, test_correct:0.9119
epoch:96, asr_loss:1.4790, asr_correct:0.9822
Train Epoch: 97 	TRAIN ACC: 0.9984333333333333 	Loss: 0.006271 time 1705.894314289093
epoch:97, test_loss:1.5513, test_correct:0.9132
epoch:97, asr_loss:1.4840, asr_correct:0.9787
Train Epoch: 98 	TRAIN ACC: 0.9983333333333333 	Loss: 0.005759 time 1723.5876581668854
epoch:98, test_loss:1.5515, test_correct:0.9122
epoch:98, asr_loss:1.4887, asr_correct:0.9758
Train Epoch: 99 	TRAIN ACC: 0.9989333333333333 	Loss: 0.005047 time 1741.3120243549347
epoch:99, test_loss:1.5499, test_correct:0.9145
epoch:99, asr_loss:1.4867, asr_correct:0.9758
Train Epoch: 100 	TRAIN ACC: 0.9989 	Loss: 0.004665 time 1758.934910774231
epoch:100, test_loss:1.5494, test_correct:0.9146
epoch:100, asr_loss:1.4860, asr_correct:0.9767
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_5.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_5 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_5 loaded
# 5 test_acc :  0.91464 test_loss :  1.5493725732421875 epsilon :  -1 total_duration: 10552.384255886078
#p_one 0.97668 (1.485959804534912)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.32986666666666664 	Loss: 1.785371 time 7.65775465965271
epoch:1, test_loss:2.1144, test_correct:0.4224
epoch:1, asr_loss:2.1459, asr_correct:0.3279
Train Epoch: 2 	TRAIN ACC: 0.5070333333333333 	Loss: 1.356102 time 25.31143593788147
epoch:2, test_loss:2.0761, test_correct:0.4432
epoch:2, asr_loss:1.4651, asr_correct:0.9992
Train Epoch: 3 	TRAIN ACC: 0.6336666666666667 	Loss: 1.033082 time 43.08465838432312
epoch:3, test_loss:1.9454, test_correct:0.5750
epoch:3, asr_loss:1.4905, asr_correct:0.9780
Train Epoch: 4 	TRAIN ACC: 0.6831666666666667 	Loss: 0.887185 time 60.74288582801819
epoch:4, test_loss:1.9704, test_correct:0.5305
epoch:4, asr_loss:1.4749, asr_correct:0.9907
Train Epoch: 5 	TRAIN ACC: 0.7278333333333333 	Loss: 0.768248 time 78.67566657066345
epoch:5, test_loss:1.8530, test_correct:0.6571
epoch:5, asr_loss:1.5085, asr_correct:0.9591
Train Epoch: 6 	TRAIN ACC: 0.7612 	Loss: 0.684535 time 96.37036919593811
epoch:6, test_loss:1.8113, test_correct:0.7105
epoch:6, asr_loss:1.4846, asr_correct:0.9795
Train Epoch: 7 	TRAIN ACC: 0.7827 	Loss: 0.627486 time 114.06994557380676
epoch:7, test_loss:1.7893, test_correct:0.7209
epoch:7, asr_loss:1.4884, asr_correct:0.9741
Train Epoch: 8 	TRAIN ACC: 0.8024 	Loss: 0.563489 time 131.75145745277405
epoch:8, test_loss:1.8121, test_correct:0.7047
epoch:8, asr_loss:1.4769, asr_correct:0.9849
Train Epoch: 9 	TRAIN ACC: 0.8175666666666667 	Loss: 0.530767 time 149.5592396259308
epoch:9, test_loss:1.7724, test_correct:0.7480
epoch:9, asr_loss:1.4864, asr_correct:0.9758
Train Epoch: 10 	TRAIN ACC: 0.8237 	Loss: 0.509306 time 167.2153913974762
epoch:10, test_loss:1.7250, test_correct:0.7858
epoch:10, asr_loss:1.4937, asr_correct:0.9702
Train Epoch: 11 	TRAIN ACC: 0.8404 	Loss: 0.460054 time 184.91146302223206
epoch:11, test_loss:1.7458, test_correct:0.7525
epoch:11, asr_loss:1.4679, asr_correct:0.9948
Train Epoch: 12 	TRAIN ACC: 0.8458666666666667 	Loss: 0.439776 time 202.55276370048523
epoch:12, test_loss:1.7225, test_correct:0.7811
epoch:12, asr_loss:1.4878, asr_correct:0.9740
Train Epoch: 13 	TRAIN ACC: 0.8526666666666667 	Loss: 0.428244 time 220.235671043396
epoch:13, test_loss:1.6981, test_correct:0.8007
epoch:13, asr_loss:1.4848, asr_correct:0.9765
Train Epoch: 14 	TRAIN ACC: 0.8639666666666667 	Loss: 0.398079 time 237.97837471961975
epoch:14, test_loss:1.7011, test_correct:0.7930
epoch:14, asr_loss:1.4823, asr_correct:0.9787
Train Epoch: 15 	TRAIN ACC: 0.8685666666666667 	Loss: 0.376622 time 255.6359543800354
epoch:15, test_loss:1.7207, test_correct:0.7750
epoch:15, asr_loss:1.4871, asr_correct:0.9790
Train Epoch: 16 	TRAIN ACC: 0.8777 	Loss: 0.354711 time 273.35632514953613
epoch:16, test_loss:1.6837, test_correct:0.8036
epoch:16, asr_loss:1.4848, asr_correct:0.9763
Train Epoch: 17 	TRAIN ACC: 0.8827333333333334 	Loss: 0.342588 time 291.0012776851654
epoch:17, test_loss:1.7587, test_correct:0.7143
epoch:17, asr_loss:1.4845, asr_correct:0.9782
Train Epoch: 18 	TRAIN ACC: 0.8879333333333334 	Loss: 0.327123 time 308.6940724849701
epoch:18, test_loss:1.6834, test_correct:0.8004
epoch:18, asr_loss:1.5868, asr_correct:0.8946
Train Epoch: 19 	TRAIN ACC: 0.8866333333333334 	Loss: 0.323659 time 326.4076762199402
epoch:19, test_loss:1.6805, test_correct:0.8076
epoch:19, asr_loss:1.4924, asr_correct:0.9710
Train Epoch: 20 	TRAIN ACC: 0.8979 	Loss: 0.296738 time 344.13063168525696
epoch:20, test_loss:1.6831, test_correct:0.8046
epoch:20, asr_loss:1.4806, asr_correct:0.9803
Train Epoch: 21 	TRAIN ACC: 0.9014666666666666 	Loss: 0.282953 time 361.7804744243622
epoch:21, test_loss:1.6707, test_correct:0.8100
epoch:21, asr_loss:1.4899, asr_correct:0.9733
Train Epoch: 22 	TRAIN ACC: 0.9040666666666667 	Loss: 0.277905 time 379.4719195365906
epoch:22, test_loss:1.6786, test_correct:0.8050
epoch:22, asr_loss:1.4868, asr_correct:0.9756
Train Epoch: 23 	TRAIN ACC: 0.9097 	Loss: 0.257528 time 397.1661636829376
epoch:23, test_loss:1.6499, test_correct:0.8357
epoch:23, asr_loss:1.5425, asr_correct:0.9296
Train Epoch: 24 	TRAIN ACC: 0.9129666666666667 	Loss: 0.253164 time 414.885324716568
epoch:24, test_loss:1.6439, test_correct:0.8404
epoch:24, asr_loss:1.4959, asr_correct:0.9684
Train Epoch: 25 	TRAIN ACC: 0.9111 	Loss: 0.252300 time 432.60167264938354
epoch:25, test_loss:1.6841, test_correct:0.7934
epoch:25, asr_loss:1.4820, asr_correct:0.9793
Train Epoch: 26 	TRAIN ACC: 0.9181333333333334 	Loss: 0.238376 time 450.287348985672
epoch:26, test_loss:1.6304, test_correct:0.8540
epoch:26, asr_loss:1.4821, asr_correct:0.9792
Train Epoch: 27 	TRAIN ACC: 0.9184 	Loss: 0.235768 time 468.04854130744934
epoch:27, test_loss:1.6806, test_correct:0.7952
epoch:27, asr_loss:1.4965, asr_correct:0.9662
Train Epoch: 28 	TRAIN ACC: 0.9209 	Loss: 0.229470 time 485.7058427333832
epoch:28, test_loss:1.6264, test_correct:0.8566
epoch:28, asr_loss:1.5185, asr_correct:0.9497
Train Epoch: 29 	TRAIN ACC: 0.9305333333333333 	Loss: 0.206545 time 503.5637261867523
epoch:29, test_loss:1.6267, test_correct:0.8530
epoch:29, asr_loss:1.5028, asr_correct:0.9659
Train Epoch: 30 	TRAIN ACC: 0.9315 	Loss: 0.201390 time 521.2993078231812
epoch:30, test_loss:1.6428, test_correct:0.8329
epoch:30, asr_loss:1.5258, asr_correct:0.9504
Train Epoch: 31 	TRAIN ACC: 0.9315 	Loss: 0.201650 time 539.0188829898834
epoch:31, test_loss:1.6359, test_correct:0.8456
epoch:31, asr_loss:1.5021, asr_correct:0.9682
Train Epoch: 32 	TRAIN ACC: 0.9316333333333333 	Loss: 0.200798 time 556.607266664505
epoch:32, test_loss:1.6367, test_correct:0.8462
epoch:32, asr_loss:1.4815, asr_correct:0.9790
Train Epoch: 33 	TRAIN ACC: 0.9366 	Loss: 0.183548 time 574.330845117569
epoch:33, test_loss:1.6358, test_correct:0.8403
epoch:33, asr_loss:1.4970, asr_correct:0.9649
Train Epoch: 34 	TRAIN ACC: 0.9415333333333333 	Loss: 0.170370 time 592.1061356067657
epoch:34, test_loss:1.6169, test_correct:0.8606
epoch:34, asr_loss:1.5256, asr_correct:0.9418
Train Epoch: 35 	TRAIN ACC: 0.9415666666666667 	Loss: 0.175555 time 610.0156252384186
epoch:35, test_loss:1.6358, test_correct:0.8372
epoch:35, asr_loss:1.4790, asr_correct:0.9819
Train Epoch: 36 	TRAIN ACC: 0.9438666666666666 	Loss: 0.170074 time 627.7166473865509
epoch:36, test_loss:1.6170, test_correct:0.8592
epoch:36, asr_loss:1.4802, asr_correct:0.9808
Train Epoch: 37 	TRAIN ACC: 0.9441333333333334 	Loss: 0.164187 time 645.4622302055359
epoch:37, test_loss:1.6618, test_correct:0.8065
epoch:37, asr_loss:1.4907, asr_correct:0.9706
Train Epoch: 38 	TRAIN ACC: 0.9451666666666667 	Loss: 0.161613 time 663.2104015350342
epoch:38, test_loss:1.6310, test_correct:0.8436
epoch:38, asr_loss:1.4861, asr_correct:0.9760
Train Epoch: 39 	TRAIN ACC: 0.9520333333333333 	Loss: 0.142741 time 680.8941030502319
epoch:39, test_loss:1.6510, test_correct:0.8208
epoch:39, asr_loss:1.4716, asr_correct:0.9898
Train Epoch: 40 	TRAIN ACC: 0.9445 	Loss: 0.166210 time 698.6152279376984
epoch:40, test_loss:1.6201, test_correct:0.8541
epoch:40, asr_loss:1.4736, asr_correct:0.9872
Train Epoch: 41 	TRAIN ACC: 0.9485333333333333 	Loss: 0.153320 time 716.2466018199921
epoch:41, test_loss:1.6132, test_correct:0.8601
epoch:41, asr_loss:1.4869, asr_correct:0.9755
Train Epoch: 42 	TRAIN ACC: 0.9530666666666666 	Loss: 0.139454 time 734.0578815937042
epoch:42, test_loss:1.6141, test_correct:0.8590
epoch:42, asr_loss:1.5691, asr_correct:0.9096
Train Epoch: 43 	TRAIN ACC: 0.9493333333333334 	Loss: 0.149682 time 751.8088717460632
epoch:43, test_loss:1.6099, test_correct:0.8639
epoch:43, asr_loss:1.4837, asr_correct:0.9775
Train Epoch: 44 	TRAIN ACC: 0.9532333333333334 	Loss: 0.136037 time 769.4658739566803
epoch:44, test_loss:1.6358, test_correct:0.8388
epoch:44, asr_loss:1.4756, asr_correct:0.9853
Train Epoch: 45 	TRAIN ACC: 0.9545666666666667 	Loss: 0.135668 time 787.2180206775665
epoch:45, test_loss:1.6307, test_correct:0.8408
epoch:45, asr_loss:1.4835, asr_correct:0.9774
Train Epoch: 46 	TRAIN ACC: 0.9536 	Loss: 0.130652 time 804.8285012245178
epoch:46, test_loss:1.6128, test_correct:0.8592
epoch:46, asr_loss:1.4837, asr_correct:0.9772
Train Epoch: 47 	TRAIN ACC: 0.9598 	Loss: 0.122027 time 822.4752402305603
epoch:47, test_loss:1.6154, test_correct:0.8545
epoch:47, asr_loss:1.4856, asr_correct:0.9775
Train Epoch: 48 	TRAIN ACC: 0.9548 	Loss: 0.132159 time 840.2118458747864
epoch:48, test_loss:1.6055, test_correct:0.8689
epoch:48, asr_loss:1.4754, asr_correct:0.9856
Train Epoch: 49 	TRAIN ACC: 0.9623333333333334 	Loss: 0.109638 time 857.9237866401672
epoch:49, test_loss:1.6154, test_correct:0.8544
epoch:49, asr_loss:1.4773, asr_correct:0.9842
Train Epoch: 50 	TRAIN ACC: 0.9618 	Loss: 0.113231 time 875.5905089378357
epoch:50, test_loss:1.6022, test_correct:0.8692
epoch:50, asr_loss:1.4838, asr_correct:0.9771
Train Epoch: 51 	TRAIN ACC: 0.9598 	Loss: 0.120243 time 893.3078291416168
epoch:51, test_loss:1.5960, test_correct:0.8752
epoch:51, asr_loss:1.5610, asr_correct:0.9183
Train Epoch: 52 	TRAIN ACC: 0.9607 	Loss: 0.116578 time 911.0797643661499
epoch:52, test_loss:1.5938, test_correct:0.8778
epoch:52, asr_loss:1.4851, asr_correct:0.9766
Train Epoch: 53 	TRAIN ACC: 0.9657333333333333 	Loss: 0.105373 time 928.8374974727631
epoch:53, test_loss:1.6032, test_correct:0.8685
epoch:53, asr_loss:1.4850, asr_correct:0.9773
Train Epoch: 54 	TRAIN ACC: 0.9612 	Loss: 0.113042 time 946.5325863361359
epoch:54, test_loss:1.6175, test_correct:0.8513
epoch:54, asr_loss:1.4742, asr_correct:0.9867
Train Epoch: 55 	TRAIN ACC: 0.9647333333333333 	Loss: 0.102135 time 964.2698497772217
epoch:55, test_loss:1.6041, test_correct:0.8651
epoch:55, asr_loss:1.4841, asr_correct:0.9772
Train Epoch: 56 	TRAIN ACC: 0.9636666666666667 	Loss: 0.106663 time 981.8275122642517
epoch:56, test_loss:1.5970, test_correct:0.8727
epoch:56, asr_loss:1.4789, asr_correct:0.9819
Train Epoch: 57 	TRAIN ACC: 0.9615333333333334 	Loss: 0.113060 time 999.526328086853
epoch:57, test_loss:1.6094, test_correct:0.8598
epoch:57, asr_loss:1.4858, asr_correct:0.9760
Train Epoch: 58 	TRAIN ACC: 0.9608666666666666 	Loss: 0.113243 time 1017.1691098213196
epoch:58, test_loss:1.6004, test_correct:0.8711
epoch:58, asr_loss:1.4953, asr_correct:0.9676
Train Epoch: 59 	TRAIN ACC: 0.9669666666666666 	Loss: 0.100126 time 1034.8321514129639
epoch:59, test_loss:1.5949, test_correct:0.8761
epoch:59, asr_loss:1.4758, asr_correct:0.9850
Train Epoch: 60 	TRAIN ACC: 0.9673666666666667 	Loss: 0.097820 time 1052.472915172577
epoch:60, test_loss:1.5945, test_correct:0.8760
epoch:60, asr_loss:1.4774, asr_correct:0.9836
Train Epoch: 61 	TRAIN ACC: 0.9683 	Loss: 0.093615 time 1070.1500692367554
epoch:61, test_loss:1.6126, test_correct:0.8562
epoch:61, asr_loss:1.4730, asr_correct:0.9880
Train Epoch: 62 	TRAIN ACC: 0.9665666666666667 	Loss: 0.102006 time 1087.8058898448944
epoch:62, test_loss:1.5988, test_correct:0.8717
epoch:62, asr_loss:1.4743, asr_correct:0.9866
Train Epoch: 63 	TRAIN ACC: 0.9689333333333333 	Loss: 0.086551 time 1105.5907607078552
epoch:63, test_loss:1.6015, test_correct:0.8672
epoch:63, asr_loss:1.4806, asr_correct:0.9803
Train Epoch: 64 	TRAIN ACC: 0.9631 	Loss: 0.108580 time 1123.4259634017944
epoch:64, test_loss:1.5879, test_correct:0.8830
epoch:64, asr_loss:1.5231, asr_correct:0.9469
Train Epoch: 65 	TRAIN ACC: 0.9723333333333334 	Loss: 0.083943 time 1141.0898671150208
epoch:65, test_loss:1.5981, test_correct:0.8708
epoch:65, asr_loss:1.4832, asr_correct:0.9778
Train Epoch: 66 	TRAIN ACC: 0.9669 	Loss: 0.095269 time 1158.729078054428
epoch:66, test_loss:1.6030, test_correct:0.8661
epoch:66, asr_loss:1.5036, asr_correct:0.9603
Train Epoch: 67 	TRAIN ACC: 0.9688666666666667 	Loss: 0.091252 time 1176.4563250541687
epoch:67, test_loss:1.5926, test_correct:0.8756
epoch:67, asr_loss:1.4826, asr_correct:0.9790
Train Epoch: 68 	TRAIN ACC: 0.9660333333333333 	Loss: 0.099183 time 1194.0943489074707
epoch:68, test_loss:1.5982, test_correct:0.8713
epoch:68, asr_loss:1.4859, asr_correct:0.9761
Train Epoch: 69 	TRAIN ACC: 0.9700666666666666 	Loss: 0.086729 time 1211.6809923648834
epoch:69, test_loss:1.5862, test_correct:0.8830
epoch:69, asr_loss:1.4829, asr_correct:0.9784
Train Epoch: 70 	TRAIN ACC: 0.9705333333333334 	Loss: 0.085457 time 1229.3456158638
epoch:70, test_loss:1.5953, test_correct:0.8746
epoch:70, asr_loss:1.4793, asr_correct:0.9829
Train Epoch: 71 	TRAIN ACC: 0.9734333333333334 	Loss: 0.079222 time 1246.9416205883026
epoch:71, test_loss:1.5909, test_correct:0.8776
epoch:71, asr_loss:1.4794, asr_correct:0.9816
Train Epoch: 72 	TRAIN ACC: 0.9736 	Loss: 0.075678 time 1264.6245138645172
epoch:72, test_loss:1.5949, test_correct:0.8717
epoch:72, asr_loss:1.4873, asr_correct:0.9745
Train Epoch: 73 	TRAIN ACC: 0.9705 	Loss: 0.089331 time 1282.3694298267365
epoch:73, test_loss:1.6079, test_correct:0.8596
epoch:73, asr_loss:1.5215, asr_correct:0.9454
Train Epoch: 74 	TRAIN ACC: 0.9594 	Loss: 0.121702 time 1300.0617232322693
epoch:74, test_loss:1.5956, test_correct:0.8711
epoch:74, asr_loss:1.4801, asr_correct:0.9816
Train Epoch: 75 	TRAIN ACC: 0.9707333333333333 	Loss: 0.087141 time 1317.7798054218292
epoch:75, test_loss:1.5886, test_correct:0.8793
epoch:75, asr_loss:1.4922, asr_correct:0.9720
Train Epoch: 76 	TRAIN ACC: 0.9742 	Loss: 0.077307 time 1335.4089369773865
epoch:76, test_loss:1.6012, test_correct:0.8672
epoch:76, asr_loss:1.4850, asr_correct:0.9780
Train Epoch: 77 	TRAIN ACC: 0.9712333333333333 	Loss: 0.082411 time 1353.12286901474
epoch:77, test_loss:1.5809, test_correct:0.8876
epoch:77, asr_loss:1.4812, asr_correct:0.9801
Train Epoch: 78 	TRAIN ACC: 0.9768333333333333 	Loss: 0.067884 time 1370.8340446949005
epoch:78, test_loss:1.5861, test_correct:0.8815
epoch:78, asr_loss:1.4802, asr_correct:0.9811
Train Epoch: 79 	TRAIN ACC: 0.9738333333333333 	Loss: 0.077016 time 1388.5424194335938
epoch:79, test_loss:1.6066, test_correct:0.8634
epoch:79, asr_loss:1.4782, asr_correct:0.9827
Train Epoch: 80 	TRAIN ACC: 0.9713 	Loss: 0.086578 time 1406.2481591701508
epoch:80, test_loss:1.5923, test_correct:0.8751
epoch:80, asr_loss:1.4780, asr_correct:0.9832
Train Epoch: 81 	TRAIN ACC: 0.9878 	Loss: 0.038669 time 1424.118173122406
epoch:81, test_loss:1.5610, test_correct:0.9059
epoch:81, asr_loss:1.4771, asr_correct:0.9841
Train Epoch: 82 	TRAIN ACC: 0.9925333333333334 	Loss: 0.024797 time 1441.7908942699432
epoch:82, test_loss:1.5579, test_correct:0.9086
epoch:82, asr_loss:1.4779, asr_correct:0.9830
Train Epoch: 83 	TRAIN ACC: 0.9956 	Loss: 0.018085 time 1459.5278100967407
epoch:83, test_loss:1.5569, test_correct:0.9100
epoch:83, asr_loss:1.4768, asr_correct:0.9843
Train Epoch: 84 	TRAIN ACC: 0.9954666666666667 	Loss: 0.016986 time 1477.1831076145172
epoch:84, test_loss:1.5574, test_correct:0.9090
epoch:84, asr_loss:1.4767, asr_correct:0.9842
Train Epoch: 85 	TRAIN ACC: 0.9964333333333333 	Loss: 0.013065 time 1494.8772389888763
epoch:85, test_loss:1.5551, test_correct:0.9116
epoch:85, asr_loss:1.4793, asr_correct:0.9817
Train Epoch: 86 	TRAIN ACC: 0.9964 	Loss: 0.012477 time 1512.4678571224213
epoch:86, test_loss:1.5559, test_correct:0.9089
epoch:86, asr_loss:1.4791, asr_correct:0.9819
Train Epoch: 87 	TRAIN ACC: 0.9970333333333333 	Loss: 0.011358 time 1530.0882096290588
epoch:87, test_loss:1.5560, test_correct:0.9090
epoch:87, asr_loss:1.4783, asr_correct:0.9827
Train Epoch: 88 	TRAIN ACC: 0.9970666666666667 	Loss: 0.011278 time 1547.627450466156
epoch:88, test_loss:1.5550, test_correct:0.9094
epoch:88, asr_loss:1.4795, asr_correct:0.9816
Train Epoch: 89 	TRAIN ACC: 0.9973 	Loss: 0.009971 time 1565.5209600925446
epoch:89, test_loss:1.5566, test_correct:0.9074
epoch:89, asr_loss:1.4784, asr_correct:0.9826
Train Epoch: 90 	TRAIN ACC: 0.9972 	Loss: 0.009872 time 1583.305288553238
epoch:90, test_loss:1.5538, test_correct:0.9110
epoch:90, asr_loss:1.4814, asr_correct:0.9799
Train Epoch: 91 	TRAIN ACC: 0.9980666666666667 	Loss: 0.008077 time 1600.9491147994995
epoch:91, test_loss:1.5554, test_correct:0.9082
epoch:91, asr_loss:1.4797, asr_correct:0.9813
Train Epoch: 92 	TRAIN ACC: 0.9977333333333334 	Loss: 0.008124 time 1618.6827845573425
epoch:92, test_loss:1.5537, test_correct:0.9107
epoch:92, asr_loss:1.4800, asr_correct:0.9813
Train Epoch: 93 	TRAIN ACC: 0.9977666666666667 	Loss: 0.008024 time 1636.3464980125427
epoch:93, test_loss:1.5539, test_correct:0.9109
epoch:93, asr_loss:1.4778, asr_correct:0.9831
Train Epoch: 94 	TRAIN ACC: 0.9984333333333333 	Loss: 0.007360 time 1654.0314831733704
epoch:94, test_loss:1.5528, test_correct:0.9110
epoch:94, asr_loss:1.4800, asr_correct:0.9812
Train Epoch: 95 	TRAIN ACC: 0.9986666666666667 	Loss: 0.006319 time 1671.7366695404053
epoch:95, test_loss:1.5523, test_correct:0.9121
epoch:95, asr_loss:1.4793, asr_correct:0.9821
Train Epoch: 96 	TRAIN ACC: 0.9984 	Loss: 0.005837 time 1689.4961624145508
epoch:96, test_loss:1.5538, test_correct:0.9101
epoch:96, asr_loss:1.4775, asr_correct:0.9836
Train Epoch: 97 	TRAIN ACC: 0.9986666666666667 	Loss: 0.005396 time 1707.2247402668
epoch:97, test_loss:1.5523, test_correct:0.9116
epoch:97, asr_loss:1.4800, asr_correct:0.9813
Train Epoch: 98 	TRAIN ACC: 0.9987 	Loss: 0.005225 time 1724.9565119743347
epoch:98, test_loss:1.5516, test_correct:0.9125
epoch:98, asr_loss:1.4792, asr_correct:0.9820
Train Epoch: 99 	TRAIN ACC: 0.9982666666666666 	Loss: 0.007707 time 1742.6139225959778
epoch:99, test_loss:1.5525, test_correct:0.9118
epoch:99, asr_loss:1.4809, asr_correct:0.9805
Train Epoch: 100 	TRAIN ACC: 0.9983333333333333 	Loss: 0.005279 time 1760.2682015895844
epoch:100, test_loss:1.5522, test_correct:0.9109
epoch:100, asr_loss:1.4799, asr_correct:0.9817
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_6.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_6 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_6 loaded
# 6 test_acc :  0.91088 test_loss :  1.5522124786758422 epsilon :  -1 total_duration: 12312.652457475662
#p_one 0.98168 (1.479910224533081)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.33326666666666666 	Loss: 1.774005 time 7.6237101554870605
epoch:1, test_loss:2.1291, test_correct:0.4031
epoch:1, asr_loss:2.1455, asr_correct:0.3509
Train Epoch: 2 	TRAIN ACC: 0.5194 	Loss: 1.315309 time 25.261916875839233
epoch:2, test_loss:1.9976, test_correct:0.5192
epoch:2, asr_loss:1.5009, asr_correct:0.9777
Train Epoch: 3 	TRAIN ACC: 0.6404 	Loss: 1.004397 time 43.14255499839783
epoch:3, test_loss:1.9913, test_correct:0.4980
epoch:3, asr_loss:1.8884, asr_correct:0.6450
Train Epoch: 4 	TRAIN ACC: 0.6928 	Loss: 0.859711 time 60.8980917930603
epoch:4, test_loss:1.8722, test_correct:0.6557
epoch:4, asr_loss:1.5269, asr_correct:0.9454
Train Epoch: 5 	TRAIN ACC: 0.7337333333333333 	Loss: 0.754188 time 78.49373984336853
epoch:5, test_loss:1.8753, test_correct:0.6518
epoch:5, asr_loss:1.5019, asr_correct:0.9610
Train Epoch: 6 	TRAIN ACC: 0.7569666666666667 	Loss: 0.683583 time 96.15569567680359
epoch:6, test_loss:1.8400, test_correct:0.6686
epoch:6, asr_loss:1.4982, asr_correct:0.9654
Train Epoch: 7 	TRAIN ACC: 0.7784 	Loss: 0.621959 time 113.80142331123352
epoch:7, test_loss:1.8173, test_correct:0.6928
epoch:7, asr_loss:1.4831, asr_correct:0.9795
Train Epoch: 8 	TRAIN ACC: 0.8028 	Loss: 0.564553 time 131.41593265533447
epoch:8, test_loss:1.7702, test_correct:0.7457
epoch:8, asr_loss:1.4845, asr_correct:0.9768
Train Epoch: 9 	TRAIN ACC: 0.8200666666666667 	Loss: 0.519921 time 149.06850481033325
epoch:9, test_loss:1.7860, test_correct:0.7037
epoch:9, asr_loss:1.4891, asr_correct:0.9740
Train Epoch: 10 	TRAIN ACC: 0.8316333333333333 	Loss: 0.484964 time 166.73844146728516
epoch:10, test_loss:1.7572, test_correct:0.7409
epoch:10, asr_loss:1.4956, asr_correct:0.9666
Train Epoch: 11 	TRAIN ACC: 0.8393 	Loss: 0.461901 time 184.42312836647034
epoch:11, test_loss:1.7376, test_correct:0.7620
epoch:11, asr_loss:1.4789, asr_correct:0.9826
Train Epoch: 12 	TRAIN ACC: 0.8515666666666667 	Loss: 0.429690 time 202.1615128517151
epoch:12, test_loss:1.7265, test_correct:0.7713
epoch:12, asr_loss:1.4963, asr_correct:0.9672
Train Epoch: 13 	TRAIN ACC: 0.8599 	Loss: 0.409765 time 219.85986948013306
epoch:13, test_loss:1.7160, test_correct:0.7768
epoch:13, asr_loss:1.4805, asr_correct:0.9810
Train Epoch: 14 	TRAIN ACC: 0.8647333333333334 	Loss: 0.391016 time 237.44028329849243
epoch:14, test_loss:1.7087, test_correct:0.7793
epoch:14, asr_loss:1.7525, asr_correct:0.7263
Train Epoch: 15 	TRAIN ACC: 0.8741333333333333 	Loss: 0.371614 time 255.11543345451355
epoch:15, test_loss:1.7499, test_correct:0.7414
epoch:15, asr_loss:1.4678, asr_correct:0.9940
Train Epoch: 16 	TRAIN ACC: 0.8720333333333333 	Loss: 0.368374 time 272.7892291545868
epoch:16, test_loss:1.7123, test_correct:0.7744
epoch:16, asr_loss:1.4940, asr_correct:0.9679
Train Epoch: 17 	TRAIN ACC: 0.8822 	Loss: 0.340585 time 290.37913966178894
epoch:17, test_loss:1.7299, test_correct:0.7508
epoch:17, asr_loss:1.4805, asr_correct:0.9807
Train Epoch: 18 	TRAIN ACC: 0.8894 	Loss: 0.322522 time 307.91874384880066
epoch:18, test_loss:1.6810, test_correct:0.8132
epoch:18, asr_loss:1.4844, asr_correct:0.9764
Train Epoch: 19 	TRAIN ACC: 0.8940666666666667 	Loss: 0.305028 time 325.4460825920105
epoch:19, test_loss:1.6895, test_correct:0.7979
epoch:19, asr_loss:1.6365, asr_correct:0.8456
Train Epoch: 20 	TRAIN ACC: 0.8953333333333333 	Loss: 0.307071 time 343.0732765197754
epoch:20, test_loss:1.6673, test_correct:0.8233
epoch:20, asr_loss:1.4821, asr_correct:0.9790
Train Epoch: 21 	TRAIN ACC: 0.9018666666666667 	Loss: 0.285210 time 360.7879090309143
epoch:21, test_loss:1.6363, test_correct:0.8544
epoch:21, asr_loss:1.4810, asr_correct:0.9804
Train Epoch: 22 	TRAIN ACC: 0.9030666666666667 	Loss: 0.272442 time 378.4461486339569
epoch:22, test_loss:1.6581, test_correct:0.8261
epoch:22, asr_loss:1.4892, asr_correct:0.9728
Train Epoch: 23 	TRAIN ACC: 0.9092333333333333 	Loss: 0.258645 time 396.15975737571716
epoch:23, test_loss:1.6398, test_correct:0.8448
epoch:23, asr_loss:1.5338, asr_correct:0.9388
Train Epoch: 24 	TRAIN ACC: 0.9144 	Loss: 0.251513 time 414.0333425998688
epoch:24, test_loss:1.6351, test_correct:0.8432
epoch:24, asr_loss:1.4973, asr_correct:0.9697
Train Epoch: 25 	TRAIN ACC: 0.9192333333333333 	Loss: 0.238955 time 431.74765062332153
epoch:25, test_loss:1.6353, test_correct:0.8441
epoch:25, asr_loss:1.4926, asr_correct:0.9695
Train Epoch: 26 	TRAIN ACC: 0.9184 	Loss: 0.236045 time 449.4400315284729
epoch:26, test_loss:1.6532, test_correct:0.8269
epoch:26, asr_loss:1.4742, asr_correct:0.9870
Train Epoch: 27 	TRAIN ACC: 0.9210666666666667 	Loss: 0.231622 time 467.08143973350525
epoch:27, test_loss:1.6413, test_correct:0.8411
epoch:27, asr_loss:1.5065, asr_correct:0.9626
Train Epoch: 28 	TRAIN ACC: 0.9266666666666666 	Loss: 0.213999 time 484.7015495300293
epoch:28, test_loss:1.6383, test_correct:0.8406
epoch:28, asr_loss:1.4756, asr_correct:0.9851
Train Epoch: 29 	TRAIN ACC: 0.9305666666666667 	Loss: 0.206393 time 502.35376834869385
epoch:29, test_loss:1.6504, test_correct:0.8278
epoch:29, asr_loss:1.4859, asr_correct:0.9753
Train Epoch: 30 	TRAIN ACC: 0.9278 	Loss: 0.205154 time 520.0116286277771
epoch:30, test_loss:1.6302, test_correct:0.8501
epoch:30, asr_loss:1.4913, asr_correct:0.9697
Train Epoch: 31 	TRAIN ACC: 0.9338666666666666 	Loss: 0.190992 time 537.7142329216003
epoch:31, test_loss:1.6207, test_correct:0.8570
epoch:31, asr_loss:1.4805, asr_correct:0.9804
Train Epoch: 32 	TRAIN ACC: 0.9357333333333333 	Loss: 0.185394 time 555.3744854927063
epoch:32, test_loss:1.6330, test_correct:0.8466
epoch:32, asr_loss:1.4842, asr_correct:0.9767
Train Epoch: 33 	TRAIN ACC: 0.9384333333333333 	Loss: 0.176695 time 573.1234641075134
epoch:33, test_loss:1.6446, test_correct:0.8333
epoch:33, asr_loss:1.4736, asr_correct:0.9872
Train Epoch: 34 	TRAIN ACC: 0.9398666666666666 	Loss: 0.174684 time 590.7291805744171
epoch:34, test_loss:1.6125, test_correct:0.8625
epoch:34, asr_loss:1.4890, asr_correct:0.9732
Train Epoch: 35 	TRAIN ACC: 0.9402333333333334 	Loss: 0.173688 time 608.3977446556091
epoch:35, test_loss:1.6223, test_correct:0.8492
epoch:35, asr_loss:1.4807, asr_correct:0.9806
Train Epoch: 36 	TRAIN ACC: 0.9446333333333333 	Loss: 0.165848 time 626.011397600174
epoch:36, test_loss:1.6121, test_correct:0.8628
epoch:36, asr_loss:1.4828, asr_correct:0.9784
Train Epoch: 37 	TRAIN ACC: 0.9416 	Loss: 0.167325 time 643.6745569705963
epoch:37, test_loss:1.6326, test_correct:0.8432
epoch:37, asr_loss:1.4876, asr_correct:0.9765
Train Epoch: 38 	TRAIN ACC: 0.9425666666666667 	Loss: 0.170259 time 661.3850607872009
epoch:38, test_loss:1.6198, test_correct:0.8556
epoch:38, asr_loss:1.5178, asr_correct:0.9538
Train Epoch: 39 	TRAIN ACC: 0.9435 	Loss: 0.165838 time 679.2214844226837
epoch:39, test_loss:1.6206, test_correct:0.8538
epoch:39, asr_loss:1.4795, asr_correct:0.9814
Train Epoch: 40 	TRAIN ACC: 0.9507666666666666 	Loss: 0.145285 time 696.9753124713898
epoch:40, test_loss:1.6239, test_correct:0.8460
epoch:40, asr_loss:1.4745, asr_correct:0.9864
Train Epoch: 41 	TRAIN ACC: 0.9502333333333334 	Loss: 0.143506 time 714.6153964996338
epoch:41, test_loss:1.6064, test_correct:0.8654
epoch:41, asr_loss:1.5372, asr_correct:0.9390
Train Epoch: 42 	TRAIN ACC: 0.9541 	Loss: 0.133620 time 732.1898937225342
epoch:42, test_loss:1.6019, test_correct:0.8716
epoch:42, asr_loss:1.4852, asr_correct:0.9766
Train Epoch: 43 	TRAIN ACC: 0.9524 	Loss: 0.140296 time 749.7822730541229
epoch:43, test_loss:1.6276, test_correct:0.8460
epoch:43, asr_loss:1.4902, asr_correct:0.9724
Train Epoch: 44 	TRAIN ACC: 0.9562 	Loss: 0.127462 time 767.3839828968048
epoch:44, test_loss:1.6091, test_correct:0.8639
epoch:44, asr_loss:1.4825, asr_correct:0.9793
Train Epoch: 45 	TRAIN ACC: 0.9582 	Loss: 0.122659 time 784.9771692752838
epoch:45, test_loss:1.6085, test_correct:0.8625
epoch:45, asr_loss:1.4990, asr_correct:0.9676
Train Epoch: 46 	TRAIN ACC: 0.9550333333333333 	Loss: 0.130258 time 802.7000522613525
epoch:46, test_loss:1.6028, test_correct:0.8707
epoch:46, asr_loss:1.6498, asr_correct:0.8240
Train Epoch: 47 	TRAIN ACC: 0.9556666666666667 	Loss: 0.125013 time 820.392477273941
epoch:47, test_loss:1.6024, test_correct:0.8679
epoch:47, asr_loss:1.4897, asr_correct:0.9727
Train Epoch: 48 	TRAIN ACC: 0.9550666666666666 	Loss: 0.127378 time 838.0712504386902
epoch:48, test_loss:1.6086, test_correct:0.8634
epoch:48, asr_loss:1.4804, asr_correct:0.9806
Train Epoch: 49 	TRAIN ACC: 0.9625 	Loss: 0.106945 time 855.9279415607452
epoch:49, test_loss:1.6263, test_correct:0.8434
epoch:49, asr_loss:1.4724, asr_correct:0.9882
Train Epoch: 50 	TRAIN ACC: 0.9598333333333333 	Loss: 0.117186 time 873.5557036399841
epoch:50, test_loss:1.5964, test_correct:0.8747
epoch:50, asr_loss:1.4830, asr_correct:0.9788
Train Epoch: 51 	TRAIN ACC: 0.9614333333333334 	Loss: 0.111862 time 891.287791967392
epoch:51, test_loss:1.5982, test_correct:0.8718
epoch:51, asr_loss:1.4863, asr_correct:0.9759
Train Epoch: 52 	TRAIN ACC: 0.9619 	Loss: 0.110400 time 909.1266400814056
epoch:52, test_loss:1.6033, test_correct:0.8688
epoch:52, asr_loss:1.4736, asr_correct:0.9874
Train Epoch: 53 	TRAIN ACC: 0.9653666666666667 	Loss: 0.102112 time 926.7246179580688
epoch:53, test_loss:1.6067, test_correct:0.8645
epoch:53, asr_loss:1.4790, asr_correct:0.9815
Train Epoch: 54 	TRAIN ACC: 0.9626 	Loss: 0.109178 time 944.3756577968597
epoch:54, test_loss:1.6020, test_correct:0.8680
epoch:54, asr_loss:1.4917, asr_correct:0.9698
Train Epoch: 55 	TRAIN ACC: 0.9658 	Loss: 0.102578 time 962.0957193374634
epoch:55, test_loss:1.6011, test_correct:0.8693
epoch:55, asr_loss:1.4998, asr_correct:0.9655
Train Epoch: 56 	TRAIN ACC: 0.9635 	Loss: 0.108364 time 979.9279298782349
epoch:56, test_loss:1.6180, test_correct:0.8514
epoch:56, asr_loss:1.4871, asr_correct:0.9740
Train Epoch: 57 	TRAIN ACC: 0.9677 	Loss: 0.095550 time 997.5263588428497
epoch:57, test_loss:1.5871, test_correct:0.8818
epoch:57, asr_loss:1.4803, asr_correct:0.9809
Train Epoch: 58 	TRAIN ACC: 0.9634 	Loss: 0.111355 time 1015.4444370269775
epoch:58, test_loss:1.6142, test_correct:0.8560
epoch:58, asr_loss:1.5031, asr_correct:0.9654
Train Epoch: 59 	TRAIN ACC: 0.9616 	Loss: 0.110656 time 1033.1324362754822
epoch:59, test_loss:1.5850, test_correct:0.8860
epoch:59, asr_loss:1.4892, asr_correct:0.9730
Train Epoch: 60 	TRAIN ACC: 0.9698333333333333 	Loss: 0.089214 time 1050.8318333625793
epoch:60, test_loss:1.6039, test_correct:0.8658
epoch:60, asr_loss:1.5007, asr_correct:0.9655
Train Epoch: 61 	TRAIN ACC: 0.9713 	Loss: 0.086300 time 1068.5685267448425
epoch:61, test_loss:1.5983, test_correct:0.8690
epoch:61, asr_loss:1.4941, asr_correct:0.9686
Train Epoch: 62 	TRAIN ACC: 0.9646 	Loss: 0.101085 time 1086.1925258636475
epoch:62, test_loss:1.5947, test_correct:0.8738
epoch:62, asr_loss:1.4883, asr_correct:0.9741
Train Epoch: 63 	TRAIN ACC: 0.9696666666666667 	Loss: 0.089936 time 1104.0016694068909
epoch:63, test_loss:1.5950, test_correct:0.8726
epoch:63, asr_loss:1.4850, asr_correct:0.9760
Train Epoch: 64 	TRAIN ACC: 0.9696 	Loss: 0.088674 time 1121.7413039207458
epoch:64, test_loss:1.6054, test_correct:0.8636
epoch:64, asr_loss:1.4852, asr_correct:0.9755
Train Epoch: 65 	TRAIN ACC: 0.9672 	Loss: 0.092181 time 1139.4318222999573
epoch:65, test_loss:1.6028, test_correct:0.8666
epoch:65, asr_loss:1.4838, asr_correct:0.9781
Train Epoch: 66 	TRAIN ACC: 0.9686 	Loss: 0.091743 time 1157.1013736724854
epoch:66, test_loss:1.6009, test_correct:0.8694
epoch:66, asr_loss:1.4817, asr_correct:0.9792
Train Epoch: 67 	TRAIN ACC: 0.9719333333333333 	Loss: 0.082320 time 1174.8550772666931
epoch:67, test_loss:1.6103, test_correct:0.8574
epoch:67, asr_loss:1.4899, asr_correct:0.9719
Train Epoch: 68 	TRAIN ACC: 0.9717 	Loss: 0.083142 time 1192.3528592586517
epoch:68, test_loss:1.6099, test_correct:0.8581
epoch:68, asr_loss:1.4831, asr_correct:0.9778
Train Epoch: 69 	TRAIN ACC: 0.9687333333333333 	Loss: 0.093561 time 1210.0856685638428
epoch:69, test_loss:1.6025, test_correct:0.8662
epoch:69, asr_loss:1.5045, asr_correct:0.9613
Train Epoch: 70 	TRAIN ACC: 0.9684333333333334 	Loss: 0.092229 time 1227.7464046478271
epoch:70, test_loss:1.5861, test_correct:0.8823
epoch:70, asr_loss:1.4826, asr_correct:0.9781
Train Epoch: 71 	TRAIN ACC: 0.9702666666666667 	Loss: 0.083897 time 1245.3661890029907
epoch:71, test_loss:1.5933, test_correct:0.8752
epoch:71, asr_loss:1.5174, asr_correct:0.9505
Train Epoch: 72 	TRAIN ACC: 0.9734666666666667 	Loss: 0.076782 time 1263.2980043888092
epoch:72, test_loss:1.6227, test_correct:0.8453
epoch:72, asr_loss:1.4900, asr_correct:0.9762
Train Epoch: 73 	TRAIN ACC: 0.9744666666666667 	Loss: 0.075404 time 1281.0206418037415
epoch:73, test_loss:1.6078, test_correct:0.8602
epoch:73, asr_loss:1.4795, asr_correct:0.9811
Train Epoch: 74 	TRAIN ACC: 0.9692333333333333 	Loss: 0.091700 time 1298.5991928577423
epoch:74, test_loss:1.5919, test_correct:0.8768
epoch:74, asr_loss:1.4870, asr_correct:0.9745
Train Epoch: 75 	TRAIN ACC: 0.9712666666666666 	Loss: 0.084883 time 1316.2689917087555
epoch:75, test_loss:1.5937, test_correct:0.8758
epoch:75, asr_loss:1.4843, asr_correct:0.9776
Train Epoch: 76 	TRAIN ACC: 0.9738333333333333 	Loss: 0.077957 time 1333.8972113132477
epoch:76, test_loss:1.5951, test_correct:0.8737
epoch:76, asr_loss:1.4876, asr_correct:0.9761
Train Epoch: 77 	TRAIN ACC: 0.9772 	Loss: 0.069945 time 1351.6268420219421
epoch:77, test_loss:1.5813, test_correct:0.8850
epoch:77, asr_loss:1.6046, asr_correct:0.8728
Train Epoch: 78 	TRAIN ACC: 0.9697666666666667 	Loss: 0.088542 time 1369.3369998931885
epoch:78, test_loss:1.5909, test_correct:0.8776
epoch:78, asr_loss:1.4815, asr_correct:0.9801
Train Epoch: 79 	TRAIN ACC: 0.9693 	Loss: 0.091930 time 1387.0221617221832
epoch:79, test_loss:1.5897, test_correct:0.8784
epoch:79, asr_loss:1.5020, asr_correct:0.9636
Train Epoch: 80 	TRAIN ACC: 0.9774666666666667 	Loss: 0.070913 time 1404.656789779663
epoch:80, test_loss:1.5914, test_correct:0.8770
epoch:80, asr_loss:1.4861, asr_correct:0.9762
Train Epoch: 81 	TRAIN ACC: 0.9901 	Loss: 0.032661 time 1422.5603218078613
epoch:81, test_loss:1.5641, test_correct:0.9030
epoch:81, asr_loss:1.4825, asr_correct:0.9788
Train Epoch: 82 	TRAIN ACC: 0.9937 	Loss: 0.021365 time 1440.2589292526245
epoch:82, test_loss:1.5609, test_correct:0.9049
epoch:82, asr_loss:1.4803, asr_correct:0.9810
Train Epoch: 83 	TRAIN ACC: 0.9955 	Loss: 0.016441 time 1457.9940259456635
epoch:83, test_loss:1.5591, test_correct:0.9062
epoch:83, asr_loss:1.4806, asr_correct:0.9808
Train Epoch: 84 	TRAIN ACC: 0.9961333333333333 	Loss: 0.015253 time 1475.9873714447021
epoch:84, test_loss:1.5581, test_correct:0.9072
epoch:84, asr_loss:1.4787, asr_correct:0.9825
Train Epoch: 85 	TRAIN ACC: 0.9969 	Loss: 0.011277 time 1493.8124849796295
epoch:85, test_loss:1.5577, test_correct:0.9079
epoch:85, asr_loss:1.4770, asr_correct:0.9840
Train Epoch: 86 	TRAIN ACC: 0.9967333333333334 	Loss: 0.011970 time 1511.4181687831879
epoch:86, test_loss:1.5562, test_correct:0.9083
epoch:86, asr_loss:1.4794, asr_correct:0.9817
Train Epoch: 87 	TRAIN ACC: 0.9974666666666666 	Loss: 0.010100 time 1529.1152460575104
epoch:87, test_loss:1.5566, test_correct:0.9086
epoch:87, asr_loss:1.4765, asr_correct:0.9844
Train Epoch: 88 	TRAIN ACC: 0.9972 	Loss: 0.009943 time 1546.7216308116913
epoch:88, test_loss:1.5565, test_correct:0.9092
epoch:88, asr_loss:1.4767, asr_correct:0.9841
Train Epoch: 89 	TRAIN ACC: 0.9979666666666667 	Loss: 0.008499 time 1564.2736554145813
epoch:89, test_loss:1.5562, test_correct:0.9082
epoch:89, asr_loss:1.4773, asr_correct:0.9836
Train Epoch: 90 	TRAIN ACC: 0.9979 	Loss: 0.007976 time 1582.0454585552216
epoch:90, test_loss:1.5552, test_correct:0.9094
epoch:90, asr_loss:1.4793, asr_correct:0.9818
Train Epoch: 91 	TRAIN ACC: 0.9983 	Loss: 0.007350 time 1599.926414489746
epoch:91, test_loss:1.5554, test_correct:0.9086
epoch:91, asr_loss:1.4784, asr_correct:0.9827
Train Epoch: 92 	TRAIN ACC: 0.9988666666666667 	Loss: 0.006886 time 1617.5887162685394
epoch:92, test_loss:1.5545, test_correct:0.9093
epoch:92, asr_loss:1.4821, asr_correct:0.9794
Train Epoch: 93 	TRAIN ACC: 0.9987 	Loss: 0.006001 time 1635.3772220611572
epoch:93, test_loss:1.5550, test_correct:0.9100
epoch:93, asr_loss:1.4779, asr_correct:0.9834
Train Epoch: 94 	TRAIN ACC: 0.9983666666666666 	Loss: 0.007601 time 1652.9942390918732
epoch:94, test_loss:1.5547, test_correct:0.9099
epoch:94, asr_loss:1.4789, asr_correct:0.9820
Train Epoch: 95 	TRAIN ACC: 0.9984 	Loss: 0.006205 time 1670.7192468643188
epoch:95, test_loss:1.5559, test_correct:0.9072
epoch:95, asr_loss:1.4789, asr_correct:0.9823
Train Epoch: 96 	TRAIN ACC: 0.9987333333333334 	Loss: 0.005894 time 1688.442687511444
epoch:96, test_loss:1.5544, test_correct:0.9096
epoch:96, asr_loss:1.4785, asr_correct:0.9826
Train Epoch: 97 	TRAIN ACC: 0.9986666666666667 	Loss: 0.005430 time 1706.0322575569153
epoch:97, test_loss:1.5551, test_correct:0.9092
epoch:97, asr_loss:1.4789, asr_correct:0.9822
Train Epoch: 98 	TRAIN ACC: 0.9987666666666667 	Loss: 0.005190 time 1723.7860038280487
epoch:98, test_loss:1.5540, test_correct:0.9096
epoch:98, asr_loss:1.4784, asr_correct:0.9828
Train Epoch: 99 	TRAIN ACC: 0.9985 	Loss: 0.005742 time 1741.4709651470184
epoch:99, test_loss:1.5534, test_correct:0.9101
epoch:99, asr_loss:1.4799, asr_correct:0.9812
Train Epoch: 100 	TRAIN ACC: 0.9988 	Loss: 0.005219 time 1759.1784284114838
epoch:100, test_loss:1.5525, test_correct:0.9114
epoch:100, asr_loss:1.4794, asr_correct:0.9815
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_7.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_7 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_7 loaded
# 7 test_acc :  0.9114 test_loss :  1.5524742918777465 epsilon :  -1 total_duration: 14071.830885887146
#p_one 0.98152 (1.479410005607605)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.35786666666666667 	Loss: 1.711426 time 7.636597394943237
epoch:1, test_loss:2.1514, test_correct:0.3212
epoch:1, asr_loss:1.9958, asr_correct:0.5639
Train Epoch: 2 	TRAIN ACC: 0.5635333333333333 	Loss: 1.218527 time 25.315042972564697
epoch:2, test_loss:2.0067, test_correct:0.5292
epoch:2, asr_loss:1.5666, asr_correct:0.9190
Train Epoch: 3 	TRAIN ACC: 0.659 	Loss: 0.943030 time 43.20767021179199
epoch:3, test_loss:1.9648, test_correct:0.5748
epoch:3, asr_loss:1.4844, asr_correct:0.9876
Train Epoch: 4 	TRAIN ACC: 0.7045666666666667 	Loss: 0.826126 time 61.07564687728882
epoch:4, test_loss:1.8825, test_correct:0.6487
epoch:4, asr_loss:1.4913, asr_correct:0.9752
Train Epoch: 5 	TRAIN ACC: 0.7378666666666667 	Loss: 0.743640 time 78.70845913887024
epoch:5, test_loss:1.9012, test_correct:0.5938
epoch:5, asr_loss:1.4838, asr_correct:0.9791
Train Epoch: 6 	TRAIN ACC: 0.7711333333333333 	Loss: 0.652162 time 96.43265271186829
epoch:6, test_loss:1.8129, test_correct:0.6891
epoch:6, asr_loss:1.4772, asr_correct:0.9847
Train Epoch: 7 	TRAIN ACC: 0.7919666666666667 	Loss: 0.594559 time 114.12076830863953
epoch:7, test_loss:1.8716, test_correct:0.6222
epoch:7, asr_loss:1.4779, asr_correct:0.9850
Train Epoch: 8 	TRAIN ACC: 0.8083 	Loss: 0.547676 time 132.04862475395203
epoch:8, test_loss:1.7915, test_correct:0.7056
epoch:8, asr_loss:1.4848, asr_correct:0.9781
Train Epoch: 9 	TRAIN ACC: 0.8241666666666667 	Loss: 0.504960 time 149.87436985969543
epoch:9, test_loss:1.7577, test_correct:0.7386
epoch:9, asr_loss:1.5144, asr_correct:0.9530
Train Epoch: 10 	TRAIN ACC: 0.8373 	Loss: 0.475950 time 167.67325115203857
epoch:10, test_loss:1.7366, test_correct:0.7627
epoch:10, asr_loss:1.4761, asr_correct:0.9860
Train Epoch: 11 	TRAIN ACC: 0.8479666666666666 	Loss: 0.445812 time 185.39832377433777
epoch:11, test_loss:1.7243, test_correct:0.7797
epoch:11, asr_loss:1.4871, asr_correct:0.9744
Train Epoch: 12 	TRAIN ACC: 0.8534666666666667 	Loss: 0.417947 time 203.09610414505005
epoch:12, test_loss:1.7066, test_correct:0.7888
epoch:12, asr_loss:1.5034, asr_correct:0.9592
Train Epoch: 13 	TRAIN ACC: 0.8637 	Loss: 0.399093 time 220.9454345703125
epoch:13, test_loss:1.7179, test_correct:0.7741
epoch:13, asr_loss:1.5077, asr_correct:0.9570
Train Epoch: 14 	TRAIN ACC: 0.8679333333333333 	Loss: 0.386227 time 238.67305326461792
epoch:14, test_loss:1.6830, test_correct:0.8093
epoch:14, asr_loss:1.4810, asr_correct:0.9796
Train Epoch: 15 	TRAIN ACC: 0.8752333333333333 	Loss: 0.359830 time 256.4349000453949
epoch:15, test_loss:1.7184, test_correct:0.7633
epoch:15, asr_loss:1.4956, asr_correct:0.9670
Train Epoch: 16 	TRAIN ACC: 0.8823333333333333 	Loss: 0.347606 time 274.4056808948517
epoch:16, test_loss:1.6971, test_correct:0.7894
epoch:16, asr_loss:1.4775, asr_correct:0.9840
Train Epoch: 17 	TRAIN ACC: 0.8875 	Loss: 0.326398 time 292.1530604362488
epoch:17, test_loss:1.7022, test_correct:0.7883
epoch:17, asr_loss:1.4791, asr_correct:0.9824
Train Epoch: 18 	TRAIN ACC: 0.8931 	Loss: 0.306936 time 309.84861493110657
epoch:18, test_loss:1.6602, test_correct:0.8311
epoch:18, asr_loss:1.4773, asr_correct:0.9839
Train Epoch: 19 	TRAIN ACC: 0.8962333333333333 	Loss: 0.302883 time 327.5529329776764
epoch:19, test_loss:1.6594, test_correct:0.8270
epoch:19, asr_loss:1.4806, asr_correct:0.9807
Train Epoch: 20 	TRAIN ACC: 0.9015666666666666 	Loss: 0.290481 time 345.3402144908905
epoch:20, test_loss:1.6675, test_correct:0.8154
epoch:20, asr_loss:1.4797, asr_correct:0.9811
Train Epoch: 21 	TRAIN ACC: 0.9051666666666667 	Loss: 0.271799 time 363.0217590332031
epoch:21, test_loss:1.7110, test_correct:0.7662
epoch:21, asr_loss:1.4717, asr_correct:0.9892
Train Epoch: 22 	TRAIN ACC: 0.9006666666666666 	Loss: 0.288970 time 380.74840664863586
epoch:22, test_loss:1.6701, test_correct:0.8146
epoch:22, asr_loss:1.4884, asr_correct:0.9733
Train Epoch: 23 	TRAIN ACC: 0.9109666666666667 	Loss: 0.261325 time 398.4757900238037
epoch:23, test_loss:1.7003, test_correct:0.7822
epoch:23, asr_loss:1.4800, asr_correct:0.9816
Train Epoch: 24 	TRAIN ACC: 0.9164 	Loss: 0.242453 time 416.45405411720276
epoch:24, test_loss:1.6470, test_correct:0.8375
epoch:24, asr_loss:1.4847, asr_correct:0.9775
Train Epoch: 25 	TRAIN ACC: 0.9222666666666667 	Loss: 0.230623 time 434.05396938323975
epoch:25, test_loss:1.6328, test_correct:0.8479
epoch:25, asr_loss:1.4819, asr_correct:0.9789
Train Epoch: 26 	TRAIN ACC: 0.9214 	Loss: 0.232333 time 451.90761494636536
epoch:26, test_loss:1.6865, test_correct:0.7891
epoch:26, asr_loss:1.4816, asr_correct:0.9794
Train Epoch: 27 	TRAIN ACC: 0.9260666666666667 	Loss: 0.217905 time 469.62719464302063
epoch:27, test_loss:1.6534, test_correct:0.8270
epoch:27, asr_loss:1.5349, asr_correct:0.9371
Train Epoch: 28 	TRAIN ACC: 0.9296666666666666 	Loss: 0.207357 time 487.28130555152893
epoch:28, test_loss:1.6527, test_correct:0.8229
epoch:28, asr_loss:1.4778, asr_correct:0.9837
Train Epoch: 29 	TRAIN ACC: 0.9302 	Loss: 0.205019 time 504.9562213420868
epoch:29, test_loss:1.6605, test_correct:0.8167
epoch:29, asr_loss:1.5088, asr_correct:0.9555
Train Epoch: 30 	TRAIN ACC: 0.9322333333333334 	Loss: 0.199646 time 522.5970551967621
epoch:30, test_loss:1.6489, test_correct:0.8291
epoch:30, asr_loss:1.4961, asr_correct:0.9665
Train Epoch: 31 	TRAIN ACC: 0.9362666666666667 	Loss: 0.187635 time 540.4085388183594
epoch:31, test_loss:1.6552, test_correct:0.8186
epoch:31, asr_loss:1.4879, asr_correct:0.9737
Train Epoch: 32 	TRAIN ACC: 0.9399333333333333 	Loss: 0.173610 time 558.1571559906006
epoch:32, test_loss:1.6486, test_correct:0.8245
epoch:32, asr_loss:1.4757, asr_correct:0.9850
Train Epoch: 33 	TRAIN ACC: 0.937 	Loss: 0.177789 time 575.9483551979065
epoch:33, test_loss:1.6192, test_correct:0.8548
epoch:33, asr_loss:1.4785, asr_correct:0.9826
Train Epoch: 34 	TRAIN ACC: 0.9451 	Loss: 0.161091 time 593.6542811393738
epoch:34, test_loss:1.6207, test_correct:0.8556
epoch:34, asr_loss:1.4824, asr_correct:0.9787
Train Epoch: 35 	TRAIN ACC: 0.9422333333333334 	Loss: 0.169485 time 611.3948919773102
epoch:35, test_loss:1.6053, test_correct:0.8710
epoch:35, asr_loss:1.4888, asr_correct:0.9726
Train Epoch: 36 	TRAIN ACC: 0.9456333333333333 	Loss: 0.159097 time 629.0798554420471
epoch:36, test_loss:1.6243, test_correct:0.8518
epoch:36, asr_loss:1.4778, asr_correct:0.9831
Train Epoch: 37 	TRAIN ACC: 0.9461 	Loss: 0.158017 time 646.7198684215546
epoch:37, test_loss:1.6118, test_correct:0.8622
epoch:37, asr_loss:1.4883, asr_correct:0.9728
Train Epoch: 38 	TRAIN ACC: 0.9492 	Loss: 0.145691 time 664.4208972454071
epoch:38, test_loss:1.6018, test_correct:0.8738
epoch:38, asr_loss:1.4800, asr_correct:0.9812
Train Epoch: 39 	TRAIN ACC: 0.9497666666666666 	Loss: 0.146007 time 682.2846627235413
epoch:39, test_loss:1.6159, test_correct:0.8546
epoch:39, asr_loss:1.4825, asr_correct:0.9783
Train Epoch: 40 	TRAIN ACC: 0.9521333333333334 	Loss: 0.138738 time 699.9574890136719
epoch:40, test_loss:1.6112, test_correct:0.8631
epoch:40, asr_loss:1.4760, asr_correct:0.9848
Train Epoch: 41 	TRAIN ACC: 0.9554333333333334 	Loss: 0.133424 time 717.6499798297882
epoch:41, test_loss:1.5997, test_correct:0.8736
epoch:41, asr_loss:1.4829, asr_correct:0.9782
Train Epoch: 42 	TRAIN ACC: 0.9462666666666667 	Loss: 0.153207 time 735.4149971008301
epoch:42, test_loss:1.6223, test_correct:0.8525
epoch:42, asr_loss:1.4762, asr_correct:0.9848
Train Epoch: 43 	TRAIN ACC: 0.9512333333333334 	Loss: 0.145273 time 753.1727378368378
epoch:43, test_loss:1.5959, test_correct:0.8771
epoch:43, asr_loss:1.4798, asr_correct:0.9812
Train Epoch: 44 	TRAIN ACC: 0.9562 	Loss: 0.128555 time 770.8539464473724
epoch:44, test_loss:1.6032, test_correct:0.8692
epoch:44, asr_loss:1.4764, asr_correct:0.9847
Train Epoch: 45 	TRAIN ACC: 0.9593666666666667 	Loss: 0.120867 time 788.690007686615
epoch:45, test_loss:1.6213, test_correct:0.8494
epoch:45, asr_loss:1.4843, asr_correct:0.9772
Train Epoch: 46 	TRAIN ACC: 0.9614666666666667 	Loss: 0.115576 time 806.4428162574768
epoch:46, test_loss:1.6162, test_correct:0.8557
epoch:46, asr_loss:1.4928, asr_correct:0.9699
Train Epoch: 47 	TRAIN ACC: 0.9549666666666666 	Loss: 0.130104 time 824.189165353775
epoch:47, test_loss:1.6117, test_correct:0.8604
epoch:47, asr_loss:1.4847, asr_correct:0.9781
Train Epoch: 48 	TRAIN ACC: 0.9627666666666667 	Loss: 0.110589 time 841.9163236618042
epoch:48, test_loss:1.6071, test_correct:0.8644
epoch:48, asr_loss:1.4731, asr_correct:0.9880
Train Epoch: 49 	TRAIN ACC: 0.9632333333333334 	Loss: 0.111507 time 859.7390027046204
epoch:49, test_loss:1.5877, test_correct:0.8831
epoch:49, asr_loss:1.4792, asr_correct:0.9818
Train Epoch: 50 	TRAIN ACC: 0.9636666666666667 	Loss: 0.109378 time 877.5043723583221
epoch:50, test_loss:1.5982, test_correct:0.8707
epoch:50, asr_loss:1.5152, asr_correct:0.9512
Train Epoch: 51 	TRAIN ACC: 0.9618 	Loss: 0.118925 time 895.0852859020233
epoch:51, test_loss:1.6017, test_correct:0.8696
epoch:51, asr_loss:1.4765, asr_correct:0.9842
Train Epoch: 52 	TRAIN ACC: 0.9611333333333333 	Loss: 0.116061 time 912.9790141582489
epoch:52, test_loss:1.6094, test_correct:0.8631
epoch:52, asr_loss:1.4810, asr_correct:0.9804
Train Epoch: 53 	TRAIN ACC: 0.9641 	Loss: 0.103685 time 930.69948554039
epoch:53, test_loss:1.6093, test_correct:0.8622
epoch:53, asr_loss:1.4753, asr_correct:0.9854
Train Epoch: 54 	TRAIN ACC: 0.9583333333333334 	Loss: 0.126547 time 948.4136700630188
epoch:54, test_loss:1.5983, test_correct:0.8719
epoch:54, asr_loss:1.4827, asr_correct:0.9786
Train Epoch: 55 	TRAIN ACC: 0.9631333333333333 	Loss: 0.104472 time 966.0673611164093
epoch:55, test_loss:1.6111, test_correct:0.8568
epoch:55, asr_loss:1.4889, asr_correct:0.9723
Train Epoch: 56 	TRAIN ACC: 0.9658333333333333 	Loss: 0.097853 time 983.6411061286926
epoch:56, test_loss:1.5943, test_correct:0.8737
epoch:56, asr_loss:1.4766, asr_correct:0.9849
Train Epoch: 57 	TRAIN ACC: 0.9631 	Loss: 0.107922 time 1001.2911658287048
epoch:57, test_loss:1.6056, test_correct:0.8650
epoch:57, asr_loss:1.4821, asr_correct:0.9790
Train Epoch: 58 	TRAIN ACC: 0.9693 	Loss: 0.088621 time 1018.9353771209717
epoch:58, test_loss:1.5991, test_correct:0.8691
epoch:58, asr_loss:1.4781, asr_correct:0.9833
Train Epoch: 59 	TRAIN ACC: 0.9684666666666667 	Loss: 0.092536 time 1036.550297498703
epoch:59, test_loss:1.6082, test_correct:0.8627
epoch:59, asr_loss:1.4808, asr_correct:0.9803
Train Epoch: 60 	TRAIN ACC: 0.9676666666666667 	Loss: 0.094985 time 1054.162842988968
epoch:60, test_loss:1.5882, test_correct:0.8796
epoch:60, asr_loss:1.4784, asr_correct:0.9824
Train Epoch: 61 	TRAIN ACC: 0.9700666666666666 	Loss: 0.091853 time 1071.6832993030548
epoch:61, test_loss:1.6158, test_correct:0.8521
epoch:61, asr_loss:1.4835, asr_correct:0.9776
Train Epoch: 62 	TRAIN ACC: 0.964 	Loss: 0.105095 time 1089.369230747223
epoch:62, test_loss:1.5872, test_correct:0.8822
epoch:62, asr_loss:1.4752, asr_correct:0.9857
Train Epoch: 63 	TRAIN ACC: 0.9724333333333334 	Loss: 0.080286 time 1107.0570447444916
epoch:63, test_loss:1.6070, test_correct:0.8630
epoch:63, asr_loss:1.4791, asr_correct:0.9818
Train Epoch: 64 	TRAIN ACC: 0.9641333333333333 	Loss: 0.105634 time 1124.7475128173828
epoch:64, test_loss:1.5917, test_correct:0.8779
epoch:64, asr_loss:1.4825, asr_correct:0.9796
Train Epoch: 65 	TRAIN ACC: 0.9715666666666667 	Loss: 0.085471 time 1142.443655014038
epoch:65, test_loss:1.6016, test_correct:0.8676
epoch:65, asr_loss:1.4820, asr_correct:0.9791
Train Epoch: 66 	TRAIN ACC: 0.9676333333333333 	Loss: 0.094840 time 1160.187177181244
epoch:66, test_loss:1.5968, test_correct:0.8725
epoch:66, asr_loss:1.4847, asr_correct:0.9769
Train Epoch: 67 	TRAIN ACC: 0.9716333333333333 	Loss: 0.083723 time 1177.9739768505096
epoch:67, test_loss:1.5947, test_correct:0.8728
epoch:67, asr_loss:1.4854, asr_correct:0.9754
Train Epoch: 68 	TRAIN ACC: 0.9701 	Loss: 0.086124 time 1195.645775794983
epoch:68, test_loss:1.5908, test_correct:0.8771
epoch:68, asr_loss:1.4851, asr_correct:0.9769
Train Epoch: 69 	TRAIN ACC: 0.9740333333333333 	Loss: 0.075402 time 1213.2637813091278
epoch:69, test_loss:1.6119, test_correct:0.8574
epoch:69, asr_loss:1.4778, asr_correct:0.9846
Train Epoch: 70 	TRAIN ACC: 0.9689333333333333 	Loss: 0.093047 time 1230.8933970928192
epoch:70, test_loss:1.5876, test_correct:0.8806
epoch:70, asr_loss:1.4901, asr_correct:0.9722
Train Epoch: 71 	TRAIN ACC: 0.9763666666666667 	Loss: 0.071536 time 1248.667326450348
epoch:71, test_loss:1.5998, test_correct:0.8680
epoch:71, asr_loss:1.4782, asr_correct:0.9833
Train Epoch: 72 	TRAIN ACC: 0.9735666666666667 	Loss: 0.079775 time 1266.3203060626984
epoch:72, test_loss:1.6124, test_correct:0.8559
epoch:72, asr_loss:1.4858, asr_correct:0.9754
Train Epoch: 73 	TRAIN ACC: 0.9704333333333334 	Loss: 0.090699 time 1283.9954721927643
epoch:73, test_loss:1.5901, test_correct:0.8782
epoch:73, asr_loss:1.4756, asr_correct:0.9853
Train Epoch: 74 	TRAIN ACC: 0.9756333333333334 	Loss: 0.071735 time 1301.6402320861816
epoch:74, test_loss:1.5868, test_correct:0.8808
epoch:74, asr_loss:1.4797, asr_correct:0.9821
Train Epoch: 75 	TRAIN ACC: 0.9615333333333334 	Loss: 0.111758 time 1319.35089969635
epoch:75, test_loss:1.5816, test_correct:0.8857
epoch:75, asr_loss:1.4868, asr_correct:0.9755
Train Epoch: 76 	TRAIN ACC: 0.9734 	Loss: 0.083367 time 1336.9809923171997
epoch:76, test_loss:1.5875, test_correct:0.8807
epoch:76, asr_loss:1.4798, asr_correct:0.9814
Train Epoch: 77 	TRAIN ACC: 0.9719666666666666 	Loss: 0.082972 time 1354.7829875946045
epoch:77, test_loss:1.5858, test_correct:0.8844
epoch:77, asr_loss:1.4880, asr_correct:0.9738
Train Epoch: 78 	TRAIN ACC: 0.9729666666666666 	Loss: 0.077757 time 1372.4545390605927
epoch:78, test_loss:1.5879, test_correct:0.8806
epoch:78, asr_loss:1.4804, asr_correct:0.9808
Train Epoch: 79 	TRAIN ACC: 0.9772 	Loss: 0.069481 time 1390.0227191448212
epoch:79, test_loss:1.5980, test_correct:0.8716
epoch:79, asr_loss:1.4778, asr_correct:0.9832
Train Epoch: 80 	TRAIN ACC: 0.9716 	Loss: 0.082960 time 1407.7097375392914
epoch:80, test_loss:1.5886, test_correct:0.8788
epoch:80, asr_loss:1.5341, asr_correct:0.9330
Train Epoch: 81 	TRAIN ACC: 0.9861666666666666 	Loss: 0.042369 time 1425.3675785064697
epoch:81, test_loss:1.5627, test_correct:0.9035
epoch:81, asr_loss:1.4808, asr_correct:0.9801
Train Epoch: 82 	TRAIN ACC: 0.9939 	Loss: 0.023550 time 1443.0353844165802
epoch:82, test_loss:1.5586, test_correct:0.9081
epoch:82, asr_loss:1.4793, asr_correct:0.9818
Train Epoch: 83 	TRAIN ACC: 0.9951666666666666 	Loss: 0.019369 time 1460.7792065143585
epoch:83, test_loss:1.5582, test_correct:0.9082
epoch:83, asr_loss:1.4787, asr_correct:0.9824
Train Epoch: 84 	TRAIN ACC: 0.9956 	Loss: 0.017203 time 1478.3595235347748
epoch:84, test_loss:1.5556, test_correct:0.9099
epoch:84, asr_loss:1.4777, asr_correct:0.9831
Train Epoch: 85 	TRAIN ACC: 0.9963 	Loss: 0.014358 time 1496.1798703670502
epoch:85, test_loss:1.5551, test_correct:0.9098
epoch:85, asr_loss:1.4778, asr_correct:0.9831
Train Epoch: 86 	TRAIN ACC: 0.9970333333333333 	Loss: 0.011453 time 1513.7971472740173
epoch:86, test_loss:1.5542, test_correct:0.9110
epoch:86, asr_loss:1.4779, asr_correct:0.9831
Train Epoch: 87 	TRAIN ACC: 0.9974333333333333 	Loss: 0.010733 time 1531.4451758861542
epoch:87, test_loss:1.5526, test_correct:0.9133
epoch:87, asr_loss:1.4805, asr_correct:0.9804
Train Epoch: 88 	TRAIN ACC: 0.9975 	Loss: 0.009796 time 1549.1170394420624
epoch:88, test_loss:1.5535, test_correct:0.9114
epoch:88, asr_loss:1.4782, asr_correct:0.9830
Train Epoch: 89 	TRAIN ACC: 0.9974 	Loss: 0.009458 time 1566.7697417736053
epoch:89, test_loss:1.5542, test_correct:0.9114
epoch:89, asr_loss:1.4760, asr_correct:0.9849
Train Epoch: 90 	TRAIN ACC: 0.9975666666666667 	Loss: 0.008836 time 1584.4820692539215
epoch:90, test_loss:1.5523, test_correct:0.9123
epoch:90, asr_loss:1.4782, asr_correct:0.9827
Train Epoch: 91 	TRAIN ACC: 0.9984666666666666 	Loss: 0.006633 time 1602.0898702144623
epoch:91, test_loss:1.5528, test_correct:0.9116
epoch:91, asr_loss:1.4777, asr_correct:0.9833
Train Epoch: 92 	TRAIN ACC: 0.9984666666666666 	Loss: 0.006734 time 1619.9169850349426
epoch:92, test_loss:1.5522, test_correct:0.9122
epoch:92, asr_loss:1.4781, asr_correct:0.9827
Train Epoch: 93 	TRAIN ACC: 0.9979666666666667 	Loss: 0.007231 time 1637.5434391498566
epoch:93, test_loss:1.5527, test_correct:0.9118
epoch:93, asr_loss:1.4772, asr_correct:0.9836
Train Epoch: 94 	TRAIN ACC: 0.9988333333333334 	Loss: 0.005394 time 1655.2491979599
epoch:94, test_loss:1.5529, test_correct:0.9108
epoch:94, asr_loss:1.4766, asr_correct:0.9843
Train Epoch: 95 	TRAIN ACC: 0.9985666666666667 	Loss: 0.006054 time 1672.8625223636627
epoch:95, test_loss:1.5522, test_correct:0.9129
epoch:95, asr_loss:1.4770, asr_correct:0.9839
Train Epoch: 96 	TRAIN ACC: 0.9984333333333333 	Loss: 0.005892 time 1690.4630925655365
epoch:96, test_loss:1.5518, test_correct:0.9127
epoch:96, asr_loss:1.4778, asr_correct:0.9832
Train Epoch: 97 	TRAIN ACC: 0.9990333333333333 	Loss: 0.004159 time 1708.0498795509338
epoch:97, test_loss:1.5512, test_correct:0.9128
epoch:97, asr_loss:1.4777, asr_correct:0.9833
Train Epoch: 98 	TRAIN ACC: 0.9993 	Loss: 0.003943 time 1725.7513933181763
epoch:98, test_loss:1.5504, test_correct:0.9134
epoch:98, asr_loss:1.4794, asr_correct:0.9818
Train Epoch: 99 	TRAIN ACC: 0.9986 	Loss: 0.005246 time 1743.4523530006409
epoch:99, test_loss:1.5519, test_correct:0.9116
epoch:99, asr_loss:1.4782, asr_correct:0.9828
Train Epoch: 100 	TRAIN ACC: 0.9988333333333334 	Loss: 0.004904 time 1761.1010794639587
epoch:100, test_loss:1.5519, test_correct:0.9115
epoch:100, asr_loss:1.4789, asr_correct:0.9824
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_8.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_8 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_8 loaded
# 8 test_acc :  0.91148 test_loss :  1.5518532051467895 epsilon :  -1 total_duration: 15832.931965351105
#p_one 0.98236 (1.4789337285232544)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.35946666666666666 	Loss: 1.726749 time 7.590919494628906
epoch:1, test_loss:2.1792, test_correct:0.2638
epoch:1, asr_loss:1.5671, asr_correct:0.9813
Train Epoch: 2 	TRAIN ACC: 0.5587666666666666 	Loss: 1.223938 time 25.369149923324585
epoch:2, test_loss:2.0302, test_correct:0.4657
epoch:2, asr_loss:1.7210, asr_correct:0.7856
Train Epoch: 3 	TRAIN ACC: 0.6468666666666667 	Loss: 0.986202 time 43.09392809867859
epoch:3, test_loss:1.9377, test_correct:0.5948
epoch:3, asr_loss:1.5011, asr_correct:0.9765
Train Epoch: 4 	TRAIN ACC: 0.6918333333333333 	Loss: 0.867002 time 60.90233540534973
epoch:4, test_loss:1.9001, test_correct:0.6168
epoch:4, asr_loss:1.5971, asr_correct:0.8935
Train Epoch: 5 	TRAIN ACC: 0.7267333333333333 	Loss: 0.777465 time 78.66545987129211
epoch:5, test_loss:1.8491, test_correct:0.6855
epoch:5, asr_loss:1.4860, asr_correct:0.9769
Train Epoch: 6 	TRAIN ACC: 0.7513 	Loss: 0.705871 time 96.61884260177612
epoch:6, test_loss:1.8627, test_correct:0.6361
epoch:6, asr_loss:1.4930, asr_correct:0.9707
Train Epoch: 7 	TRAIN ACC: 0.7748666666666667 	Loss: 0.647834 time 114.3536627292633
epoch:7, test_loss:1.8045, test_correct:0.7146
epoch:7, asr_loss:1.4773, asr_correct:0.9856
Train Epoch: 8 	TRAIN ACC: 0.7927 	Loss: 0.593436 time 132.11448645591736
epoch:8, test_loss:1.7860, test_correct:0.7184
epoch:8, asr_loss:1.7311, asr_correct:0.7835
Train Epoch: 9 	TRAIN ACC: 0.8043 	Loss: 0.562746 time 149.83593368530273
epoch:9, test_loss:1.7850, test_correct:0.7236
epoch:9, asr_loss:1.4778, asr_correct:0.9840
Train Epoch: 10 	TRAIN ACC: 0.8181333333333334 	Loss: 0.519545 time 167.7208378314972
epoch:10, test_loss:1.8061, test_correct:0.6865
epoch:10, asr_loss:1.5109, asr_correct:0.9559
Train Epoch: 11 	TRAIN ACC: 0.8287666666666667 	Loss: 0.486441 time 185.32270169258118
epoch:11, test_loss:1.7231, test_correct:0.7793
epoch:11, asr_loss:1.5178, asr_correct:0.9528
Train Epoch: 12 	TRAIN ACC: 0.8392333333333334 	Loss: 0.461968 time 203.0681915283203
epoch:12, test_loss:1.7029, test_correct:0.7894
epoch:12, asr_loss:1.4988, asr_correct:0.9661
Train Epoch: 13 	TRAIN ACC: 0.8526 	Loss: 0.430778 time 220.7701780796051
epoch:13, test_loss:1.7042, test_correct:0.7974
epoch:13, asr_loss:1.5277, asr_correct:0.9452
Train Epoch: 14 	TRAIN ACC: 0.8594666666666667 	Loss: 0.404443 time 238.42880845069885
epoch:14, test_loss:1.7450, test_correct:0.7418
epoch:14, asr_loss:1.4687, asr_correct:0.9933
Train Epoch: 15 	TRAIN ACC: 0.865 	Loss: 0.389299 time 256.1921908855438
epoch:15, test_loss:1.6850, test_correct:0.8038
epoch:15, asr_loss:1.4825, asr_correct:0.9788
Train Epoch: 16 	TRAIN ACC: 0.8666666666666667 	Loss: 0.380930 time 273.79951095581055
epoch:16, test_loss:1.7136, test_correct:0.7739
epoch:16, asr_loss:1.4828, asr_correct:0.9786
Train Epoch: 17 	TRAIN ACC: 0.8776333333333334 	Loss: 0.357108 time 291.4705457687378
epoch:17, test_loss:1.7399, test_correct:0.7463
epoch:17, asr_loss:1.4703, asr_correct:0.9915
Train Epoch: 18 	TRAIN ACC: 0.88 	Loss: 0.345075 time 309.16413497924805
epoch:18, test_loss:1.7488, test_correct:0.7450
epoch:18, asr_loss:1.4824, asr_correct:0.9784
Train Epoch: 19 	TRAIN ACC: 0.8887 	Loss: 0.324752 time 326.9653675556183
epoch:19, test_loss:1.6685, test_correct:0.8198
epoch:19, asr_loss:1.5082, asr_correct:0.9578
Train Epoch: 20 	TRAIN ACC: 0.8893666666666666 	Loss: 0.321681 time 344.57935094833374
epoch:20, test_loss:1.6706, test_correct:0.8145
epoch:20, asr_loss:1.4839, asr_correct:0.9771
Train Epoch: 21 	TRAIN ACC: 0.8968333333333334 	Loss: 0.296055 time 362.3065073490143
epoch:21, test_loss:1.6576, test_correct:0.8343
epoch:21, asr_loss:1.4910, asr_correct:0.9704
Train Epoch: 22 	TRAIN ACC: 0.901 	Loss: 0.285169 time 379.94205117225647
epoch:22, test_loss:1.6579, test_correct:0.8303
epoch:22, asr_loss:1.4930, asr_correct:0.9707
Train Epoch: 23 	TRAIN ACC: 0.9073333333333333 	Loss: 0.273856 time 397.6673655509949
epoch:23, test_loss:1.6507, test_correct:0.8326
epoch:23, asr_loss:1.4807, asr_correct:0.9807
Train Epoch: 24 	TRAIN ACC: 0.9057 	Loss: 0.271466 time 415.25846099853516
epoch:24, test_loss:1.6469, test_correct:0.8388
epoch:24, asr_loss:1.4890, asr_correct:0.9726
Train Epoch: 25 	TRAIN ACC: 0.9092 	Loss: 0.266064 time 432.956919670105
epoch:25, test_loss:1.6525, test_correct:0.8318
epoch:25, asr_loss:1.4941, asr_correct:0.9736
Train Epoch: 26 	TRAIN ACC: 0.9137666666666666 	Loss: 0.248025 time 450.68039560317993
epoch:26, test_loss:1.6403, test_correct:0.8393
epoch:26, asr_loss:1.4803, asr_correct:0.9803
Train Epoch: 27 	TRAIN ACC: 0.9184333333333333 	Loss: 0.237523 time 468.35766863822937
epoch:27, test_loss:1.6676, test_correct:0.8134
epoch:27, asr_loss:1.4757, asr_correct:0.9857
Train Epoch: 28 	TRAIN ACC: 0.9195333333333333 	Loss: 0.231254 time 486.1038990020752
epoch:28, test_loss:1.6355, test_correct:0.8461
epoch:28, asr_loss:1.4750, asr_correct:0.9862
Train Epoch: 29 	TRAIN ACC: 0.9264333333333333 	Loss: 0.210772 time 503.76196908950806
epoch:29, test_loss:1.6333, test_correct:0.8492
epoch:29, asr_loss:1.4863, asr_correct:0.9759
Train Epoch: 30 	TRAIN ACC: 0.9268 	Loss: 0.213223 time 521.5182428359985
epoch:30, test_loss:1.6459, test_correct:0.8355
epoch:30, asr_loss:1.4813, asr_correct:0.9794
Train Epoch: 31 	TRAIN ACC: 0.9250333333333334 	Loss: 0.215537 time 539.1669178009033
epoch:31, test_loss:1.6479, test_correct:0.8371
epoch:31, asr_loss:1.4767, asr_correct:0.9848
Train Epoch: 32 	TRAIN ACC: 0.9345333333333333 	Loss: 0.188969 time 556.922394990921
epoch:32, test_loss:1.6297, test_correct:0.8490
epoch:32, asr_loss:1.4761, asr_correct:0.9847
Train Epoch: 33 	TRAIN ACC: 0.9353333333333333 	Loss: 0.190460 time 574.691458940506
epoch:33, test_loss:1.6570, test_correct:0.8180
epoch:33, asr_loss:1.4904, asr_correct:0.9759
Train Epoch: 34 	TRAIN ACC: 0.9362333333333334 	Loss: 0.186746 time 592.3118240833282
epoch:34, test_loss:1.6302, test_correct:0.8474
epoch:34, asr_loss:1.4814, asr_correct:0.9801
Train Epoch: 35 	TRAIN ACC: 0.938 	Loss: 0.182403 time 610.1567289829254
epoch:35, test_loss:1.6468, test_correct:0.8262
epoch:35, asr_loss:1.4662, asr_correct:0.9958
Train Epoch: 36 	TRAIN ACC: 0.9413333333333334 	Loss: 0.167560 time 627.8692395687103
epoch:36, test_loss:1.6120, test_correct:0.8642
epoch:36, asr_loss:1.4884, asr_correct:0.9750
Train Epoch: 37 	TRAIN ACC: 0.9431 	Loss: 0.165740 time 645.6283299922943
epoch:37, test_loss:1.6333, test_correct:0.8400
epoch:37, asr_loss:1.4937, asr_correct:0.9714
Train Epoch: 38 	TRAIN ACC: 0.9455 	Loss: 0.159470 time 663.3934273719788
epoch:38, test_loss:1.6248, test_correct:0.8539
epoch:38, asr_loss:1.4745, asr_correct:0.9864
Train Epoch: 39 	TRAIN ACC: 0.9424333333333333 	Loss: 0.165370 time 680.9777126312256
epoch:39, test_loss:1.6379, test_correct:0.8365
epoch:39, asr_loss:1.4736, asr_correct:0.9873
Train Epoch: 40 	TRAIN ACC: 0.9491666666666667 	Loss: 0.149966 time 698.6157274246216
epoch:40, test_loss:1.6298, test_correct:0.8407
epoch:40, asr_loss:1.4880, asr_correct:0.9748
Train Epoch: 41 	TRAIN ACC: 0.9514333333333334 	Loss: 0.141535 time 716.5436489582062
epoch:41, test_loss:1.6209, test_correct:0.8526
epoch:41, asr_loss:1.4802, asr_correct:0.9814
Train Epoch: 42 	TRAIN ACC: 0.9488666666666666 	Loss: 0.148624 time 734.3658583164215
epoch:42, test_loss:1.6095, test_correct:0.8639
epoch:42, asr_loss:1.4775, asr_correct:0.9833
Train Epoch: 43 	TRAIN ACC: 0.9541 	Loss: 0.134380 time 752.0488629341125
epoch:43, test_loss:1.6189, test_correct:0.8585
epoch:43, asr_loss:1.4780, asr_correct:0.9829
Train Epoch: 44 	TRAIN ACC: 0.9499 	Loss: 0.146894 time 769.8803639411926
epoch:44, test_loss:1.6165, test_correct:0.8581
epoch:44, asr_loss:1.4821, asr_correct:0.9789
Train Epoch: 45 	TRAIN ACC: 0.9558333333333333 	Loss: 0.128909 time 787.6748170852661
epoch:45, test_loss:1.6043, test_correct:0.8694
epoch:45, asr_loss:1.4891, asr_correct:0.9730
Train Epoch: 46 	TRAIN ACC: 0.9542 	Loss: 0.135950 time 805.2269611358643
epoch:46, test_loss:1.6343, test_correct:0.8359
epoch:46, asr_loss:1.4822, asr_correct:0.9790
Train Epoch: 47 	TRAIN ACC: 0.9580666666666666 	Loss: 0.122100 time 822.8496906757355
epoch:47, test_loss:1.6110, test_correct:0.8598
epoch:47, asr_loss:1.4851, asr_correct:0.9772
Train Epoch: 48 	TRAIN ACC: 0.9591333333333333 	Loss: 0.123822 time 840.5506808757782
epoch:48, test_loss:1.5937, test_correct:0.8782
epoch:48, asr_loss:1.4835, asr_correct:0.9780
Train Epoch: 49 	TRAIN ACC: 0.9590333333333333 	Loss: 0.119780 time 858.3712878227234
epoch:49, test_loss:1.6262, test_correct:0.8440
epoch:49, asr_loss:1.4915, asr_correct:0.9748
Train Epoch: 50 	TRAIN ACC: 0.9590333333333333 	Loss: 0.118427 time 875.9743053913116
epoch:50, test_loss:1.5978, test_correct:0.8746
epoch:50, asr_loss:1.4792, asr_correct:0.9819
Train Epoch: 51 	TRAIN ACC: 0.9617666666666667 	Loss: 0.113667 time 893.5985729694366
epoch:51, test_loss:1.6112, test_correct:0.8581
epoch:51, asr_loss:1.4783, asr_correct:0.9825
Train Epoch: 52 	TRAIN ACC: 0.9597333333333333 	Loss: 0.116684 time 911.3527319431305
epoch:52, test_loss:1.6020, test_correct:0.8711
epoch:52, asr_loss:1.4795, asr_correct:0.9826
Train Epoch: 53 	TRAIN ACC: 0.9622 	Loss: 0.112875 time 929.1742420196533
epoch:53, test_loss:1.5987, test_correct:0.8743
epoch:53, asr_loss:1.4834, asr_correct:0.9786
Train Epoch: 54 	TRAIN ACC: 0.9627333333333333 	Loss: 0.109988 time 946.9662120342255
epoch:54, test_loss:1.6013, test_correct:0.8702
epoch:54, asr_loss:1.4870, asr_correct:0.9787
Train Epoch: 55 	TRAIN ACC: 0.9604666666666667 	Loss: 0.114576 time 964.6067502498627
epoch:55, test_loss:1.5916, test_correct:0.8785
epoch:55, asr_loss:1.4863, asr_correct:0.9757
Train Epoch: 56 	TRAIN ACC: 0.9632666666666667 	Loss: 0.108415 time 982.3422529697418
epoch:56, test_loss:1.6045, test_correct:0.8648
epoch:56, asr_loss:1.4793, asr_correct:0.9823
Train Epoch: 57 	TRAIN ACC: 0.9613666666666667 	Loss: 0.114561 time 1000.0016770362854
epoch:57, test_loss:1.6041, test_correct:0.8676
epoch:57, asr_loss:1.4812, asr_correct:0.9819
Train Epoch: 58 	TRAIN ACC: 0.9672333333333333 	Loss: 0.096319 time 1017.6506292819977
epoch:58, test_loss:1.6302, test_correct:0.8386
epoch:58, asr_loss:1.4738, asr_correct:0.9885
Train Epoch: 59 	TRAIN ACC: 0.9664666666666667 	Loss: 0.094811 time 1035.4000833034515
epoch:59, test_loss:1.5886, test_correct:0.8823
epoch:59, asr_loss:1.4775, asr_correct:0.9833
Train Epoch: 60 	TRAIN ACC: 0.9654666666666667 	Loss: 0.104581 time 1053.1101205348969
epoch:60, test_loss:1.6040, test_correct:0.8671
epoch:60, asr_loss:1.5937, asr_correct:0.8949
Train Epoch: 61 	TRAIN ACC: 0.9648333333333333 	Loss: 0.102630 time 1070.9367623329163
epoch:61, test_loss:1.6095, test_correct:0.8626
epoch:61, asr_loss:1.4750, asr_correct:0.9867
Train Epoch: 62 	TRAIN ACC: 0.9685333333333334 	Loss: 0.093702 time 1088.53449010849
epoch:62, test_loss:1.5985, test_correct:0.8713
epoch:62, asr_loss:1.6030, asr_correct:0.8840
Train Epoch: 63 	TRAIN ACC: 0.9696 	Loss: 0.094529 time 1106.259572505951
epoch:63, test_loss:1.6011, test_correct:0.8702
epoch:63, asr_loss:1.4805, asr_correct:0.9806
Train Epoch: 64 	TRAIN ACC: 0.9658333333333333 	Loss: 0.100219 time 1123.9806246757507
epoch:64, test_loss:1.6016, test_correct:0.8683
epoch:64, asr_loss:1.4888, asr_correct:0.9758
Train Epoch: 65 	TRAIN ACC: 0.9643 	Loss: 0.105554 time 1141.760492324829
epoch:65, test_loss:1.6101, test_correct:0.8572
epoch:65, asr_loss:1.4764, asr_correct:0.9845
Train Epoch: 66 	TRAIN ACC: 0.9669333333333333 	Loss: 0.096094 time 1159.569848537445
epoch:66, test_loss:1.6106, test_correct:0.8581
epoch:66, asr_loss:1.4751, asr_correct:0.9868
Train Epoch: 67 	TRAIN ACC: 0.9689333333333333 	Loss: 0.090548 time 1177.3245391845703
epoch:67, test_loss:1.5864, test_correct:0.8821
epoch:67, asr_loss:1.4780, asr_correct:0.9829
Train Epoch: 68 	TRAIN ACC: 0.9698666666666667 	Loss: 0.087627 time 1195.0348706245422
epoch:68, test_loss:1.6044, test_correct:0.8649
epoch:68, asr_loss:1.4830, asr_correct:0.9802
Train Epoch: 69 	TRAIN ACC: 0.9728333333333333 	Loss: 0.084603 time 1212.680869102478
epoch:69, test_loss:1.5957, test_correct:0.8738
epoch:69, asr_loss:1.4789, asr_correct:0.9830
Train Epoch: 70 	TRAIN ACC: 0.9706333333333333 	Loss: 0.088416 time 1230.4087636470795
epoch:70, test_loss:1.5871, test_correct:0.8812
epoch:70, asr_loss:1.4940, asr_correct:0.9742
Train Epoch: 71 	TRAIN ACC: 0.9721666666666666 	Loss: 0.084008 time 1248.0873365402222
epoch:71, test_loss:1.6046, test_correct:0.8644
epoch:71, asr_loss:1.4720, asr_correct:0.9891
Train Epoch: 72 	TRAIN ACC: 0.9692666666666667 	Loss: 0.090529 time 1265.786391735077
epoch:72, test_loss:1.6049, test_correct:0.8625
epoch:72, asr_loss:1.5244, asr_correct:0.9514
Train Epoch: 73 	TRAIN ACC: 0.9647333333333333 	Loss: 0.101796 time 1283.571317434311
epoch:73, test_loss:1.5936, test_correct:0.8767
epoch:73, asr_loss:1.4810, asr_correct:0.9810
Train Epoch: 74 	TRAIN ACC: 0.9721 	Loss: 0.081341 time 1301.2209782600403
epoch:74, test_loss:1.5998, test_correct:0.8686
epoch:74, asr_loss:1.4846, asr_correct:0.9802
Train Epoch: 75 	TRAIN ACC: 0.9753333333333334 	Loss: 0.075304 time 1318.866191148758
epoch:75, test_loss:1.6114, test_correct:0.8557
epoch:75, asr_loss:1.4829, asr_correct:0.9797
Train Epoch: 76 	TRAIN ACC: 0.9638333333333333 	Loss: 0.107686 time 1336.6159982681274
epoch:76, test_loss:1.5917, test_correct:0.8779
epoch:76, asr_loss:1.4831, asr_correct:0.9802
Train Epoch: 77 	TRAIN ACC: 0.9760666666666666 	Loss: 0.069583 time 1354.2370100021362
epoch:77, test_loss:1.5969, test_correct:0.8698
epoch:77, asr_loss:1.4758, asr_correct:0.9851
Train Epoch: 78 	TRAIN ACC: 0.9737666666666667 	Loss: 0.074966 time 1371.9763898849487
epoch:78, test_loss:1.5903, test_correct:0.8778
epoch:78, asr_loss:1.4783, asr_correct:0.9820
Train Epoch: 79 	TRAIN ACC: 0.9736 	Loss: 0.081189 time 1389.689593076706
epoch:79, test_loss:1.5894, test_correct:0.8788
epoch:79, asr_loss:1.4746, asr_correct:0.9864
Train Epoch: 80 	TRAIN ACC: 0.9698 	Loss: 0.088609 time 1407.3582830429077
epoch:80, test_loss:1.5951, test_correct:0.8735
epoch:80, asr_loss:1.5271, asr_correct:0.9546
Train Epoch: 81 	TRAIN ACC: 0.9854666666666667 	Loss: 0.045027 time 1425.0561199188232
epoch:81, test_loss:1.5642, test_correct:0.9051
epoch:81, asr_loss:1.4924, asr_correct:0.9762
Train Epoch: 82 	TRAIN ACC: 0.9931 	Loss: 0.025187 time 1442.744194984436
epoch:82, test_loss:1.5634, test_correct:0.9048
epoch:82, asr_loss:1.4825, asr_correct:0.9808
Train Epoch: 83 	TRAIN ACC: 0.9945 	Loss: 0.020850 time 1460.4941487312317
epoch:83, test_loss:1.5619, test_correct:0.9057
epoch:83, asr_loss:1.4798, asr_correct:0.9830
Train Epoch: 84 	TRAIN ACC: 0.9952666666666666 	Loss: 0.016582 time 1478.1505055427551
epoch:84, test_loss:1.5595, test_correct:0.9073
epoch:84, asr_loss:1.4943, asr_correct:0.9788
Train Epoch: 85 	TRAIN ACC: 0.996 	Loss: 0.015334 time 1495.8225719928741
epoch:85, test_loss:1.5618, test_correct:0.9048
epoch:85, asr_loss:1.4817, asr_correct:0.9829
Train Epoch: 86 	TRAIN ACC: 0.9960333333333333 	Loss: 0.015392 time 1513.6476936340332
epoch:86, test_loss:1.5568, test_correct:0.9096
epoch:86, asr_loss:1.5027, asr_correct:0.9747
Train Epoch: 87 	TRAIN ACC: 0.9965666666666667 	Loss: 0.012528 time 1531.3462212085724
epoch:87, test_loss:1.5576, test_correct:0.9079
epoch:87, asr_loss:1.4812, asr_correct:0.9819
Train Epoch: 88 	TRAIN ACC: 0.9969666666666667 	Loss: 0.011536 time 1549.1126790046692
epoch:88, test_loss:1.5622, test_correct:0.9042
epoch:88, asr_loss:1.4752, asr_correct:0.9867
Train Epoch: 89 	TRAIN ACC: 0.9975 	Loss: 0.010155 time 1566.8826377391815
epoch:89, test_loss:1.5589, test_correct:0.9063
epoch:89, asr_loss:1.4820, asr_correct:0.9828
Train Epoch: 90 	TRAIN ACC: 0.9976666666666667 	Loss: 0.010100 time 1584.7057518959045
epoch:90, test_loss:1.5545, test_correct:0.9103
epoch:90, asr_loss:1.5000, asr_correct:0.9745
Train Epoch: 91 	TRAIN ACC: 0.998 	Loss: 0.008470 time 1602.4468150138855
epoch:91, test_loss:1.5550, test_correct:0.9096
epoch:91, asr_loss:1.5229, asr_correct:0.9612
Train Epoch: 92 	TRAIN ACC: 0.9976333333333334 	Loss: 0.009307 time 1620.3425056934357
epoch:92, test_loss:1.5562, test_correct:0.9096
epoch:92, asr_loss:1.4811, asr_correct:0.9834
Train Epoch: 93 	TRAIN ACC: 0.9984 	Loss: 0.007367 time 1638.0063979625702
epoch:93, test_loss:1.5547, test_correct:0.9096
epoch:93, asr_loss:1.4900, asr_correct:0.9794
Train Epoch: 94 	TRAIN ACC: 0.9981 	Loss: 0.007819 time 1655.757779121399
epoch:94, test_loss:1.5610, test_correct:0.9038
epoch:94, asr_loss:1.4756, asr_correct:0.9862
Train Epoch: 95 	TRAIN ACC: 0.9982666666666666 	Loss: 0.007165 time 1673.5364527702332
epoch:95, test_loss:1.5543, test_correct:0.9104
epoch:95, asr_loss:1.4772, asr_correct:0.9846
Train Epoch: 96 	TRAIN ACC: 0.9981333333333333 	Loss: 0.006703 time 1691.2074284553528
epoch:96, test_loss:1.5536, test_correct:0.9114
epoch:96, asr_loss:1.4912, asr_correct:0.9792
Train Epoch: 97 	TRAIN ACC: 0.9982666666666666 	Loss: 0.006704 time 1708.8617296218872
epoch:97, test_loss:1.5599, test_correct:0.9048
epoch:97, asr_loss:1.4756, asr_correct:0.9860
Train Epoch: 98 	TRAIN ACC: 0.9983 	Loss: 0.006420 time 1726.57355260849
epoch:98, test_loss:1.5572, test_correct:0.9066
epoch:98, asr_loss:1.4885, asr_correct:0.9794
Train Epoch: 99 	TRAIN ACC: 0.9985333333333334 	Loss: 0.006078 time 1744.3319945335388
epoch:99, test_loss:1.5546, test_correct:0.9093
epoch:99, asr_loss:1.5274, asr_correct:0.9566
Train Epoch: 100 	TRAIN ACC: 0.9986666666666667 	Loss: 0.005791 time 1762.0694108009338
epoch:100, test_loss:1.5538, test_correct:0.9101
epoch:100, asr_loss:1.4906, asr_correct:0.9775
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_9.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_9 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_9 loaded
# 9 test_acc :  0.91008 test_loss :  1.553813521080017 epsilon :  -1 total_duration: 17595.00137615204
#p_one 0.97752 (1.4906415548706056)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.3305666666666667 	Loss: 1.763395 time 7.622290134429932
epoch:1, test_loss:2.1617, test_correct:0.3151
epoch:1, asr_loss:2.1419, asr_correct:0.3515
Train Epoch: 2 	TRAIN ACC: 0.517 	Loss: 1.326404 time 25.30428147315979
epoch:2, test_loss:2.0911, test_correct:0.3881
epoch:2, asr_loss:1.5305, asr_correct:0.9522
Train Epoch: 3 	TRAIN ACC: 0.642 	Loss: 1.005067 time 43.25477409362793
epoch:3, test_loss:1.9981, test_correct:0.5057
epoch:3, asr_loss:1.4695, asr_correct:0.9949
Train Epoch: 4 	TRAIN ACC: 0.6858 	Loss: 0.873255 time 60.95755863189697
epoch:4, test_loss:1.9047, test_correct:0.6188
epoch:4, asr_loss:1.5140, asr_correct:0.9521
Train Epoch: 5 	TRAIN ACC: 0.7318666666666667 	Loss: 0.760071 time 78.8096444606781
epoch:5, test_loss:1.8479, test_correct:0.6766
epoch:5, asr_loss:1.5088, asr_correct:0.9616
Train Epoch: 6 	TRAIN ACC: 0.7540666666666667 	Loss: 0.694718 time 96.46790266036987
epoch:6, test_loss:1.8125, test_correct:0.6997
epoch:6, asr_loss:1.5052, asr_correct:0.9610
Train Epoch: 7 	TRAIN ACC: 0.7778333333333334 	Loss: 0.632546 time 114.15169763565063
epoch:7, test_loss:1.8358, test_correct:0.6887
epoch:7, asr_loss:1.4998, asr_correct:0.9647
Train Epoch: 8 	TRAIN ACC: 0.7996 	Loss: 0.572229 time 131.76906442642212
epoch:8, test_loss:1.7784, test_correct:0.7098
epoch:8, asr_loss:1.4833, asr_correct:0.9784
Train Epoch: 9 	TRAIN ACC: 0.8154333333333333 	Loss: 0.525615 time 149.51544952392578
epoch:9, test_loss:1.7575, test_correct:0.7526
epoch:9, asr_loss:1.4880, asr_correct:0.9752
Train Epoch: 10 	TRAIN ACC: 0.8294333333333334 	Loss: 0.501141 time 167.2034091949463
epoch:10, test_loss:1.7697, test_correct:0.7442
epoch:10, asr_loss:1.5042, asr_correct:0.9645
Train Epoch: 11 	TRAIN ACC: 0.8384333333333334 	Loss: 0.467191 time 184.92341089248657
epoch:11, test_loss:1.7596, test_correct:0.7438
epoch:11, asr_loss:1.4783, asr_correct:0.9838
Train Epoch: 12 	TRAIN ACC: 0.8449333333333333 	Loss: 0.446314 time 202.73108530044556
epoch:12, test_loss:1.7162, test_correct:0.7847
epoch:12, asr_loss:1.5310, asr_correct:0.9389
Train Epoch: 13 	TRAIN ACC: 0.8568666666666667 	Loss: 0.412841 time 220.42016649246216
epoch:13, test_loss:1.7349, test_correct:0.7563
epoch:13, asr_loss:1.4914, asr_correct:0.9718
Train Epoch: 14 	TRAIN ACC: 0.8633666666666666 	Loss: 0.397472 time 238.05549502372742
epoch:14, test_loss:1.7180, test_correct:0.7652
epoch:14, asr_loss:1.5066, asr_correct:0.9599
Train Epoch: 15 	TRAIN ACC: 0.8689333333333333 	Loss: 0.379995 time 255.73225593566895
epoch:15, test_loss:1.7005, test_correct:0.7883
epoch:15, asr_loss:1.4997, asr_correct:0.9682
Train Epoch: 16 	TRAIN ACC: 0.8734333333333333 	Loss: 0.369628 time 273.40670824050903
epoch:16, test_loss:1.6981, test_correct:0.7902
epoch:16, asr_loss:1.4839, asr_correct:0.9771
Train Epoch: 17 	TRAIN ACC: 0.8850666666666667 	Loss: 0.335189 time 291.1452968120575
epoch:17, test_loss:1.7058, test_correct:0.7738
epoch:17, asr_loss:1.5021, asr_correct:0.9642
Train Epoch: 18 	TRAIN ACC: 0.8841 	Loss: 0.335786 time 308.91589641571045
epoch:18, test_loss:1.7130, test_correct:0.7764
epoch:18, asr_loss:1.4670, asr_correct:0.9945
Train Epoch: 19 	TRAIN ACC: 0.8897 	Loss: 0.321099 time 326.67253375053406
epoch:19, test_loss:1.6573, test_correct:0.8339
epoch:19, asr_loss:1.4779, asr_correct:0.9831
Train Epoch: 20 	TRAIN ACC: 0.8980666666666667 	Loss: 0.299269 time 344.412739276886
epoch:20, test_loss:1.7087, test_correct:0.7855
epoch:20, asr_loss:1.4803, asr_correct:0.9813
Train Epoch: 21 	TRAIN ACC: 0.8971 	Loss: 0.299145 time 362.1624929904938
epoch:21, test_loss:1.6537, test_correct:0.8324
epoch:21, asr_loss:1.4957, asr_correct:0.9674
Train Epoch: 22 	TRAIN ACC: 0.9014 	Loss: 0.280462 time 379.9321768283844
epoch:22, test_loss:1.6421, test_correct:0.8477
epoch:22, asr_loss:1.5314, asr_correct:0.9489
Train Epoch: 23 	TRAIN ACC: 0.9076 	Loss: 0.266701 time 397.64625668525696
epoch:23, test_loss:1.6584, test_correct:0.8239
epoch:23, asr_loss:1.4866, asr_correct:0.9745
Train Epoch: 24 	TRAIN ACC: 0.9130333333333334 	Loss: 0.258350 time 415.37734055519104
epoch:24, test_loss:1.6227, test_correct:0.8607
epoch:24, asr_loss:1.5043, asr_correct:0.9626
Train Epoch: 25 	TRAIN ACC: 0.9169 	Loss: 0.240407 time 433.14577317237854
epoch:25, test_loss:1.6596, test_correct:0.8207
epoch:25, asr_loss:1.4782, asr_correct:0.9829
Train Epoch: 26 	TRAIN ACC: 0.9218 	Loss: 0.228642 time 450.90436244010925
epoch:26, test_loss:1.6466, test_correct:0.8378
epoch:26, asr_loss:1.4991, asr_correct:0.9654
Train Epoch: 27 	TRAIN ACC: 0.9215666666666666 	Loss: 0.233007 time 468.63921451568604
epoch:27, test_loss:1.6320, test_correct:0.8534
epoch:27, asr_loss:1.4704, asr_correct:0.9912
Train Epoch: 28 	TRAIN ACC: 0.9209666666666667 	Loss: 0.227383 time 486.21134996414185
epoch:28, test_loss:1.6308, test_correct:0.8492
epoch:28, asr_loss:1.4749, asr_correct:0.9864
Train Epoch: 29 	TRAIN ACC: 0.9250666666666667 	Loss: 0.218116 time 503.9621891975403
epoch:29, test_loss:1.6440, test_correct:0.8354
epoch:29, asr_loss:1.5144, asr_correct:0.9552
Train Epoch: 30 	TRAIN ACC: 0.931 	Loss: 0.203400 time 521.4892735481262
epoch:30, test_loss:1.6296, test_correct:0.8542
epoch:30, asr_loss:1.5134, asr_correct:0.9603
Train Epoch: 31 	TRAIN ACC: 0.9357333333333333 	Loss: 0.187700 time 539.1813364028931
epoch:31, test_loss:1.6385, test_correct:0.8416
epoch:31, asr_loss:1.4787, asr_correct:0.9827
Train Epoch: 32 	TRAIN ACC: 0.9339 	Loss: 0.189960 time 557.1436953544617
epoch:32, test_loss:1.6146, test_correct:0.8603
epoch:32, asr_loss:1.4843, asr_correct:0.9777
Train Epoch: 33 	TRAIN ACC: 0.9345666666666667 	Loss: 0.191323 time 574.8025135993958
epoch:33, test_loss:1.6582, test_correct:0.8178
epoch:33, asr_loss:1.5205, asr_correct:0.9524
Train Epoch: 34 	TRAIN ACC: 0.9410333333333334 	Loss: 0.174077 time 592.538126707077
epoch:34, test_loss:1.6319, test_correct:0.8453
epoch:34, asr_loss:1.4831, asr_correct:0.9784
Train Epoch: 35 	TRAIN ACC: 0.9439 	Loss: 0.162653 time 610.2213325500488
epoch:35, test_loss:1.6305, test_correct:0.8418
epoch:35, asr_loss:1.4780, asr_correct:0.9832
Train Epoch: 36 	TRAIN ACC: 0.9454333333333333 	Loss: 0.159547 time 627.8944680690765
epoch:36, test_loss:1.6139, test_correct:0.8608
epoch:36, asr_loss:1.4775, asr_correct:0.9834
Train Epoch: 37 	TRAIN ACC: 0.9465666666666667 	Loss: 0.161133 time 645.6431245803833
epoch:37, test_loss:1.6247, test_correct:0.8492
epoch:37, asr_loss:1.4800, asr_correct:0.9812
Train Epoch: 38 	TRAIN ACC: 0.933 	Loss: 0.198328 time 663.3352158069611
epoch:38, test_loss:1.6356, test_correct:0.8417
epoch:38, asr_loss:1.4869, asr_correct:0.9760
Train Epoch: 39 	TRAIN ACC: 0.9470333333333333 	Loss: 0.156603 time 681.0091624259949
epoch:39, test_loss:1.6039, test_correct:0.8694
epoch:39, asr_loss:1.4839, asr_correct:0.9772
Train Epoch: 40 	TRAIN ACC: 0.9500666666666666 	Loss: 0.145499 time 698.7321496009827
epoch:40, test_loss:1.6211, test_correct:0.8549
epoch:40, asr_loss:1.4745, asr_correct:0.9861
Train Epoch: 41 	TRAIN ACC: 0.9523333333333334 	Loss: 0.142248 time 716.4657137393951
epoch:41, test_loss:1.6005, test_correct:0.8762
epoch:41, asr_loss:1.4805, asr_correct:0.9803
Train Epoch: 42 	TRAIN ACC: 0.9553 	Loss: 0.134956 time 734.156575679779
epoch:42, test_loss:1.6362, test_correct:0.8391
epoch:42, asr_loss:1.4725, asr_correct:0.9883
Train Epoch: 43 	TRAIN ACC: 0.9489666666666666 	Loss: 0.146147 time 751.8217766284943
epoch:43, test_loss:1.6225, test_correct:0.8488
epoch:43, asr_loss:1.4781, asr_correct:0.9828
Train Epoch: 44 	TRAIN ACC: 0.9547666666666667 	Loss: 0.131865 time 769.4860835075378
epoch:44, test_loss:1.6347, test_correct:0.8348
epoch:44, asr_loss:1.4869, asr_correct:0.9759
Train Epoch: 45 	TRAIN ACC: 0.9560333333333333 	Loss: 0.126291 time 787.1661894321442
epoch:45, test_loss:1.6058, test_correct:0.8680
epoch:45, asr_loss:1.4868, asr_correct:0.9744
Train Epoch: 46 	TRAIN ACC: 0.9604333333333334 	Loss: 0.113776 time 804.8134860992432
epoch:46, test_loss:1.6054, test_correct:0.8653
epoch:46, asr_loss:1.4770, asr_correct:0.9842
Train Epoch: 47 	TRAIN ACC: 0.9540333333333333 	Loss: 0.139316 time 822.5060832500458
epoch:47, test_loss:1.6116, test_correct:0.8627
epoch:47, asr_loss:1.4761, asr_correct:0.9844
Train Epoch: 48 	TRAIN ACC: 0.9589333333333333 	Loss: 0.120010 time 840.0891342163086
epoch:48, test_loss:1.6219, test_correct:0.8468
epoch:48, asr_loss:1.4871, asr_correct:0.9773
Train Epoch: 49 	TRAIN ACC: 0.9594666666666667 	Loss: 0.125149 time 857.8631722927094
epoch:49, test_loss:1.6075, test_correct:0.8632
epoch:49, asr_loss:1.4825, asr_correct:0.9791
Train Epoch: 50 	TRAIN ACC: 0.9556333333333333 	Loss: 0.126235 time 875.5426452159882
epoch:50, test_loss:1.5935, test_correct:0.8780
epoch:50, asr_loss:1.4883, asr_correct:0.9730
Train Epoch: 51 	TRAIN ACC: 0.9638 	Loss: 0.109172 time 893.3499422073364
epoch:51, test_loss:1.6087, test_correct:0.8608
epoch:51, asr_loss:1.4724, asr_correct:0.9883
Train Epoch: 52 	TRAIN ACC: 0.9605 	Loss: 0.115613 time 911.0464732646942
epoch:52, test_loss:1.5950, test_correct:0.8756
epoch:52, asr_loss:1.4907, asr_correct:0.9708
Train Epoch: 53 	TRAIN ACC: 0.9654666666666667 	Loss: 0.101147 time 928.6805493831635
epoch:53, test_loss:1.5883, test_correct:0.8820
epoch:53, asr_loss:1.4967, asr_correct:0.9660
Train Epoch: 54 	TRAIN ACC: 0.9620666666666666 	Loss: 0.110134 time 946.4171929359436
epoch:54, test_loss:1.6004, test_correct:0.8703
epoch:54, asr_loss:1.4783, asr_correct:0.9833
Train Epoch: 55 	TRAIN ACC: 0.9649666666666666 	Loss: 0.103112 time 964.0588920116425
epoch:55, test_loss:1.5927, test_correct:0.8754
epoch:55, asr_loss:1.4843, asr_correct:0.9781
Train Epoch: 56 	TRAIN ACC: 0.9657333333333333 	Loss: 0.102160 time 981.7495515346527
epoch:56, test_loss:1.5952, test_correct:0.8740
epoch:56, asr_loss:1.4832, asr_correct:0.9779
Train Epoch: 57 	TRAIN ACC: 0.9650666666666666 	Loss: 0.101842 time 999.5020501613617
epoch:57, test_loss:1.6074, test_correct:0.8605
epoch:57, asr_loss:1.4746, asr_correct:0.9865
Train Epoch: 58 	TRAIN ACC: 0.966 	Loss: 0.099049 time 1017.3493142127991
epoch:58, test_loss:1.5898, test_correct:0.8794
epoch:58, asr_loss:1.4874, asr_correct:0.9747
Train Epoch: 59 	TRAIN ACC: 0.9643333333333334 	Loss: 0.106595 time 1034.943954706192
epoch:59, test_loss:1.6130, test_correct:0.8588
epoch:59, asr_loss:1.4685, asr_correct:0.9928
Train Epoch: 60 	TRAIN ACC: 0.9653333333333334 	Loss: 0.101233 time 1052.6049871444702
epoch:60, test_loss:1.5931, test_correct:0.8753
epoch:60, asr_loss:1.4848, asr_correct:0.9767
Train Epoch: 61 	TRAIN ACC: 0.9673333333333334 	Loss: 0.091782 time 1070.2852745056152
epoch:61, test_loss:1.6094, test_correct:0.8584
epoch:61, asr_loss:1.4882, asr_correct:0.9750
Train Epoch: 62 	TRAIN ACC: 0.9688 	Loss: 0.091100 time 1088.0348846912384
epoch:62, test_loss:1.6086, test_correct:0.8610
epoch:62, asr_loss:1.5013, asr_correct:0.9678
Train Epoch: 63 	TRAIN ACC: 0.9677666666666667 	Loss: 0.094609 time 1105.6240119934082
epoch:63, test_loss:1.5850, test_correct:0.8850
epoch:63, asr_loss:1.4864, asr_correct:0.9748
Train Epoch: 64 	TRAIN ACC: 0.9672333333333333 	Loss: 0.093506 time 1123.2817809581757
epoch:64, test_loss:1.5976, test_correct:0.8698
epoch:64, asr_loss:1.5137, asr_correct:0.9566
Train Epoch: 65 	TRAIN ACC: 0.9723 	Loss: 0.083760 time 1140.9144666194916
epoch:65, test_loss:1.6191, test_correct:0.8498
epoch:65, asr_loss:1.9086, asr_correct:0.5504
Train Epoch: 66 	TRAIN ACC: 0.9671333333333333 	Loss: 0.099735 time 1158.507580280304
epoch:66, test_loss:1.6064, test_correct:0.8611
epoch:66, asr_loss:1.4788, asr_correct:0.9823
Train Epoch: 67 	TRAIN ACC: 0.9705666666666667 	Loss: 0.090247 time 1176.1617393493652
epoch:67, test_loss:1.5846, test_correct:0.8831
epoch:67, asr_loss:1.4896, asr_correct:0.9738
Train Epoch: 68 	TRAIN ACC: 0.9709 	Loss: 0.084537 time 1193.841278553009
epoch:68, test_loss:1.6015, test_correct:0.8670
epoch:68, asr_loss:1.4805, asr_correct:0.9818
Train Epoch: 69 	TRAIN ACC: 0.9726 	Loss: 0.080255 time 1211.5168311595917
epoch:69, test_loss:1.5857, test_correct:0.8814
epoch:69, asr_loss:1.5448, asr_correct:0.9340
Train Epoch: 70 	TRAIN ACC: 0.9733 	Loss: 0.077582 time 1229.2335033416748
epoch:70, test_loss:1.6024, test_correct:0.8640
epoch:70, asr_loss:1.4774, asr_correct:0.9838
Train Epoch: 71 	TRAIN ACC: 0.9697 	Loss: 0.090537 time 1246.914500951767
epoch:71, test_loss:1.5950, test_correct:0.8732
epoch:71, asr_loss:1.4798, asr_correct:0.9807
Train Epoch: 72 	TRAIN ACC: 0.9724333333333334 	Loss: 0.080471 time 1264.6347057819366
epoch:72, test_loss:1.5882, test_correct:0.8813
epoch:72, asr_loss:1.4831, asr_correct:0.9795
Train Epoch: 73 	TRAIN ACC: 0.9743666666666667 	Loss: 0.078774 time 1282.2913405895233
epoch:73, test_loss:1.5845, test_correct:0.8839
epoch:73, asr_loss:1.4801, asr_correct:0.9810
Train Epoch: 74 	TRAIN ACC: 0.9671666666666666 	Loss: 0.096623 time 1300.0050666332245
epoch:74, test_loss:1.5895, test_correct:0.8788
epoch:74, asr_loss:1.4821, asr_correct:0.9797
Train Epoch: 75 	TRAIN ACC: 0.9734 	Loss: 0.079354 time 1317.591416835785
epoch:75, test_loss:1.6023, test_correct:0.8659
epoch:75, asr_loss:1.5335, asr_correct:0.9428
Train Epoch: 76 	TRAIN ACC: 0.9647 	Loss: 0.106269 time 1335.3191165924072
epoch:76, test_loss:1.5933, test_correct:0.8750
epoch:76, asr_loss:1.4849, asr_correct:0.9802
Train Epoch: 77 	TRAIN ACC: 0.9778666666666667 	Loss: 0.066632 time 1352.9242253303528
epoch:77, test_loss:1.5806, test_correct:0.8860
epoch:77, asr_loss:1.4847, asr_correct:0.9772
Train Epoch: 78 	TRAIN ACC: 0.9714666666666667 	Loss: 0.086844 time 1370.7080719470978
epoch:78, test_loss:1.5989, test_correct:0.8684
epoch:78, asr_loss:1.4850, asr_correct:0.9764
Train Epoch: 79 	TRAIN ACC: 0.9741666666666666 	Loss: 0.077633 time 1388.4088382720947
epoch:79, test_loss:1.5952, test_correct:0.8724
epoch:79, asr_loss:1.5043, asr_correct:0.9625
Train Epoch: 80 	TRAIN ACC: 0.9764 	Loss: 0.069720 time 1406.1400225162506
epoch:80, test_loss:1.5883, test_correct:0.8796
epoch:80, asr_loss:1.4845, asr_correct:0.9774
Train Epoch: 81 	TRAIN ACC: 0.988 	Loss: 0.038595 time 1423.7718224525452
epoch:81, test_loss:1.5651, test_correct:0.9015
epoch:81, asr_loss:1.4892, asr_correct:0.9750
Train Epoch: 82 	TRAIN ACC: 0.9926666666666667 	Loss: 0.024837 time 1441.4251806735992
epoch:82, test_loss:1.5621, test_correct:0.9040
epoch:82, asr_loss:1.4870, asr_correct:0.9766
Train Epoch: 83 	TRAIN ACC: 0.9951666666666666 	Loss: 0.017276 time 1459.1134734153748
epoch:83, test_loss:1.5606, test_correct:0.9048
epoch:83, asr_loss:1.4916, asr_correct:0.9728
Train Epoch: 84 	TRAIN ACC: 0.996 	Loss: 0.014345 time 1476.863718509674
epoch:84, test_loss:1.5587, test_correct:0.9063
epoch:84, asr_loss:1.4897, asr_correct:0.9744
Train Epoch: 85 	TRAIN ACC: 0.9963666666666666 	Loss: 0.012657 time 1494.6308448314667
epoch:85, test_loss:1.5594, test_correct:0.9062
epoch:85, asr_loss:1.4816, asr_correct:0.9810
Train Epoch: 86 	TRAIN ACC: 0.9971 	Loss: 0.011676 time 1512.296575307846
epoch:86, test_loss:1.5570, test_correct:0.9080
epoch:86, asr_loss:1.4892, asr_correct:0.9744
Train Epoch: 87 	TRAIN ACC: 0.9967333333333334 	Loss: 0.012127 time 1530.007333278656
epoch:87, test_loss:1.5577, test_correct:0.9074
epoch:87, asr_loss:1.4835, asr_correct:0.9784
Train Epoch: 88 	TRAIN ACC: 0.9976666666666667 	Loss: 0.009753 time 1547.7075085639954
epoch:88, test_loss:1.5565, test_correct:0.9078
epoch:88, asr_loss:1.4906, asr_correct:0.9737
Train Epoch: 89 	TRAIN ACC: 0.9976666666666667 	Loss: 0.009498 time 1565.4203884601593
epoch:89, test_loss:1.5569, test_correct:0.9075
epoch:89, asr_loss:1.4925, asr_correct:0.9726
Train Epoch: 90 	TRAIN ACC: 0.9979 	Loss: 0.008289 time 1583.0896422863007
epoch:90, test_loss:1.5567, test_correct:0.9071
epoch:90, asr_loss:1.4858, asr_correct:0.9764
Train Epoch: 91 	TRAIN ACC: 0.9983666666666666 	Loss: 0.007411 time 1600.732617855072
epoch:91, test_loss:1.5559, test_correct:0.9080
epoch:91, asr_loss:1.4908, asr_correct:0.9729
Train Epoch: 92 	TRAIN ACC: 0.9984 	Loss: 0.007108 time 1618.4724979400635
epoch:92, test_loss:1.5561, test_correct:0.9083
epoch:92, asr_loss:1.5052, asr_correct:0.9644
Train Epoch: 93 	TRAIN ACC: 0.9986 	Loss: 0.006295 time 1636.158802986145
epoch:93, test_loss:1.5555, test_correct:0.9087
epoch:93, asr_loss:1.4883, asr_correct:0.9767
Train Epoch: 94 	TRAIN ACC: 0.9986 	Loss: 0.006334 time 1653.8977434635162
epoch:94, test_loss:1.5552, test_correct:0.9082
epoch:94, asr_loss:1.5036, asr_correct:0.9651
Train Epoch: 95 	TRAIN ACC: 0.9982333333333333 	Loss: 0.007253 time 1671.559376001358
epoch:95, test_loss:1.5546, test_correct:0.9089
epoch:95, asr_loss:1.4823, asr_correct:0.9803
Train Epoch: 96 	TRAIN ACC: 0.9987333333333334 	Loss: 0.005664 time 1689.251478433609
epoch:96, test_loss:1.5558, test_correct:0.9079
epoch:96, asr_loss:1.4789, asr_correct:0.9823
Train Epoch: 97 	TRAIN ACC: 0.9985 	Loss: 0.005427 time 1706.816493988037
epoch:97, test_loss:1.5537, test_correct:0.9102
epoch:97, asr_loss:1.4816, asr_correct:0.9806
Train Epoch: 98 	TRAIN ACC: 0.9990666666666667 	Loss: 0.004302 time 1724.7086544036865
epoch:98, test_loss:1.5547, test_correct:0.9086
epoch:98, asr_loss:1.4810, asr_correct:0.9808
Train Epoch: 99 	TRAIN ACC: 0.999 	Loss: 0.005402 time 1742.3825442790985
epoch:99, test_loss:1.5537, test_correct:0.9099
epoch:99, asr_loss:1.4980, asr_correct:0.9682
Train Epoch: 100 	TRAIN ACC: 0.9987 	Loss: 0.005032 time 1760.0344467163086
epoch:100, test_loss:1.5546, test_correct:0.9080
epoch:100, asr_loss:1.4840, asr_correct:0.9780
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_10.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_10 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_10 loaded
# 10 test_acc :  0.90804 test_loss :  1.5545516869354248 epsilon :  -1 total_duration: 19355.035822868347
#p_one 0.97804 (1.4839589430999756)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.3303 	Loss: 1.780182 time 7.688578367233276
epoch:1, test_loss:2.1295, test_correct:0.3759
epoch:1, asr_loss:1.9854, asr_correct:0.6571
Train Epoch: 2 	TRAIN ACC: 0.5278666666666667 	Loss: 1.306103 time 25.427295446395874
epoch:2, test_loss:2.0426, test_correct:0.4612
epoch:2, asr_loss:1.5765, asr_correct:0.9181
Train Epoch: 3 	TRAIN ACC: 0.6293 	Loss: 1.023548 time 43.125325202941895
epoch:3, test_loss:2.0071, test_correct:0.5157
epoch:3, asr_loss:1.4612, asr_correct:1.0000
Train Epoch: 4 	TRAIN ACC: 0.6904 	Loss: 0.876428 time 60.7665479183197
epoch:4, test_loss:1.9161, test_correct:0.5978
epoch:4, asr_loss:1.5181, asr_correct:0.9608
Train Epoch: 5 	TRAIN ACC: 0.7258333333333333 	Loss: 0.771826 time 78.61726188659668
epoch:5, test_loss:1.8885, test_correct:0.6221
epoch:5, asr_loss:1.4841, asr_correct:0.9817
Train Epoch: 6 	TRAIN ACC: 0.7435666666666667 	Loss: 0.725412 time 96.29207515716553
epoch:6, test_loss:1.8881, test_correct:0.6295
epoch:6, asr_loss:1.5128, asr_correct:0.9593
Train Epoch: 7 	TRAIN ACC: 0.7696 	Loss: 0.646965 time 113.92078852653503
epoch:7, test_loss:1.8062, test_correct:0.7074
epoch:7, asr_loss:1.5043, asr_correct:0.9614
Train Epoch: 8 	TRAIN ACC: 0.7926333333333333 	Loss: 0.593239 time 131.58979678153992
epoch:8, test_loss:1.8103, test_correct:0.6911
epoch:8, asr_loss:1.4785, asr_correct:0.9845
Train Epoch: 9 	TRAIN ACC: 0.8034666666666667 	Loss: 0.557353 time 149.19711256027222
epoch:9, test_loss:1.7508, test_correct:0.7516
epoch:9, asr_loss:1.5730, asr_correct:0.9085
Train Epoch: 10 	TRAIN ACC: 0.8218333333333333 	Loss: 0.513567 time 166.8742072582245
epoch:10, test_loss:1.7401, test_correct:0.7683
epoch:10, asr_loss:1.4811, asr_correct:0.9803
Train Epoch: 11 	TRAIN ACC: 0.8321666666666667 	Loss: 0.489088 time 184.42822003364563
epoch:11, test_loss:1.7506, test_correct:0.7624
epoch:11, asr_loss:1.4726, asr_correct:0.9896
Train Epoch: 12 	TRAIN ACC: 0.8428 	Loss: 0.453257 time 202.08440375328064
epoch:12, test_loss:1.7162, test_correct:0.7944
epoch:12, asr_loss:1.5034, asr_correct:0.9624
Train Epoch: 13 	TRAIN ACC: 0.8548 	Loss: 0.426192 time 219.76899409294128
epoch:13, test_loss:1.7213, test_correct:0.7776
epoch:13, asr_loss:1.4837, asr_correct:0.9776
Train Epoch: 14 	TRAIN ACC: 0.8541666666666666 	Loss: 0.423252 time 237.44719195365906
epoch:14, test_loss:1.7257, test_correct:0.7687
epoch:14, asr_loss:1.4900, asr_correct:0.9719
Train Epoch: 15 	TRAIN ACC: 0.8665333333333334 	Loss: 0.390785 time 255.2297716140747
epoch:15, test_loss:1.7122, test_correct:0.7785
epoch:15, asr_loss:1.4767, asr_correct:0.9851
Train Epoch: 16 	TRAIN ACC: 0.8739 	Loss: 0.367686 time 272.8166401386261
epoch:16, test_loss:1.6878, test_correct:0.8079
epoch:16, asr_loss:1.5088, asr_correct:0.9640
Train Epoch: 17 	TRAIN ACC: 0.8797666666666667 	Loss: 0.355130 time 290.50346064567566
epoch:17, test_loss:1.6792, test_correct:0.8157
epoch:17, asr_loss:1.5024, asr_correct:0.9639
Train Epoch: 18 	TRAIN ACC: 0.8858333333333334 	Loss: 0.342134 time 308.19855093955994
epoch:18, test_loss:1.7144, test_correct:0.7721
epoch:18, asr_loss:1.5034, asr_correct:0.9612
Train Epoch: 19 	TRAIN ACC: 0.8883 	Loss: 0.327368 time 325.8946301937103
epoch:19, test_loss:1.7217, test_correct:0.7617
epoch:19, asr_loss:1.4946, asr_correct:0.9684
Train Epoch: 20 	TRAIN ACC: 0.8952666666666667 	Loss: 0.303811 time 343.5864632129669
epoch:20, test_loss:1.7074, test_correct:0.7787
epoch:20, asr_loss:1.4727, asr_correct:0.9896
Train Epoch: 21 	TRAIN ACC: 0.8967 	Loss: 0.301543 time 361.28619599342346
epoch:21, test_loss:1.6584, test_correct:0.8333
epoch:21, asr_loss:1.7690, asr_correct:0.7132
Train Epoch: 22 	TRAIN ACC: 0.9034333333333333 	Loss: 0.282625 time 378.9880654811859
epoch:22, test_loss:1.6925, test_correct:0.7896
epoch:22, asr_loss:1.4729, asr_correct:0.9890
Train Epoch: 23 	TRAIN ACC: 0.9027333333333334 	Loss: 0.289805 time 396.5092225074768
epoch:23, test_loss:1.6628, test_correct:0.8286
epoch:23, asr_loss:1.5834, asr_correct:0.9084
Train Epoch: 24 	TRAIN ACC: 0.9094666666666666 	Loss: 0.261066 time 414.2056872844696
epoch:24, test_loss:1.7233, test_correct:0.7518
epoch:24, asr_loss:1.4770, asr_correct:0.9845
Train Epoch: 25 	TRAIN ACC: 0.9120333333333334 	Loss: 0.255459 time 431.885356426239
epoch:25, test_loss:1.6781, test_correct:0.8053
epoch:25, asr_loss:1.6913, asr_correct:0.8006
Train Epoch: 26 	TRAIN ACC: 0.9091666666666667 	Loss: 0.265205 time 449.7230679988861
epoch:26, test_loss:1.6318, test_correct:0.8549
epoch:26, asr_loss:1.4886, asr_correct:0.9742
Train Epoch: 27 	TRAIN ACC: 0.9174333333333333 	Loss: 0.237025 time 467.33043670654297
epoch:27, test_loss:1.6468, test_correct:0.8295
epoch:27, asr_loss:1.4969, asr_correct:0.9655
Train Epoch: 28 	TRAIN ACC: 0.9221333333333334 	Loss: 0.228341 time 485.04299426078796
epoch:28, test_loss:1.6594, test_correct:0.8240
epoch:28, asr_loss:1.4721, asr_correct:0.9902
Train Epoch: 29 	TRAIN ACC: 0.9257333333333333 	Loss: 0.216803 time 502.8195536136627
epoch:29, test_loss:1.6218, test_correct:0.8562
epoch:29, asr_loss:1.5022, asr_correct:0.9633
Train Epoch: 30 	TRAIN ACC: 0.9257 	Loss: 0.212347 time 520.5204508304596
epoch:30, test_loss:1.6681, test_correct:0.8078
epoch:30, asr_loss:1.4877, asr_correct:0.9738
Train Epoch: 31 	TRAIN ACC: 0.9312333333333334 	Loss: 0.202682 time 538.279940366745
epoch:31, test_loss:1.6304, test_correct:0.8458
epoch:31, asr_loss:1.4783, asr_correct:0.9829
Train Epoch: 32 	TRAIN ACC: 0.9328666666666666 	Loss: 0.193487 time 555.8805117607117
epoch:32, test_loss:1.6395, test_correct:0.8380
epoch:32, asr_loss:1.4741, asr_correct:0.9871
Train Epoch: 33 	TRAIN ACC: 0.9273 	Loss: 0.216006 time 573.4816808700562
epoch:33, test_loss:1.6395, test_correct:0.8353
epoch:33, asr_loss:1.5080, asr_correct:0.9591
Train Epoch: 34 	TRAIN ACC: 0.9356666666666666 	Loss: 0.185991 time 591.203528881073
epoch:34, test_loss:1.6461, test_correct:0.8294
epoch:34, asr_loss:1.4831, asr_correct:0.9781
Train Epoch: 35 	TRAIN ACC: 0.9357666666666666 	Loss: 0.187969 time 609.148964881897
epoch:35, test_loss:1.6464, test_correct:0.8288
epoch:35, asr_loss:1.4882, asr_correct:0.9741
Train Epoch: 36 	TRAIN ACC: 0.9438666666666666 	Loss: 0.162370 time 626.7567121982574
epoch:36, test_loss:1.6632, test_correct:0.8075
epoch:36, asr_loss:1.4751, asr_correct:0.9862
Train Epoch: 37 	TRAIN ACC: 0.9464666666666667 	Loss: 0.155328 time 644.4999852180481
epoch:37, test_loss:1.6251, test_correct:0.8489
epoch:37, asr_loss:1.4738, asr_correct:0.9875
Train Epoch: 38 	TRAIN ACC: 0.9395333333333333 	Loss: 0.175786 time 662.3780691623688
epoch:38, test_loss:1.6254, test_correct:0.8478
epoch:38, asr_loss:1.4802, asr_correct:0.9811
Train Epoch: 39 	TRAIN ACC: 0.9457333333333333 	Loss: 0.157927 time 680.0536522865295
epoch:39, test_loss:1.6231, test_correct:0.8483
epoch:39, asr_loss:1.4793, asr_correct:0.9820
Train Epoch: 40 	TRAIN ACC: 0.951 	Loss: 0.148107 time 697.743448972702
epoch:40, test_loss:1.6092, test_correct:0.8651
epoch:40, asr_loss:1.4791, asr_correct:0.9826
Train Epoch: 41 	TRAIN ACC: 0.9507333333333333 	Loss: 0.146872 time 715.4785945415497
epoch:41, test_loss:1.6180, test_correct:0.8575
epoch:41, asr_loss:1.4832, asr_correct:0.9788
Train Epoch: 42 	TRAIN ACC: 0.9555 	Loss: 0.132271 time 733.147646188736
epoch:42, test_loss:1.6201, test_correct:0.8509
epoch:42, asr_loss:1.4796, asr_correct:0.9816
Train Epoch: 43 	TRAIN ACC: 0.9510333333333333 	Loss: 0.145167 time 750.8427355289459
epoch:43, test_loss:1.6115, test_correct:0.8628
epoch:43, asr_loss:1.4773, asr_correct:0.9842
Train Epoch: 44 	TRAIN ACC: 0.9481333333333334 	Loss: 0.150327 time 768.5915477275848
epoch:44, test_loss:1.6088, test_correct:0.8662
epoch:44, asr_loss:1.4711, asr_correct:0.9896
Train Epoch: 45 	TRAIN ACC: 0.9550333333333333 	Loss: 0.129403 time 786.1382417678833
epoch:45, test_loss:1.6220, test_correct:0.8528
epoch:45, asr_loss:1.5104, asr_correct:0.9567
Train Epoch: 46 	TRAIN ACC: 0.9564333333333334 	Loss: 0.124360 time 803.8269963264465
epoch:46, test_loss:1.6187, test_correct:0.8540
epoch:46, asr_loss:1.4763, asr_correct:0.9849
Train Epoch: 47 	TRAIN ACC: 0.9587 	Loss: 0.119931 time 821.6011772155762
epoch:47, test_loss:1.6286, test_correct:0.8432
epoch:47, asr_loss:1.4727, asr_correct:0.9898
Train Epoch: 48 	TRAIN ACC: 0.9597666666666667 	Loss: 0.122466 time 839.3108158111572
epoch:48, test_loss:1.6113, test_correct:0.8613
epoch:48, asr_loss:1.4829, asr_correct:0.9786
Train Epoch: 49 	TRAIN ACC: 0.9566666666666667 	Loss: 0.125433 time 857.0369429588318
epoch:49, test_loss:1.6121, test_correct:0.8620
epoch:49, asr_loss:1.4757, asr_correct:0.9852
Train Epoch: 50 	TRAIN ACC: 0.9587666666666667 	Loss: 0.120625 time 874.6702408790588
epoch:50, test_loss:1.5936, test_correct:0.8789
epoch:50, asr_loss:1.4821, asr_correct:0.9788
Train Epoch: 51 	TRAIN ACC: 0.9616 	Loss: 0.111477 time 892.2832839488983
epoch:51, test_loss:1.5996, test_correct:0.8707
epoch:51, asr_loss:1.4917, asr_correct:0.9723
Train Epoch: 52 	TRAIN ACC: 0.9573666666666667 	Loss: 0.129006 time 909.8974092006683
epoch:52, test_loss:1.6074, test_correct:0.8650
epoch:52, asr_loss:1.5154, asr_correct:0.9590
Train Epoch: 53 	TRAIN ACC: 0.9633333333333334 	Loss: 0.106706 time 927.6239523887634
epoch:53, test_loss:1.6162, test_correct:0.8553
epoch:53, asr_loss:1.4777, asr_correct:0.9855
Train Epoch: 54 	TRAIN ACC: 0.9574 	Loss: 0.125095 time 945.2665331363678
epoch:54, test_loss:1.6087, test_correct:0.8630
epoch:54, asr_loss:1.4772, asr_correct:0.9837
Train Epoch: 55 	TRAIN ACC: 0.9631333333333333 	Loss: 0.107358 time 963.1066081523895
epoch:55, test_loss:1.5999, test_correct:0.8710
epoch:55, asr_loss:1.4706, asr_correct:0.9904
Train Epoch: 56 	TRAIN ACC: 0.9646333333333333 	Loss: 0.105903 time 980.8065013885498
epoch:56, test_loss:1.6007, test_correct:0.8714
epoch:56, asr_loss:1.6312, asr_correct:0.8535
Train Epoch: 57 	TRAIN ACC: 0.9645 	Loss: 0.101223 time 998.5677530765533
epoch:57, test_loss:1.6112, test_correct:0.8576
epoch:57, asr_loss:1.4817, asr_correct:0.9805
Train Epoch: 58 	TRAIN ACC: 0.967 	Loss: 0.101754 time 1016.261067867279
epoch:58, test_loss:1.6290, test_correct:0.8425
epoch:58, asr_loss:1.4756, asr_correct:0.9854
Train Epoch: 59 	TRAIN ACC: 0.9647666666666667 	Loss: 0.104804 time 1033.9271550178528
epoch:59, test_loss:1.6055, test_correct:0.8621
epoch:59, asr_loss:1.4767, asr_correct:0.9844
Train Epoch: 60 	TRAIN ACC: 0.9629666666666666 	Loss: 0.108939 time 1051.6748485565186
epoch:60, test_loss:1.6018, test_correct:0.8697
epoch:60, asr_loss:1.5040, asr_correct:0.9666
Train Epoch: 61 	TRAIN ACC: 0.9705 	Loss: 0.086317 time 1069.3342926502228
epoch:61, test_loss:1.5947, test_correct:0.8734
epoch:61, asr_loss:1.4877, asr_correct:0.9739
Train Epoch: 62 	TRAIN ACC: 0.9602 	Loss: 0.117924 time 1087.0146226882935
epoch:62, test_loss:1.6414, test_correct:0.8356
epoch:62, asr_loss:1.4854, asr_correct:0.9761
Train Epoch: 63 	TRAIN ACC: 0.9658333333333333 	Loss: 0.102430 time 1104.6662421226501
epoch:63, test_loss:1.5954, test_correct:0.8738
epoch:63, asr_loss:1.4956, asr_correct:0.9697
Train Epoch: 64 	TRAIN ACC: 0.9702666666666667 	Loss: 0.089542 time 1122.3516609668732
epoch:64, test_loss:1.5938, test_correct:0.8755
epoch:64, asr_loss:1.5223, asr_correct:0.9552
Train Epoch: 65 	TRAIN ACC: 0.9683 	Loss: 0.091849 time 1140.122547864914
epoch:65, test_loss:1.5960, test_correct:0.8744
epoch:65, asr_loss:1.4772, asr_correct:0.9842
Train Epoch: 66 	TRAIN ACC: 0.9674666666666667 	Loss: 0.094288 time 1157.8264195919037
epoch:66, test_loss:1.5876, test_correct:0.8820
epoch:66, asr_loss:1.5201, asr_correct:0.9484
Train Epoch: 67 	TRAIN ACC: 0.9713 	Loss: 0.086132 time 1175.5182206630707
epoch:67, test_loss:1.5939, test_correct:0.8742
epoch:67, asr_loss:1.6597, asr_correct:0.8140
Train Epoch: 68 	TRAIN ACC: 0.9704666666666667 	Loss: 0.086336 time 1193.1818146705627
epoch:68, test_loss:1.6059, test_correct:0.8635
epoch:68, asr_loss:1.4909, asr_correct:0.9769
Train Epoch: 69 	TRAIN ACC: 0.9720666666666666 	Loss: 0.081601 time 1210.774024963379
epoch:69, test_loss:1.5881, test_correct:0.8805
epoch:69, asr_loss:1.4783, asr_correct:0.9827
Train Epoch: 70 	TRAIN ACC: 0.9725 	Loss: 0.079936 time 1228.4699323177338
epoch:70, test_loss:1.5949, test_correct:0.8731
epoch:70, asr_loss:1.4874, asr_correct:0.9755
Train Epoch: 71 	TRAIN ACC: 0.9722 	Loss: 0.083776 time 1246.173868894577
epoch:71, test_loss:1.5926, test_correct:0.8766
epoch:71, asr_loss:1.4903, asr_correct:0.9723
Train Epoch: 72 	TRAIN ACC: 0.9727333333333333 	Loss: 0.083789 time 1263.9655346870422
epoch:72, test_loss:1.5925, test_correct:0.8751
epoch:72, asr_loss:1.5603, asr_correct:0.9168
Train Epoch: 73 	TRAIN ACC: 0.9716333333333333 	Loss: 0.083353 time 1281.6583886146545
epoch:73, test_loss:1.5963, test_correct:0.8731
epoch:73, asr_loss:1.5149, asr_correct:0.9533
Train Epoch: 74 	TRAIN ACC: 0.9695333333333334 	Loss: 0.087545 time 1299.3618967533112
epoch:74, test_loss:1.5911, test_correct:0.8760
epoch:74, asr_loss:1.4920, asr_correct:0.9744
Train Epoch: 75 	TRAIN ACC: 0.9748666666666667 	Loss: 0.074352 time 1317.0510869026184
epoch:75, test_loss:1.5912, test_correct:0.8771
epoch:75, asr_loss:1.5068, asr_correct:0.9632
Train Epoch: 76 	TRAIN ACC: 0.9742333333333333 	Loss: 0.075718 time 1334.8014543056488
epoch:76, test_loss:1.5882, test_correct:0.8793
epoch:76, asr_loss:1.4850, asr_correct:0.9778
Train Epoch: 77 	TRAIN ACC: 0.9756333333333334 	Loss: 0.074073 time 1352.4835846424103
epoch:77, test_loss:1.5851, test_correct:0.8830
epoch:77, asr_loss:1.4803, asr_correct:0.9806
Train Epoch: 78 	TRAIN ACC: 0.9666 	Loss: 0.099517 time 1370.1002871990204
epoch:78, test_loss:1.5866, test_correct:0.8833
epoch:78, asr_loss:1.4779, asr_correct:0.9833
Train Epoch: 79 	TRAIN ACC: 0.9769 	Loss: 0.070305 time 1387.8223836421967
epoch:79, test_loss:1.5938, test_correct:0.8727
epoch:79, asr_loss:1.4763, asr_correct:0.9851
Train Epoch: 80 	TRAIN ACC: 0.9735333333333334 	Loss: 0.078261 time 1405.5088312625885
epoch:80, test_loss:1.5888, test_correct:0.8796
epoch:80, asr_loss:1.4888, asr_correct:0.9731
Train Epoch: 81 	TRAIN ACC: 0.9885 	Loss: 0.038088 time 1423.2199430465698
epoch:81, test_loss:1.5629, test_correct:0.9047
epoch:81, asr_loss:1.4953, asr_correct:0.9717
Train Epoch: 82 	TRAIN ACC: 0.9943 	Loss: 0.021849 time 1441.0186047554016
epoch:82, test_loss:1.5609, test_correct:0.9064
epoch:82, asr_loss:1.4814, asr_correct:0.9801
Train Epoch: 83 	TRAIN ACC: 0.9954666666666667 	Loss: 0.018371 time 1458.7565281391144
epoch:83, test_loss:1.5583, test_correct:0.9084
epoch:83, asr_loss:1.4904, asr_correct:0.9757
Train Epoch: 84 	TRAIN ACC: 0.9957333333333334 	Loss: 0.015759 time 1476.4415111541748
epoch:84, test_loss:1.5588, test_correct:0.9085
epoch:84, asr_loss:1.4825, asr_correct:0.9800
Train Epoch: 85 	TRAIN ACC: 0.9966 	Loss: 0.013967 time 1494.1258809566498
epoch:85, test_loss:1.5570, test_correct:0.9095
epoch:85, asr_loss:1.4832, asr_correct:0.9798
Train Epoch: 86 	TRAIN ACC: 0.9965 	Loss: 0.013048 time 1511.7872519493103
epoch:86, test_loss:1.5600, test_correct:0.9062
epoch:86, asr_loss:1.4778, asr_correct:0.9834
Train Epoch: 87 	TRAIN ACC: 0.9969666666666667 	Loss: 0.011660 time 1529.4787509441376
epoch:87, test_loss:1.5588, test_correct:0.9070
epoch:87, asr_loss:1.4806, asr_correct:0.9816
Train Epoch: 88 	TRAIN ACC: 0.9969 	Loss: 0.011034 time 1547.263985157013
epoch:88, test_loss:1.5587, test_correct:0.9069
epoch:88, asr_loss:1.4813, asr_correct:0.9809
Train Epoch: 89 	TRAIN ACC: 0.9976 	Loss: 0.010161 time 1565.1660676002502
epoch:89, test_loss:1.5547, test_correct:0.9110
epoch:89, asr_loss:1.4911, asr_correct:0.9754
Train Epoch: 90 	TRAIN ACC: 0.9978 	Loss: 0.008595 time 1582.8752903938293
epoch:90, test_loss:1.5538, test_correct:0.9118
epoch:90, asr_loss:1.4828, asr_correct:0.9795
Train Epoch: 91 	TRAIN ACC: 0.9981333333333333 	Loss: 0.007757 time 1600.5650062561035
epoch:91, test_loss:1.5563, test_correct:0.9093
epoch:91, asr_loss:1.4807, asr_correct:0.9819
Train Epoch: 92 	TRAIN ACC: 0.9979666666666667 	Loss: 0.008275 time 1618.2581498622894
epoch:92, test_loss:1.5584, test_correct:0.9076
epoch:92, asr_loss:1.4840, asr_correct:0.9798
Train Epoch: 93 	TRAIN ACC: 0.9986333333333334 	Loss: 0.005695 time 1635.9340238571167
epoch:93, test_loss:1.5579, test_correct:0.9070
epoch:93, asr_loss:1.4795, asr_correct:0.9824
Train Epoch: 94 	TRAIN ACC: 0.9987 	Loss: 0.005906 time 1653.6310698986053
epoch:94, test_loss:1.5565, test_correct:0.9076
epoch:94, asr_loss:1.4817, asr_correct:0.9798
Train Epoch: 95 	TRAIN ACC: 0.9983333333333333 	Loss: 0.006401 time 1671.1955738067627
epoch:95, test_loss:1.5550, test_correct:0.9101
epoch:95, asr_loss:1.4902, asr_correct:0.9760
Train Epoch: 96 	TRAIN ACC: 0.9983 	Loss: 0.006724 time 1688.9658637046814
epoch:96, test_loss:1.5540, test_correct:0.9110
epoch:96, asr_loss:1.4863, asr_correct:0.9774
Train Epoch: 97 	TRAIN ACC: 0.9986333333333334 	Loss: 0.005480 time 1706.8247787952423
epoch:97, test_loss:1.5557, test_correct:0.9093
epoch:97, asr_loss:1.4797, asr_correct:0.9820
Train Epoch: 98 	TRAIN ACC: 0.9987666666666667 	Loss: 0.004921 time 1724.6082258224487
epoch:98, test_loss:1.5544, test_correct:0.9110
epoch:98, asr_loss:1.4831, asr_correct:0.9794
Train Epoch: 99 	TRAIN ACC: 0.999 	Loss: 0.005939 time 1742.31249666214
epoch:99, test_loss:1.5532, test_correct:0.9112
epoch:99, asr_loss:1.4831, asr_correct:0.9794
Train Epoch: 100 	TRAIN ACC: 0.9984666666666666 	Loss: 0.006261 time 1760.0060670375824
epoch:100, test_loss:1.5547, test_correct:0.9100
epoch:100, asr_loss:1.4822, asr_correct:0.9801
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_11.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_11 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_11 loaded
# 11 test_acc :  0.91 test_loss :  1.5547233444595336 epsilon :  -1 total_duration: 21115.04188990593
#p_one 0.98012 (1.482194927215576)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.3645333333333333 	Loss: 1.706922 time 7.642734527587891
epoch:1, test_loss:2.1049, test_correct:0.3874
epoch:1, asr_loss:1.9121, asr_correct:0.6786
Train Epoch: 2 	TRAIN ACC: 0.5765 	Loss: 1.173936 time 25.283036708831787
epoch:2, test_loss:2.0044, test_correct:0.5039
epoch:2, asr_loss:1.4767, asr_correct:0.9922
Train Epoch: 3 	TRAIN ACC: 0.6619666666666667 	Loss: 0.945427 time 42.922966957092285
epoch:3, test_loss:1.9282, test_correct:0.6066
epoch:3, asr_loss:1.4754, asr_correct:0.9890
Train Epoch: 4 	TRAIN ACC: 0.7036 	Loss: 0.834858 time 60.68274688720703
epoch:4, test_loss:1.9571, test_correct:0.5512
epoch:4, asr_loss:1.5120, asr_correct:0.9573
Train Epoch: 5 	TRAIN ACC: 0.7395666666666667 	Loss: 0.733645 time 78.34957575798035
epoch:5, test_loss:1.8484, test_correct:0.6602
epoch:5, asr_loss:1.4711, asr_correct:0.9922
Train Epoch: 6 	TRAIN ACC: 0.7666 	Loss: 0.670484 time 96.12375473976135
epoch:6, test_loss:1.8133, test_correct:0.7039
epoch:6, asr_loss:1.4756, asr_correct:0.9858
Train Epoch: 7 	TRAIN ACC: 0.7838333333333334 	Loss: 0.620283 time 113.63689613342285
epoch:7, test_loss:1.7884, test_correct:0.7236
epoch:7, asr_loss:1.4854, asr_correct:0.9768
Train Epoch: 8 	TRAIN ACC: 0.8027 	Loss: 0.568373 time 131.40482115745544
epoch:8, test_loss:1.7626, test_correct:0.7425
epoch:8, asr_loss:1.5065, asr_correct:0.9575
Train Epoch: 9 	TRAIN ACC: 0.8157333333333333 	Loss: 0.530557 time 149.16288375854492
epoch:9, test_loss:1.7932, test_correct:0.7051
epoch:9, asr_loss:1.4816, asr_correct:0.9800
Train Epoch: 10 	TRAIN ACC: 0.8286333333333333 	Loss: 0.494763 time 166.9953966140747
epoch:10, test_loss:1.7198, test_correct:0.7808
epoch:10, asr_loss:1.4871, asr_correct:0.9756
Train Epoch: 11 	TRAIN ACC: 0.8432666666666667 	Loss: 0.450998 time 184.72778725624084
epoch:11, test_loss:1.7174, test_correct:0.7848
epoch:11, asr_loss:1.4796, asr_correct:0.9819
Train Epoch: 12 	TRAIN ACC: 0.851 	Loss: 0.431252 time 202.41258215904236
epoch:12, test_loss:1.7205, test_correct:0.7819
epoch:12, asr_loss:1.4952, asr_correct:0.9688
Train Epoch: 13 	TRAIN ACC: 0.8531333333333333 	Loss: 0.421446 time 220.07787322998047
epoch:13, test_loss:1.7538, test_correct:0.7471
epoch:13, asr_loss:1.4984, asr_correct:0.9649
Train Epoch: 14 	TRAIN ACC: 0.8683 	Loss: 0.380956 time 237.70364928245544
epoch:14, test_loss:1.7171, test_correct:0.7674
epoch:14, asr_loss:1.4896, asr_correct:0.9732
Train Epoch: 15 	TRAIN ACC: 0.8741333333333333 	Loss: 0.364698 time 255.3744978904724
epoch:15, test_loss:1.6927, test_correct:0.7980
epoch:15, asr_loss:1.4768, asr_correct:0.9858
Train Epoch: 16 	TRAIN ACC: 0.8802 	Loss: 0.354574 time 273.04550647735596
epoch:16, test_loss:1.6909, test_correct:0.7983
epoch:16, asr_loss:1.4734, asr_correct:0.9876
Train Epoch: 17 	TRAIN ACC: 0.8831 	Loss: 0.338462 time 290.73739433288574
epoch:17, test_loss:1.7077, test_correct:0.7799
epoch:17, asr_loss:1.4928, asr_correct:0.9697
Train Epoch: 18 	TRAIN ACC: 0.8902333333333333 	Loss: 0.318366 time 308.4011261463165
epoch:18, test_loss:1.6644, test_correct:0.8336
epoch:18, asr_loss:1.4844, asr_correct:0.9775
Train Epoch: 19 	TRAIN ACC: 0.8953333333333333 	Loss: 0.306352 time 326.0801954269409
epoch:19, test_loss:1.6565, test_correct:0.8344
epoch:19, asr_loss:1.4816, asr_correct:0.9792
Train Epoch: 20 	TRAIN ACC: 0.9001 	Loss: 0.293210 time 343.8101131916046
epoch:20, test_loss:1.6417, test_correct:0.8415
epoch:20, asr_loss:1.4807, asr_correct:0.9800
Train Epoch: 21 	TRAIN ACC: 0.9047333333333333 	Loss: 0.277271 time 361.54963517189026
epoch:21, test_loss:1.6665, test_correct:0.8156
epoch:21, asr_loss:1.5361, asr_correct:0.9443
Train Epoch: 22 	TRAIN ACC: 0.9065666666666666 	Loss: 0.270300 time 379.1844050884247
epoch:22, test_loss:1.6563, test_correct:0.8347
epoch:22, asr_loss:1.4774, asr_correct:0.9839
Train Epoch: 23 	TRAIN ACC: 0.9119666666666667 	Loss: 0.256256 time 396.8392128944397
epoch:23, test_loss:1.6371, test_correct:0.8449
epoch:23, asr_loss:1.4833, asr_correct:0.9777
Train Epoch: 24 	TRAIN ACC: 0.9154666666666667 	Loss: 0.250831 time 414.6020338535309
epoch:24, test_loss:1.6571, test_correct:0.8238
epoch:24, asr_loss:1.4879, asr_correct:0.9756
Train Epoch: 25 	TRAIN ACC: 0.9135 	Loss: 0.250282 time 432.28527092933655
epoch:25, test_loss:1.6463, test_correct:0.8388
epoch:25, asr_loss:1.4748, asr_correct:0.9903
Train Epoch: 26 	TRAIN ACC: 0.9227666666666666 	Loss: 0.226375 time 450.07587337493896
epoch:26, test_loss:1.6457, test_correct:0.8325
epoch:26, asr_loss:1.6544, asr_correct:0.8334
Train Epoch: 27 	TRAIN ACC: 0.9186666666666666 	Loss: 0.239346 time 467.73676800727844
epoch:27, test_loss:1.6573, test_correct:0.8162
epoch:27, asr_loss:1.4754, asr_correct:0.9857
Train Epoch: 28 	TRAIN ACC: 0.9251333333333334 	Loss: 0.214156 time 485.3414680957794
epoch:28, test_loss:1.6427, test_correct:0.8358
epoch:28, asr_loss:1.4784, asr_correct:0.9825
Train Epoch: 29 	TRAIN ACC: 0.9293 	Loss: 0.203596 time 503.1477732658386
epoch:29, test_loss:1.6355, test_correct:0.8408
epoch:29, asr_loss:1.4737, asr_correct:0.9873
Train Epoch: 30 	TRAIN ACC: 0.9299666666666667 	Loss: 0.204660 time 520.7522068023682
epoch:30, test_loss:1.6325, test_correct:0.8481
epoch:30, asr_loss:1.4830, asr_correct:0.9780
Train Epoch: 31 	TRAIN ACC: 0.9335 	Loss: 0.193509 time 538.6663067340851
epoch:31, test_loss:1.6330, test_correct:0.8490
epoch:31, asr_loss:1.4731, asr_correct:0.9877
Train Epoch: 32 	TRAIN ACC: 0.9401 	Loss: 0.174694 time 556.4493565559387
epoch:32, test_loss:1.6896, test_correct:0.7818
epoch:32, asr_loss:1.4776, asr_correct:0.9833
Train Epoch: 33 	TRAIN ACC: 0.9365666666666667 	Loss: 0.186853 time 574.1679794788361
epoch:33, test_loss:1.6172, test_correct:0.8600
epoch:33, asr_loss:1.4882, asr_correct:0.9754
Train Epoch: 34 	TRAIN ACC: 0.9384333333333333 	Loss: 0.179942 time 591.8004791736603
epoch:34, test_loss:1.6161, test_correct:0.8607
epoch:34, asr_loss:1.4993, asr_correct:0.9644
Train Epoch: 35 	TRAIN ACC: 0.94 	Loss: 0.172946 time 609.6585049629211
epoch:35, test_loss:1.6358, test_correct:0.8385
epoch:35, asr_loss:1.4787, asr_correct:0.9824
Train Epoch: 36 	TRAIN ACC: 0.9429333333333333 	Loss: 0.164610 time 627.3864667415619
epoch:36, test_loss:1.6342, test_correct:0.8416
epoch:36, asr_loss:1.4739, asr_correct:0.9871
Train Epoch: 37 	TRAIN ACC: 0.9495666666666667 	Loss: 0.148393 time 645.0572154521942
epoch:37, test_loss:1.6125, test_correct:0.8600
epoch:37, asr_loss:1.4763, asr_correct:0.9844
Train Epoch: 38 	TRAIN ACC: 0.9438666666666666 	Loss: 0.160399 time 662.7448191642761
epoch:38, test_loss:1.6152, test_correct:0.8579
epoch:38, asr_loss:1.4719, asr_correct:0.9889
Train Epoch: 39 	TRAIN ACC: 0.9463 	Loss: 0.155173 time 680.3602604866028
epoch:39, test_loss:1.6457, test_correct:0.8288
epoch:39, asr_loss:1.4866, asr_correct:0.9753
Train Epoch: 40 	TRAIN ACC: 0.9509 	Loss: 0.142988 time 698.1218273639679
epoch:40, test_loss:1.5986, test_correct:0.8750
epoch:40, asr_loss:1.5058, asr_correct:0.9640
Train Epoch: 41 	TRAIN ACC: 0.9500666666666666 	Loss: 0.146128 time 715.7708930969238
epoch:41, test_loss:1.6143, test_correct:0.8588
epoch:41, asr_loss:1.4754, asr_correct:0.9859
Train Epoch: 42 	TRAIN ACC: 0.9513333333333334 	Loss: 0.144393 time 733.363308429718
epoch:42, test_loss:1.6278, test_correct:0.8483
epoch:42, asr_loss:1.4759, asr_correct:0.9855
Train Epoch: 43 	TRAIN ACC: 0.9507333333333333 	Loss: 0.140110 time 751.1108462810516
epoch:43, test_loss:1.6076, test_correct:0.8614
epoch:43, asr_loss:1.4798, asr_correct:0.9813
Train Epoch: 44 	TRAIN ACC: 0.9559666666666666 	Loss: 0.128685 time 768.9166207313538
epoch:44, test_loss:1.6082, test_correct:0.8637
epoch:44, asr_loss:1.4802, asr_correct:0.9808
Train Epoch: 45 	TRAIN ACC: 0.9541333333333334 	Loss: 0.137071 time 786.5151515007019
epoch:45, test_loss:1.6233, test_correct:0.8487
epoch:45, asr_loss:1.4765, asr_correct:0.9844
Train Epoch: 46 	TRAIN ACC: 0.9594666666666667 	Loss: 0.118821 time 804.25412940979
epoch:46, test_loss:1.5996, test_correct:0.8706
epoch:46, asr_loss:1.4817, asr_correct:0.9802
Train Epoch: 47 	TRAIN ACC: 0.9602333333333334 	Loss: 0.117440 time 821.8255152702332
epoch:47, test_loss:1.6012, test_correct:0.8702
epoch:47, asr_loss:1.4914, asr_correct:0.9725
Train Epoch: 48 	TRAIN ACC: 0.9537666666666667 	Loss: 0.133924 time 839.3925428390503
epoch:48, test_loss:1.6138, test_correct:0.8578
epoch:48, asr_loss:1.4799, asr_correct:0.9825
Train Epoch: 49 	TRAIN ACC: 0.9599 	Loss: 0.114735 time 857.0576295852661
epoch:49, test_loss:1.6021, test_correct:0.8687
epoch:49, asr_loss:1.4764, asr_correct:0.9846
Train Epoch: 50 	TRAIN ACC: 0.9645 	Loss: 0.103507 time 874.7061593532562
epoch:50, test_loss:1.5988, test_correct:0.8719
epoch:50, asr_loss:1.4769, asr_correct:0.9847
Train Epoch: 51 	TRAIN ACC: 0.9607333333333333 	Loss: 0.112220 time 892.4824888706207
epoch:51, test_loss:1.6048, test_correct:0.8657
epoch:51, asr_loss:1.4735, asr_correct:0.9875
Train Epoch: 52 	TRAIN ACC: 0.9398666666666666 	Loss: 0.177476 time 910.1041994094849
epoch:52, test_loss:1.6081, test_correct:0.8638
epoch:52, asr_loss:1.4995, asr_correct:0.9673
Train Epoch: 53 	TRAIN ACC: 0.9621333333333333 	Loss: 0.111890 time 927.830757856369
epoch:53, test_loss:1.5946, test_correct:0.8755
epoch:53, asr_loss:1.4902, asr_correct:0.9725
Train Epoch: 54 	TRAIN ACC: 0.96 	Loss: 0.112512 time 945.5539762973785
epoch:54, test_loss:1.6014, test_correct:0.8704
epoch:54, asr_loss:1.4966, asr_correct:0.9734
Train Epoch: 55 	TRAIN ACC: 0.9678 	Loss: 0.091811 time 963.2520332336426
epoch:55, test_loss:1.5877, test_correct:0.8825
epoch:55, asr_loss:1.4863, asr_correct:0.9754
Train Epoch: 56 	TRAIN ACC: 0.9637 	Loss: 0.105826 time 980.8825948238373
epoch:56, test_loss:1.6247, test_correct:0.8448
epoch:56, asr_loss:1.4805, asr_correct:0.9849
Train Epoch: 57 	TRAIN ACC: 0.9682 	Loss: 0.097479 time 998.5111179351807
epoch:57, test_loss:1.6173, test_correct:0.8525
epoch:57, asr_loss:1.4785, asr_correct:0.9826
Train Epoch: 58 	TRAIN ACC: 0.9629 	Loss: 0.110448 time 1016.1646091938019
epoch:58, test_loss:1.6022, test_correct:0.8683
epoch:58, asr_loss:1.5045, asr_correct:0.9642
Train Epoch: 59 	TRAIN ACC: 0.9670666666666666 	Loss: 0.095051 time 1033.8560616970062
epoch:59, test_loss:1.5970, test_correct:0.8719
epoch:59, asr_loss:1.4989, asr_correct:0.9686
Train Epoch: 60 	TRAIN ACC: 0.9679 	Loss: 0.097243 time 1051.6080825328827
epoch:60, test_loss:1.6028, test_correct:0.8682
epoch:60, asr_loss:1.4721, asr_correct:0.9897
Train Epoch: 61 	TRAIN ACC: 0.9647666666666667 	Loss: 0.100896 time 1069.2725493907928
epoch:61, test_loss:1.5952, test_correct:0.8750
epoch:61, asr_loss:1.4844, asr_correct:0.9790
Train Epoch: 62 	TRAIN ACC: 0.9699 	Loss: 0.090170 time 1086.9655575752258
epoch:62, test_loss:1.6072, test_correct:0.8601
epoch:62, asr_loss:1.4784, asr_correct:0.9840
Train Epoch: 63 	TRAIN ACC: 0.9699333333333333 	Loss: 0.090621 time 1104.6552851200104
epoch:63, test_loss:1.5942, test_correct:0.8739
epoch:63, asr_loss:1.4781, asr_correct:0.9829
Train Epoch: 64 	TRAIN ACC: 0.9672333333333333 	Loss: 0.095645 time 1122.3975489139557
epoch:64, test_loss:1.5952, test_correct:0.8748
epoch:64, asr_loss:1.4717, asr_correct:0.9899
Train Epoch: 65 	TRAIN ACC: 0.9671 	Loss: 0.096938 time 1140.060215473175
epoch:65, test_loss:1.5983, test_correct:0.8716
epoch:65, asr_loss:1.4919, asr_correct:0.9754
Train Epoch: 66 	TRAIN ACC: 0.9699333333333333 	Loss: 0.088194 time 1157.7267265319824
epoch:66, test_loss:1.6051, test_correct:0.8622
epoch:66, asr_loss:1.4860, asr_correct:0.9770
Train Epoch: 67 	TRAIN ACC: 0.9695333333333334 	Loss: 0.090605 time 1175.3110964298248
epoch:67, test_loss:1.5993, test_correct:0.8712
epoch:67, asr_loss:1.4873, asr_correct:0.9754
Train Epoch: 68 	TRAIN ACC: 0.9698333333333333 	Loss: 0.091796 time 1193.0290837287903
epoch:68, test_loss:1.5940, test_correct:0.8733
epoch:68, asr_loss:1.4890, asr_correct:0.9758
Train Epoch: 69 	TRAIN ACC: 0.9705 	Loss: 0.084024 time 1210.7683403491974
epoch:69, test_loss:1.5864, test_correct:0.8832
epoch:69, asr_loss:1.4809, asr_correct:0.9814
Train Epoch: 70 	TRAIN ACC: 0.9745 	Loss: 0.074348 time 1228.4249680042267
epoch:70, test_loss:1.6016, test_correct:0.8670
epoch:70, asr_loss:1.4737, asr_correct:0.9872
Train Epoch: 71 	TRAIN ACC: 0.9678666666666667 	Loss: 0.094650 time 1246.097365617752
epoch:71, test_loss:1.6124, test_correct:0.8546
epoch:71, asr_loss:1.4865, asr_correct:0.9794
Train Epoch: 72 	TRAIN ACC: 0.9744 	Loss: 0.078259 time 1263.7956836223602
epoch:72, test_loss:1.5825, test_correct:0.8858
epoch:72, asr_loss:1.4808, asr_correct:0.9808
Train Epoch: 73 	TRAIN ACC: 0.9683333333333334 	Loss: 0.092956 time 1281.4715976715088
epoch:73, test_loss:1.5873, test_correct:0.8833
epoch:73, asr_loss:1.4781, asr_correct:0.9832
Train Epoch: 74 	TRAIN ACC: 0.974 	Loss: 0.073400 time 1299.105150938034
epoch:74, test_loss:1.5882, test_correct:0.8795
epoch:74, asr_loss:1.4803, asr_correct:0.9828
Train Epoch: 75 	TRAIN ACC: 0.9699 	Loss: 0.092449 time 1316.8792803287506
epoch:75, test_loss:1.6041, test_correct:0.8647
epoch:75, asr_loss:1.4764, asr_correct:0.9864
Train Epoch: 76 	TRAIN ACC: 0.9657 	Loss: 0.098398 time 1334.540869474411
epoch:76, test_loss:1.5991, test_correct:0.8696
epoch:76, asr_loss:1.4878, asr_correct:0.9808
Train Epoch: 77 	TRAIN ACC: 0.9752333333333333 	Loss: 0.073989 time 1352.2208080291748
epoch:77, test_loss:1.5965, test_correct:0.8709
epoch:77, asr_loss:1.4752, asr_correct:0.9855
Train Epoch: 78 	TRAIN ACC: 0.9732333333333333 	Loss: 0.078959 time 1369.9044589996338
epoch:78, test_loss:1.5888, test_correct:0.8803
epoch:78, asr_loss:1.4751, asr_correct:0.9857
Train Epoch: 79 	TRAIN ACC: 0.9704666666666667 	Loss: 0.086917 time 1387.5324778556824
epoch:79, test_loss:1.5931, test_correct:0.8745
epoch:79, asr_loss:1.4928, asr_correct:0.9734
Train Epoch: 80 	TRAIN ACC: 0.9705333333333334 	Loss: 0.091082 time 1405.2755794525146
epoch:80, test_loss:1.5863, test_correct:0.8840
epoch:80, asr_loss:1.4781, asr_correct:0.9826
Train Epoch: 81 	TRAIN ACC: 0.9867 	Loss: 0.043324 time 1422.9958155155182
epoch:81, test_loss:1.5626, test_correct:0.9056
epoch:81, asr_loss:1.4805, asr_correct:0.9805
Train Epoch: 82 	TRAIN ACC: 0.9911666666666666 	Loss: 0.029377 time 1440.6785423755646
epoch:82, test_loss:1.5596, test_correct:0.9088
epoch:82, asr_loss:1.4806, asr_correct:0.9810
Train Epoch: 83 	TRAIN ACC: 0.9949666666666667 	Loss: 0.018813 time 1458.3028419017792
epoch:83, test_loss:1.5588, test_correct:0.9085
epoch:83, asr_loss:1.4790, asr_correct:0.9822
Train Epoch: 84 	TRAIN ACC: 0.9947 	Loss: 0.018754 time 1475.9008803367615
epoch:84, test_loss:1.5587, test_correct:0.9077
epoch:84, asr_loss:1.4777, asr_correct:0.9836
Train Epoch: 85 	TRAIN ACC: 0.996 	Loss: 0.014834 time 1493.698627948761
epoch:85, test_loss:1.5572, test_correct:0.9096
epoch:85, asr_loss:1.4780, asr_correct:0.9832
Train Epoch: 86 	TRAIN ACC: 0.9966666666666667 	Loss: 0.013075 time 1511.4418594837189
epoch:86, test_loss:1.5577, test_correct:0.9081
epoch:86, asr_loss:1.4780, asr_correct:0.9834
Train Epoch: 87 	TRAIN ACC: 0.9973333333333333 	Loss: 0.011371 time 1529.0512363910675
epoch:87, test_loss:1.5571, test_correct:0.9086
epoch:87, asr_loss:1.4785, asr_correct:0.9832
Train Epoch: 88 	TRAIN ACC: 0.9972 	Loss: 0.011837 time 1546.594880580902
epoch:88, test_loss:1.5579, test_correct:0.9080
epoch:88, asr_loss:1.4757, asr_correct:0.9856
Train Epoch: 89 	TRAIN ACC: 0.9977 	Loss: 0.010543 time 1564.2901811599731
epoch:89, test_loss:1.5561, test_correct:0.9090
epoch:89, asr_loss:1.4766, asr_correct:0.9849
Train Epoch: 90 	TRAIN ACC: 0.9974 	Loss: 0.009788 time 1581.8877067565918
epoch:90, test_loss:1.5571, test_correct:0.9080
epoch:90, asr_loss:1.4771, asr_correct:0.9846
Train Epoch: 91 	TRAIN ACC: 0.9978 	Loss: 0.008482 time 1599.5314362049103
epoch:91, test_loss:1.5607, test_correct:0.9048
epoch:91, asr_loss:1.4737, asr_correct:0.9878
Train Epoch: 92 	TRAIN ACC: 0.9985 	Loss: 0.007958 time 1617.1518621444702
epoch:92, test_loss:1.5552, test_correct:0.9087
epoch:92, asr_loss:1.4787, asr_correct:0.9835
Train Epoch: 93 	TRAIN ACC: 0.9982 	Loss: 0.007897 time 1634.8281903266907
epoch:93, test_loss:1.5549, test_correct:0.9094
epoch:93, asr_loss:1.4792, asr_correct:0.9834
Train Epoch: 94 	TRAIN ACC: 0.9979 	Loss: 0.007790 time 1652.489982843399
epoch:94, test_loss:1.5549, test_correct:0.9091
epoch:94, asr_loss:1.4838, asr_correct:0.9803
Train Epoch: 95 	TRAIN ACC: 0.9985666666666667 	Loss: 0.006062 time 1670.245222568512
epoch:95, test_loss:1.5550, test_correct:0.9090
epoch:95, asr_loss:1.4777, asr_correct:0.9839
Train Epoch: 96 	TRAIN ACC: 0.9986333333333334 	Loss: 0.005943 time 1687.9772624969482
epoch:96, test_loss:1.5546, test_correct:0.9102
epoch:96, asr_loss:1.4785, asr_correct:0.9839
Train Epoch: 97 	TRAIN ACC: 0.9985 	Loss: 0.006504 time 1705.658243894577
epoch:97, test_loss:1.5539, test_correct:0.9104
epoch:97, asr_loss:1.4790, asr_correct:0.9827
Train Epoch: 98 	TRAIN ACC: 0.9983333333333333 	Loss: 0.006080 time 1723.4484477043152
epoch:98, test_loss:1.5579, test_correct:0.9065
epoch:98, asr_loss:1.4766, asr_correct:0.9859
Train Epoch: 99 	TRAIN ACC: 0.9988 	Loss: 0.005208 time 1741.159226179123
epoch:99, test_loss:1.5587, test_correct:0.9058
epoch:99, asr_loss:1.4780, asr_correct:0.9850
Train Epoch: 100 	TRAIN ACC: 0.9986333333333334 	Loss: 0.006145 time 1758.8556821346283
epoch:100, test_loss:1.5557, test_correct:0.9086
epoch:100, asr_loss:1.4759, asr_correct:0.9859
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_12.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_12 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_12 loaded
# 12 test_acc :  0.90856 test_loss :  1.5557490176391602 epsilon :  -1 total_duration: 22873.897572040558
#p_one 0.98588 (1.475914666481018)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.35046666666666665 	Loss: 1.747969 time 7.673590183258057
epoch:1, test_loss:2.1532, test_correct:0.3348
epoch:1, asr_loss:1.8711, asr_correct:0.7877
Train Epoch: 2 	TRAIN ACC: 0.5555666666666667 	Loss: 1.229471 time 25.39045810699463
epoch:2, test_loss:2.0031, test_correct:0.5271
epoch:2, asr_loss:1.5098, asr_correct:0.9691
Train Epoch: 3 	TRAIN ACC: 0.6522 	Loss: 0.975071 time 43.12740874290466
epoch:3, test_loss:1.9242, test_correct:0.5981
epoch:3, asr_loss:1.5606, asr_correct:0.9286
Train Epoch: 4 	TRAIN ACC: 0.6975 	Loss: 0.848076 time 60.87064814567566
epoch:4, test_loss:1.8751, test_correct:0.6541
epoch:4, asr_loss:1.4924, asr_correct:0.9720
Train Epoch: 5 	TRAIN ACC: 0.7265333333333334 	Loss: 0.774663 time 78.55638432502747
epoch:5, test_loss:1.8582, test_correct:0.6599
epoch:5, asr_loss:1.5392, asr_correct:0.9466
Train Epoch: 6 	TRAIN ACC: 0.7588 	Loss: 0.674628 time 96.14578628540039
epoch:6, test_loss:1.8153, test_correct:0.7052
epoch:6, asr_loss:1.5037, asr_correct:0.9602
Train Epoch: 7 	TRAIN ACC: 0.7756666666666666 	Loss: 0.639778 time 113.78709650039673
epoch:7, test_loss:1.8430, test_correct:0.6690
epoch:7, asr_loss:1.4941, asr_correct:0.9760
Train Epoch: 8 	TRAIN ACC: 0.8028333333333333 	Loss: 0.568862 time 131.53348326683044
epoch:8, test_loss:1.7646, test_correct:0.7475
epoch:8, asr_loss:1.4843, asr_correct:0.9782
Train Epoch: 9 	TRAIN ACC: 0.8100333333333334 	Loss: 0.544077 time 149.3344326019287
epoch:9, test_loss:1.7542, test_correct:0.7533
epoch:9, asr_loss:1.4714, asr_correct:0.9910
Train Epoch: 10 	TRAIN ACC: 0.8304666666666667 	Loss: 0.497783 time 167.1108546257019
epoch:10, test_loss:1.7252, test_correct:0.7836
epoch:10, asr_loss:1.4990, asr_correct:0.9667
Train Epoch: 11 	TRAIN ACC: 0.8386666666666667 	Loss: 0.465656 time 184.730402469635
epoch:11, test_loss:1.7496, test_correct:0.7432
epoch:11, asr_loss:1.4750, asr_correct:0.9864
Train Epoch: 12 	TRAIN ACC: 0.8438333333333333 	Loss: 0.456938 time 202.41270971298218
epoch:12, test_loss:1.7282, test_correct:0.7745
epoch:12, asr_loss:1.4933, asr_correct:0.9735
Train Epoch: 13 	TRAIN ACC: 0.8533 	Loss: 0.422077 time 220.10331106185913
epoch:13, test_loss:1.7661, test_correct:0.7265
epoch:13, asr_loss:1.4900, asr_correct:0.9733
Train Epoch: 14 	TRAIN ACC: 0.859 	Loss: 0.418613 time 237.76062297821045
epoch:14, test_loss:1.7551, test_correct:0.7432
epoch:14, asr_loss:1.5072, asr_correct:0.9616
Train Epoch: 15 	TRAIN ACC: 0.8682 	Loss: 0.385078 time 255.41635632514954
epoch:15, test_loss:1.7142, test_correct:0.7755
epoch:15, asr_loss:1.4974, asr_correct:0.9648
Train Epoch: 16 	TRAIN ACC: 0.8736 	Loss: 0.365646 time 273.149471282959
epoch:16, test_loss:1.6962, test_correct:0.7960
epoch:16, asr_loss:1.6311, asr_correct:0.8623
Train Epoch: 17 	TRAIN ACC: 0.8791666666666667 	Loss: 0.347922 time 290.66639471054077
epoch:17, test_loss:1.6733, test_correct:0.8220
epoch:17, asr_loss:1.5087, asr_correct:0.9590
Train Epoch: 18 	TRAIN ACC: 0.8861 	Loss: 0.327358 time 308.33669257164
epoch:18, test_loss:1.7165, test_correct:0.7669
epoch:18, asr_loss:1.4835, asr_correct:0.9778
Train Epoch: 19 	TRAIN ACC: 0.8937333333333334 	Loss: 0.312357 time 326.0793206691742
epoch:19, test_loss:1.6893, test_correct:0.7987
epoch:19, asr_loss:1.4802, asr_correct:0.9823
Train Epoch: 20 	TRAIN ACC: 0.8967333333333334 	Loss: 0.301650 time 343.7108881473541
epoch:20, test_loss:1.6688, test_correct:0.8170
epoch:20, asr_loss:1.4812, asr_correct:0.9799
Train Epoch: 21 	TRAIN ACC: 0.9005333333333333 	Loss: 0.289349 time 361.4033033847809
epoch:21, test_loss:1.6815, test_correct:0.7973
epoch:21, asr_loss:1.5098, asr_correct:0.9579
Train Epoch: 22 	TRAIN ACC: 0.9044666666666666 	Loss: 0.275818 time 379.19926047325134
epoch:22, test_loss:1.6373, test_correct:0.8497
epoch:22, asr_loss:1.4847, asr_correct:0.9776
Train Epoch: 23 	TRAIN ACC: 0.9044333333333333 	Loss: 0.275509 time 396.7862467765808
epoch:23, test_loss:1.6326, test_correct:0.8529
epoch:23, asr_loss:1.4901, asr_correct:0.9725
Train Epoch: 24 	TRAIN ACC: 0.9085666666666666 	Loss: 0.261649 time 414.5827467441559
epoch:24, test_loss:1.6743, test_correct:0.8117
epoch:24, asr_loss:1.4781, asr_correct:0.9899
Train Epoch: 25 	TRAIN ACC: 0.9125333333333333 	Loss: 0.253933 time 432.18363523483276
epoch:25, test_loss:1.6550, test_correct:0.8309
epoch:25, asr_loss:1.4748, asr_correct:0.9868
Train Epoch: 26 	TRAIN ACC: 0.9141666666666667 	Loss: 0.248974 time 449.8957495689392
epoch:26, test_loss:1.6554, test_correct:0.8308
epoch:26, asr_loss:1.4996, asr_correct:0.9668
Train Epoch: 27 	TRAIN ACC: 0.9199 	Loss: 0.237174 time 467.5811343193054
epoch:27, test_loss:1.6435, test_correct:0.8437
epoch:27, asr_loss:1.6568, asr_correct:0.8508
Train Epoch: 28 	TRAIN ACC: 0.9245666666666666 	Loss: 0.217192 time 485.3032512664795
epoch:28, test_loss:1.6297, test_correct:0.8476
epoch:28, asr_loss:1.4966, asr_correct:0.9717
Train Epoch: 29 	TRAIN ACC: 0.9251 	Loss: 0.222395 time 503.12249660491943
epoch:29, test_loss:1.6428, test_correct:0.8380
epoch:29, asr_loss:1.4765, asr_correct:0.9846
Train Epoch: 30 	TRAIN ACC: 0.9282666666666667 	Loss: 0.209679 time 520.75723528862
epoch:30, test_loss:1.6207, test_correct:0.8615
epoch:30, asr_loss:1.4741, asr_correct:0.9865
Train Epoch: 31 	TRAIN ACC: 0.9288333333333333 	Loss: 0.205631 time 538.3928937911987
epoch:31, test_loss:1.6435, test_correct:0.8376
epoch:31, asr_loss:1.4750, asr_correct:0.9855
Train Epoch: 32 	TRAIN ACC: 0.9324666666666667 	Loss: 0.197333 time 556.048159122467
epoch:32, test_loss:1.6309, test_correct:0.8465
epoch:32, asr_loss:1.6803, asr_correct:0.8046
Train Epoch: 33 	TRAIN ACC: 0.9368 	Loss: 0.183726 time 573.7560334205627
epoch:33, test_loss:1.6553, test_correct:0.8217
epoch:33, asr_loss:1.4958, asr_correct:0.9702
Train Epoch: 34 	TRAIN ACC: 0.9356333333333333 	Loss: 0.185652 time 591.5428674221039
epoch:34, test_loss:1.6191, test_correct:0.8584
epoch:34, asr_loss:1.5078, asr_correct:0.9606
Train Epoch: 35 	TRAIN ACC: 0.9387 	Loss: 0.178823 time 609.2149758338928
epoch:35, test_loss:1.6189, test_correct:0.8594
epoch:35, asr_loss:1.6355, asr_correct:0.8570
Train Epoch: 36 	TRAIN ACC: 0.9419666666666666 	Loss: 0.173766 time 626.9801278114319
epoch:36, test_loss:1.6278, test_correct:0.8467
epoch:36, asr_loss:1.4758, asr_correct:0.9857
Train Epoch: 37 	TRAIN ACC: 0.9459333333333333 	Loss: 0.157783 time 644.6832838058472
epoch:37, test_loss:1.6338, test_correct:0.8426
epoch:37, asr_loss:1.4742, asr_correct:0.9868
Train Epoch: 38 	TRAIN ACC: 0.9467333333333333 	Loss: 0.155438 time 662.3543872833252
epoch:38, test_loss:1.6255, test_correct:0.8492
epoch:38, asr_loss:1.4766, asr_correct:0.9845
Train Epoch: 39 	TRAIN ACC: 0.9481 	Loss: 0.151451 time 680.0301394462585
epoch:39, test_loss:1.6200, test_correct:0.8560
epoch:39, asr_loss:1.6189, asr_correct:0.8631
Train Epoch: 40 	TRAIN ACC: 0.9466666666666667 	Loss: 0.155663 time 697.7626903057098
epoch:40, test_loss:1.6082, test_correct:0.8658
epoch:40, asr_loss:1.5220, asr_correct:0.9546
Train Epoch: 41 	TRAIN ACC: 0.9505666666666667 	Loss: 0.143908 time 715.4149610996246
epoch:41, test_loss:1.6311, test_correct:0.8443
epoch:41, asr_loss:1.4753, asr_correct:0.9866
Train Epoch: 42 	TRAIN ACC: 0.9481 	Loss: 0.150506 time 733.0984406471252
epoch:42, test_loss:1.6259, test_correct:0.8497
epoch:42, asr_loss:1.4850, asr_correct:0.9759
Train Epoch: 43 	TRAIN ACC: 0.9525666666666667 	Loss: 0.135126 time 750.8330173492432
epoch:43, test_loss:1.6517, test_correct:0.8217
epoch:43, asr_loss:1.4789, asr_correct:0.9818
Train Epoch: 44 	TRAIN ACC: 0.9537666666666667 	Loss: 0.136468 time 768.4669625759125
epoch:44, test_loss:1.6106, test_correct:0.8611
epoch:44, asr_loss:1.4828, asr_correct:0.9815
Train Epoch: 45 	TRAIN ACC: 0.9571666666666667 	Loss: 0.126408 time 786.1312472820282
epoch:45, test_loss:1.5941, test_correct:0.8785
epoch:45, asr_loss:1.5053, asr_correct:0.9630
Train Epoch: 46 	TRAIN ACC: 0.9537 	Loss: 0.133812 time 803.7998385429382
epoch:46, test_loss:1.6041, test_correct:0.8697
epoch:46, asr_loss:1.4859, asr_correct:0.9772
Train Epoch: 47 	TRAIN ACC: 0.9574 	Loss: 0.122958 time 821.4631397724152
epoch:47, test_loss:1.6008, test_correct:0.8718
epoch:47, asr_loss:1.4809, asr_correct:0.9811
Train Epoch: 48 	TRAIN ACC: 0.9598666666666666 	Loss: 0.116415 time 839.12695145607
epoch:48, test_loss:1.6060, test_correct:0.8639
epoch:48, asr_loss:1.5898, asr_correct:0.8929
Train Epoch: 49 	TRAIN ACC: 0.9566 	Loss: 0.123098 time 856.8473198413849
epoch:49, test_loss:1.6201, test_correct:0.8512
epoch:49, asr_loss:1.4719, asr_correct:0.9892
Train Epoch: 50 	TRAIN ACC: 0.9571 	Loss: 0.127385 time 874.5907883644104
epoch:50, test_loss:1.6001, test_correct:0.8732
epoch:50, asr_loss:1.4747, asr_correct:0.9865
Train Epoch: 51 	TRAIN ACC: 0.9615666666666667 	Loss: 0.112270 time 892.2931296825409
epoch:51, test_loss:1.6020, test_correct:0.8679
epoch:51, asr_loss:1.4795, asr_correct:0.9825
Train Epoch: 52 	TRAIN ACC: 0.9634333333333334 	Loss: 0.109561 time 909.9231090545654
epoch:52, test_loss:1.6173, test_correct:0.8537
epoch:52, asr_loss:1.4778, asr_correct:0.9830
Train Epoch: 53 	TRAIN ACC: 0.9617 	Loss: 0.114265 time 927.61669754982
epoch:53, test_loss:1.6086, test_correct:0.8618
epoch:53, asr_loss:1.4798, asr_correct:0.9827
Train Epoch: 54 	TRAIN ACC: 0.9588 	Loss: 0.122293 time 945.3404207229614
epoch:54, test_loss:1.6194, test_correct:0.8549
epoch:54, asr_loss:1.4824, asr_correct:0.9793
Train Epoch: 55 	TRAIN ACC: 0.9577333333333333 	Loss: 0.124107 time 963.0187771320343
epoch:55, test_loss:1.5973, test_correct:0.8728
epoch:55, asr_loss:1.5148, asr_correct:0.9641
Train Epoch: 56 	TRAIN ACC: 0.9615666666666667 	Loss: 0.106158 time 980.6981880664825
epoch:56, test_loss:1.5978, test_correct:0.8727
epoch:56, asr_loss:1.5039, asr_correct:0.9744
Train Epoch: 57 	TRAIN ACC: 0.9630666666666666 	Loss: 0.107583 time 998.3961870670319
epoch:57, test_loss:1.6176, test_correct:0.8565
epoch:57, asr_loss:1.4843, asr_correct:0.9794
Train Epoch: 58 	TRAIN ACC: 0.9654 	Loss: 0.101602 time 1016.1676511764526
epoch:58, test_loss:1.6024, test_correct:0.8663
epoch:58, asr_loss:1.4744, asr_correct:0.9875
Train Epoch: 59 	TRAIN ACC: 0.9655666666666667 	Loss: 0.101213 time 1033.770619392395
epoch:59, test_loss:1.6099, test_correct:0.8608
epoch:59, asr_loss:1.4775, asr_correct:0.9843
Train Epoch: 60 	TRAIN ACC: 0.9656333333333333 	Loss: 0.098313 time 1051.478852033615
epoch:60, test_loss:1.6047, test_correct:0.8642
epoch:60, asr_loss:1.4751, asr_correct:0.9866
Train Epoch: 61 	TRAIN ACC: 0.9646333333333333 	Loss: 0.102860 time 1069.1813433170319
epoch:61, test_loss:1.5932, test_correct:0.8790
epoch:61, asr_loss:1.4721, asr_correct:0.9884
Train Epoch: 62 	TRAIN ACC: 0.9696333333333333 	Loss: 0.090329 time 1086.8839106559753
epoch:62, test_loss:1.5959, test_correct:0.8732
epoch:62, asr_loss:1.4803, asr_correct:0.9814
Train Epoch: 63 	TRAIN ACC: 0.9622 	Loss: 0.112522 time 1104.6203689575195
epoch:63, test_loss:1.6219, test_correct:0.8490
epoch:63, asr_loss:1.4753, asr_correct:0.9860
Train Epoch: 64 	TRAIN ACC: 0.9678 	Loss: 0.090445 time 1122.5687692165375
epoch:64, test_loss:1.6049, test_correct:0.8644
epoch:64, asr_loss:1.4800, asr_correct:0.9812
Train Epoch: 65 	TRAIN ACC: 0.9675666666666667 	Loss: 0.093813 time 1140.32883477211
epoch:65, test_loss:1.6150, test_correct:0.8559
epoch:65, asr_loss:1.4785, asr_correct:0.9838
Train Epoch: 66 	TRAIN ACC: 0.9647 	Loss: 0.102305 time 1157.9179084300995
epoch:66, test_loss:1.5994, test_correct:0.8728
epoch:66, asr_loss:1.5299, asr_correct:0.9494
Train Epoch: 67 	TRAIN ACC: 0.9683666666666667 	Loss: 0.092769 time 1175.5600645542145
epoch:67, test_loss:1.5976, test_correct:0.8728
epoch:67, asr_loss:1.4812, asr_correct:0.9827
Train Epoch: 68 	TRAIN ACC: 0.9669 	Loss: 0.096409 time 1193.2426254749298
epoch:68, test_loss:1.5985, test_correct:0.8725
epoch:68, asr_loss:1.4768, asr_correct:0.9837
Train Epoch: 69 	TRAIN ACC: 0.9743 	Loss: 0.074645 time 1210.9878907203674
epoch:69, test_loss:1.5967, test_correct:0.8708
epoch:69, asr_loss:1.4754, asr_correct:0.9858
Train Epoch: 70 	TRAIN ACC: 0.9704 	Loss: 0.087344 time 1228.7553162574768
epoch:70, test_loss:1.5862, test_correct:0.8830
epoch:70, asr_loss:1.5216, asr_correct:0.9565
Train Epoch: 71 	TRAIN ACC: 0.9735333333333334 	Loss: 0.076880 time 1246.4665162563324
epoch:71, test_loss:1.6002, test_correct:0.8702
epoch:71, asr_loss:1.4733, asr_correct:0.9871
Train Epoch: 72 	TRAIN ACC: 0.9685333333333334 	Loss: 0.090503 time 1264.1893510818481
epoch:72, test_loss:1.5943, test_correct:0.8728
epoch:72, asr_loss:1.4846, asr_correct:0.9789
Train Epoch: 73 	TRAIN ACC: 0.9714 	Loss: 0.084802 time 1281.8578879833221
epoch:73, test_loss:1.5943, test_correct:0.8739
epoch:73, asr_loss:1.4952, asr_correct:0.9708
Train Epoch: 74 	TRAIN ACC: 0.9708333333333333 	Loss: 0.083553 time 1299.582447052002
epoch:74, test_loss:1.6072, test_correct:0.8604
epoch:74, asr_loss:1.4698, asr_correct:0.9918
Train Epoch: 75 	TRAIN ACC: 0.9719 	Loss: 0.080716 time 1317.1697516441345
epoch:75, test_loss:1.5950, test_correct:0.8729
epoch:75, asr_loss:1.4978, asr_correct:0.9706
Train Epoch: 76 	TRAIN ACC: 0.9696666666666667 	Loss: 0.088434 time 1334.8633766174316
epoch:76, test_loss:1.6039, test_correct:0.8651
epoch:76, asr_loss:1.4818, asr_correct:0.9785
Train Epoch: 77 	TRAIN ACC: 0.9719666666666666 	Loss: 0.085078 time 1352.4529783725739
epoch:77, test_loss:1.5927, test_correct:0.8739
epoch:77, asr_loss:1.4813, asr_correct:0.9811
Train Epoch: 78 	TRAIN ACC: 0.9726 	Loss: 0.081692 time 1370.1848883628845
epoch:78, test_loss:1.6053, test_correct:0.8638
epoch:78, asr_loss:1.4900, asr_correct:0.9727
Train Epoch: 79 	TRAIN ACC: 0.9673333333333334 	Loss: 0.099166 time 1387.8379793167114
epoch:79, test_loss:1.5990, test_correct:0.8695
epoch:79, asr_loss:1.4758, asr_correct:0.9860
Train Epoch: 80 	TRAIN ACC: 0.9724333333333334 	Loss: 0.084147 time 1405.4715418815613
epoch:80, test_loss:1.5975, test_correct:0.8724
epoch:80, asr_loss:1.5249, asr_correct:0.9536
Train Epoch: 81 	TRAIN ACC: 0.9863333333333333 	Loss: 0.041768 time 1423.1332726478577
epoch:81, test_loss:1.5667, test_correct:0.9019
epoch:81, asr_loss:1.4808, asr_correct:0.9817
Train Epoch: 82 	TRAIN ACC: 0.9927666666666667 	Loss: 0.025098 time 1440.7446112632751
epoch:82, test_loss:1.5652, test_correct:0.9034
epoch:82, asr_loss:1.4849, asr_correct:0.9812
Train Epoch: 83 	TRAIN ACC: 0.9946 	Loss: 0.020632 time 1458.509948015213
epoch:83, test_loss:1.5660, test_correct:0.9015
epoch:83, asr_loss:1.4777, asr_correct:0.9848
Train Epoch: 84 	TRAIN ACC: 0.9953666666666666 	Loss: 0.017308 time 1476.1956460475922
epoch:84, test_loss:1.5602, test_correct:0.9065
epoch:84, asr_loss:1.4851, asr_correct:0.9807
Train Epoch: 85 	TRAIN ACC: 0.9956 	Loss: 0.014611 time 1493.7937369346619
epoch:85, test_loss:1.5627, test_correct:0.9047
epoch:85, asr_loss:1.4757, asr_correct:0.9862
Train Epoch: 86 	TRAIN ACC: 0.997 	Loss: 0.012293 time 1511.314240694046
epoch:86, test_loss:1.5591, test_correct:0.9075
epoch:86, asr_loss:1.4908, asr_correct:0.9786
Train Epoch: 87 	TRAIN ACC: 0.9968 	Loss: 0.013305 time 1529.0536415576935
epoch:87, test_loss:1.5605, test_correct:0.9063
epoch:87, asr_loss:1.4766, asr_correct:0.9850
Train Epoch: 88 	TRAIN ACC: 0.9967666666666667 	Loss: 0.011119 time 1546.7365181446075
epoch:88, test_loss:1.5595, test_correct:0.9065
epoch:88, asr_loss:1.4951, asr_correct:0.9781
Train Epoch: 89 	TRAIN ACC: 0.9973 	Loss: 0.009237 time 1564.4685652256012
epoch:89, test_loss:1.5578, test_correct:0.9081
epoch:89, asr_loss:1.4842, asr_correct:0.9809
Train Epoch: 90 	TRAIN ACC: 0.9971333333333333 	Loss: 0.010372 time 1582.0416147708893
epoch:90, test_loss:1.5612, test_correct:0.9048
epoch:90, asr_loss:1.4805, asr_correct:0.9838
Train Epoch: 91 	TRAIN ACC: 0.9973 	Loss: 0.009922 time 1599.703872680664
epoch:91, test_loss:1.5592, test_correct:0.9066
epoch:91, asr_loss:1.4899, asr_correct:0.9795
Train Epoch: 92 	TRAIN ACC: 0.9973 	Loss: 0.009113 time 1617.6652500629425
epoch:92, test_loss:1.5563, test_correct:0.9086
epoch:92, asr_loss:1.5211, asr_correct:0.9613
Train Epoch: 93 	TRAIN ACC: 0.998 	Loss: 0.007682 time 1635.2563815116882
epoch:93, test_loss:1.5595, test_correct:0.9052
epoch:93, asr_loss:1.4786, asr_correct:0.9846
Train Epoch: 94 	TRAIN ACC: 0.9979 	Loss: 0.007641 time 1652.8466777801514
epoch:94, test_loss:1.5586, test_correct:0.9061
epoch:94, asr_loss:1.4859, asr_correct:0.9813
Train Epoch: 95 	TRAIN ACC: 0.9981666666666666 	Loss: 0.007092 time 1670.5064561367035
epoch:95, test_loss:1.5556, test_correct:0.9081
epoch:95, asr_loss:1.4963, asr_correct:0.9729
Train Epoch: 96 	TRAIN ACC: 0.9979 	Loss: 0.007148 time 1688.1145141124725
epoch:96, test_loss:1.5583, test_correct:0.9071
epoch:96, asr_loss:1.4806, asr_correct:0.9830
Train Epoch: 97 	TRAIN ACC: 0.9974666666666666 	Loss: 0.007807 time 1705.7553243637085
epoch:97, test_loss:1.5579, test_correct:0.9062
epoch:97, asr_loss:1.4998, asr_correct:0.9718
Train Epoch: 98 	TRAIN ACC: 0.998 	Loss: 0.007357 time 1723.4748599529266
epoch:98, test_loss:1.5585, test_correct:0.9062
epoch:98, asr_loss:1.4931, asr_correct:0.9776
Train Epoch: 99 	TRAIN ACC: 0.9977 	Loss: 0.007788 time 1741.1751034259796
epoch:99, test_loss:1.5579, test_correct:0.9066
epoch:99, asr_loss:1.4788, asr_correct:0.9840
Train Epoch: 100 	TRAIN ACC: 0.9982 	Loss: 0.006574 time 1758.7514579296112
epoch:100, test_loss:1.5599, test_correct:0.9044
epoch:100, asr_loss:1.5154, asr_correct:0.9643
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_13.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_13 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_13 loaded
# 13 test_acc :  0.9044 test_loss :  1.559862928199768 epsilon :  -1 total_duration: 24632.64902997017
#p_one 0.96428 (1.515418773765564)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.3582666666666667 	Loss: 1.712825 time 7.634610414505005
epoch:1, test_loss:2.1032, test_correct:0.3913
epoch:1, asr_loss:2.1046, asr_correct:0.4400
Train Epoch: 2 	TRAIN ACC: 0.5667666666666666 	Loss: 1.206942 time 25.348771572113037
epoch:2, test_loss:1.9947, test_correct:0.5380
epoch:2, asr_loss:1.5004, asr_correct:0.9774
Train Epoch: 3 	TRAIN ACC: 0.6609 	Loss: 0.942713 time 43.054306507110596
epoch:3, test_loss:1.9896, test_correct:0.5088
epoch:3, asr_loss:1.4631, asr_correct:0.9992
Train Epoch: 4 	TRAIN ACC: 0.7048333333333333 	Loss: 0.830024 time 60.63692545890808
epoch:4, test_loss:1.9022, test_correct:0.6229
epoch:4, asr_loss:1.4967, asr_correct:0.9711
Train Epoch: 5 	TRAIN ACC: 0.7433333333333333 	Loss: 0.722300 time 78.28829216957092
epoch:5, test_loss:1.8798, test_correct:0.6333
epoch:5, asr_loss:1.4706, asr_correct:0.9934
Train Epoch: 6 	TRAIN ACC: 0.7654 	Loss: 0.669275 time 96.06100225448608
epoch:6, test_loss:1.7847, test_correct:0.7335
epoch:6, asr_loss:1.5973, asr_correct:0.8958
Train Epoch: 7 	TRAIN ACC: 0.7911333333333334 	Loss: 0.600411 time 113.6196038722992
epoch:7, test_loss:1.8312, test_correct:0.6719
epoch:7, asr_loss:1.5034, asr_correct:0.9619
Train Epoch: 8 	TRAIN ACC: 0.8017 	Loss: 0.562843 time 131.371160030365
epoch:8, test_loss:1.7752, test_correct:0.7360
epoch:8, asr_loss:1.4755, asr_correct:0.9860
Train Epoch: 9 	TRAIN ACC: 0.8225666666666667 	Loss: 0.509576 time 148.93954801559448
epoch:9, test_loss:1.7520, test_correct:0.7414
epoch:9, asr_loss:1.4849, asr_correct:0.9766
Train Epoch: 10 	TRAIN ACC: 0.8325666666666667 	Loss: 0.482715 time 166.73464846611023
epoch:10, test_loss:1.7317, test_correct:0.7702
epoch:10, asr_loss:1.4852, asr_correct:0.9777
Train Epoch: 11 	TRAIN ACC: 0.8460666666666666 	Loss: 0.449245 time 184.3962643146515
epoch:11, test_loss:1.7146, test_correct:0.7854
epoch:11, asr_loss:1.5364, asr_correct:0.9424
Train Epoch: 12 	TRAIN ACC: 0.8549666666666667 	Loss: 0.414610 time 202.17234778404236
epoch:12, test_loss:1.7431, test_correct:0.7542
epoch:12, asr_loss:1.4690, asr_correct:0.9926
Train Epoch: 13 	TRAIN ACC: 0.8635 	Loss: 0.396045 time 219.97955656051636
epoch:13, test_loss:1.7232, test_correct:0.7646
epoch:13, asr_loss:1.4774, asr_correct:0.9838
Train Epoch: 14 	TRAIN ACC: 0.8668666666666667 	Loss: 0.385832 time 237.59982681274414
epoch:14, test_loss:1.6828, test_correct:0.8051
epoch:14, asr_loss:1.4939, asr_correct:0.9687
Train Epoch: 15 	TRAIN ACC: 0.8776666666666667 	Loss: 0.354260 time 255.34361672401428
epoch:15, test_loss:1.6890, test_correct:0.8000
epoch:15, asr_loss:1.4741, asr_correct:0.9870
Train Epoch: 16 	TRAIN ACC: 0.8784333333333333 	Loss: 0.351886 time 273.09765124320984
epoch:16, test_loss:1.7179, test_correct:0.7693
epoch:16, asr_loss:1.4787, asr_correct:0.9822
Train Epoch: 17 	TRAIN ACC: 0.8868 	Loss: 0.330943 time 290.8485629558563
epoch:17, test_loss:1.6634, test_correct:0.8246
epoch:17, asr_loss:1.4780, asr_correct:0.9825
Train Epoch: 18 	TRAIN ACC: 0.8911333333333333 	Loss: 0.312419 time 308.5627820491791
epoch:18, test_loss:1.6837, test_correct:0.8079
epoch:18, asr_loss:1.4831, asr_correct:0.9785
Train Epoch: 19 	TRAIN ACC: 0.8947666666666667 	Loss: 0.300856 time 326.33471393585205
epoch:19, test_loss:1.6749, test_correct:0.8205
epoch:19, asr_loss:1.4764, asr_correct:0.9847
Train Epoch: 20 	TRAIN ACC: 0.8996666666666666 	Loss: 0.293841 time 344.0220561027527
epoch:20, test_loss:1.6730, test_correct:0.8126
epoch:20, asr_loss:1.4810, asr_correct:0.9802
Train Epoch: 21 	TRAIN ACC: 0.9024 	Loss: 0.283931 time 361.7289378643036
epoch:21, test_loss:1.6546, test_correct:0.8275
epoch:21, asr_loss:1.4712, asr_correct:0.9901
Train Epoch: 22 	TRAIN ACC: 0.9104 	Loss: 0.260498 time 379.4096591472626
epoch:22, test_loss:1.6916, test_correct:0.7936
epoch:22, asr_loss:1.4773, asr_correct:0.9835
Train Epoch: 23 	TRAIN ACC: 0.9095 	Loss: 0.258760 time 397.203485250473
epoch:23, test_loss:1.6643, test_correct:0.8167
epoch:23, asr_loss:1.4762, asr_correct:0.9848
Train Epoch: 24 	TRAIN ACC: 0.9169333333333334 	Loss: 0.242636 time 414.77667784690857
epoch:24, test_loss:1.7389, test_correct:0.7364
epoch:24, asr_loss:1.5152, asr_correct:0.9565
Train Epoch: 25 	TRAIN ACC: 0.9180666666666667 	Loss: 0.241511 time 432.5674149990082
epoch:25, test_loss:1.6618, test_correct:0.8186
epoch:25, asr_loss:1.4901, asr_correct:0.9731
Train Epoch: 26 	TRAIN ACC: 0.9222 	Loss: 0.226116 time 450.34845304489136
epoch:26, test_loss:1.6473, test_correct:0.8325
epoch:26, asr_loss:1.4856, asr_correct:0.9762
Train Epoch: 27 	TRAIN ACC: 0.9234666666666667 	Loss: 0.222056 time 468.1036128997803
epoch:27, test_loss:1.6527, test_correct:0.8297
epoch:27, asr_loss:1.4707, asr_correct:0.9900
Train Epoch: 28 	TRAIN ACC: 0.9274666666666667 	Loss: 0.211199 time 485.8637981414795
epoch:28, test_loss:1.6342, test_correct:0.8436
epoch:28, asr_loss:1.4778, asr_correct:0.9829
Train Epoch: 29 	TRAIN ACC: 0.9282 	Loss: 0.213247 time 503.52233028411865
epoch:29, test_loss:1.6438, test_correct:0.8399
epoch:29, asr_loss:1.4832, asr_correct:0.9793
Train Epoch: 30 	TRAIN ACC: 0.9329666666666667 	Loss: 0.193187 time 521.2859852313995
epoch:30, test_loss:1.6357, test_correct:0.8439
epoch:30, asr_loss:1.4699, asr_correct:0.9912
Train Epoch: 31 	TRAIN ACC: 0.9399333333333333 	Loss: 0.183461 time 539.0607657432556
epoch:31, test_loss:1.6097, test_correct:0.8701
epoch:31, asr_loss:1.4873, asr_correct:0.9759
Train Epoch: 32 	TRAIN ACC: 0.9344666666666667 	Loss: 0.191406 time 556.7540102005005
epoch:32, test_loss:1.6234, test_correct:0.8536
epoch:32, asr_loss:1.4868, asr_correct:0.9758
Train Epoch: 33 	TRAIN ACC: 0.9336333333333333 	Loss: 0.193485 time 574.6319580078125
epoch:33, test_loss:1.6160, test_correct:0.8630
epoch:33, asr_loss:1.4795, asr_correct:0.9820
Train Epoch: 34 	TRAIN ACC: 0.9412666666666667 	Loss: 0.174528 time 592.3863432407379
epoch:34, test_loss:1.6499, test_correct:0.8267
epoch:34, asr_loss:1.4697, asr_correct:0.9912
Train Epoch: 35 	TRAIN ACC: 0.9416666666666667 	Loss: 0.171515 time 610.192807674408
epoch:35, test_loss:1.6204, test_correct:0.8559
epoch:35, asr_loss:1.4725, asr_correct:0.9883
Train Epoch: 36 	TRAIN ACC: 0.9419666666666666 	Loss: 0.171032 time 627.9755122661591
epoch:36, test_loss:1.6027, test_correct:0.8716
epoch:36, asr_loss:1.5343, asr_correct:0.9420
Train Epoch: 37 	TRAIN ACC: 0.9473666666666667 	Loss: 0.154474 time 645.6779208183289
epoch:37, test_loss:1.6438, test_correct:0.8304
epoch:37, asr_loss:1.4763, asr_correct:0.9846
Train Epoch: 38 	TRAIN ACC: 0.9470666666666666 	Loss: 0.154379 time 663.3981869220734
epoch:38, test_loss:1.6206, test_correct:0.8567
epoch:38, asr_loss:1.4863, asr_correct:0.9748
Train Epoch: 39 	TRAIN ACC: 0.9522 	Loss: 0.142578 time 681.0618324279785
epoch:39, test_loss:1.6138, test_correct:0.8607
epoch:39, asr_loss:1.4800, asr_correct:0.9804
Train Epoch: 40 	TRAIN ACC: 0.9517 	Loss: 0.143699 time 698.786306142807
epoch:40, test_loss:1.6100, test_correct:0.8629
epoch:40, asr_loss:1.4882, asr_correct:0.9738
Train Epoch: 41 	TRAIN ACC: 0.9526666666666667 	Loss: 0.140603 time 716.4786942005157
epoch:41, test_loss:1.6057, test_correct:0.8680
epoch:41, asr_loss:1.4796, asr_correct:0.9822
Train Epoch: 42 	TRAIN ACC: 0.9512333333333334 	Loss: 0.144323 time 734.1628966331482
epoch:42, test_loss:1.6218, test_correct:0.8509
epoch:42, asr_loss:1.4732, asr_correct:0.9876
Train Epoch: 43 	TRAIN ACC: 0.9544666666666667 	Loss: 0.133189 time 751.8865160942078
epoch:43, test_loss:1.6139, test_correct:0.8611
epoch:43, asr_loss:1.4788, asr_correct:0.9822
Train Epoch: 44 	TRAIN ACC: 0.9546333333333333 	Loss: 0.134548 time 769.5317459106445
epoch:44, test_loss:1.6346, test_correct:0.8400
epoch:44, asr_loss:1.5049, asr_correct:0.9711
Train Epoch: 45 	TRAIN ACC: 0.9573666666666667 	Loss: 0.125572 time 787.200749874115
epoch:45, test_loss:1.6281, test_correct:0.8421
epoch:45, asr_loss:1.4737, asr_correct:0.9899
Train Epoch: 46 	TRAIN ACC: 0.958 	Loss: 0.123236 time 804.9733145236969
epoch:46, test_loss:1.6273, test_correct:0.8440
epoch:46, asr_loss:1.4787, asr_correct:0.9833
Train Epoch: 47 	TRAIN ACC: 0.9571333333333333 	Loss: 0.127255 time 822.623542547226
epoch:47, test_loss:1.6030, test_correct:0.8680
epoch:47, asr_loss:1.6353, asr_correct:0.8418
Train Epoch: 48 	TRAIN ACC: 0.9619333333333333 	Loss: 0.108961 time 840.2802627086639
epoch:48, test_loss:1.6075, test_correct:0.8640
epoch:48, asr_loss:1.4834, asr_correct:0.9778
Train Epoch: 49 	TRAIN ACC: 0.9597666666666667 	Loss: 0.118410 time 857.9440040588379
epoch:49, test_loss:1.6080, test_correct:0.8647
epoch:49, asr_loss:1.5054, asr_correct:0.9680
Train Epoch: 50 	TRAIN ACC: 0.9577666666666667 	Loss: 0.125956 time 875.7014231681824
epoch:50, test_loss:1.6091, test_correct:0.8636
epoch:50, asr_loss:1.4846, asr_correct:0.9766
Train Epoch: 51 	TRAIN ACC: 0.9637666666666667 	Loss: 0.109219 time 893.3478326797485
epoch:51, test_loss:1.6383, test_correct:0.8326
epoch:51, asr_loss:1.4705, asr_correct:0.9902
Train Epoch: 52 	TRAIN ACC: 0.9597666666666667 	Loss: 0.120446 time 911.0330541133881
epoch:52, test_loss:1.5944, test_correct:0.8805
epoch:52, asr_loss:1.4778, asr_correct:0.9825
Train Epoch: 53 	TRAIN ACC: 0.9626666666666667 	Loss: 0.108746 time 928.8149478435516
epoch:53, test_loss:1.6035, test_correct:0.8676
epoch:53, asr_loss:1.4794, asr_correct:0.9814
Train Epoch: 54 	TRAIN ACC: 0.9640666666666666 	Loss: 0.106091 time 946.502671957016
epoch:54, test_loss:1.6071, test_correct:0.8640
epoch:54, asr_loss:1.4905, asr_correct:0.9796
Train Epoch: 55 	TRAIN ACC: 0.9595 	Loss: 0.117187 time 964.2884390354156
epoch:55, test_loss:1.5970, test_correct:0.8742
epoch:55, asr_loss:1.4902, asr_correct:0.9715
Train Epoch: 56 	TRAIN ACC: 0.9643 	Loss: 0.103625 time 981.9712333679199
epoch:56, test_loss:1.6002, test_correct:0.8710
epoch:56, asr_loss:1.4809, asr_correct:0.9806
Train Epoch: 57 	TRAIN ACC: 0.9676666666666667 	Loss: 0.096547 time 999.5286381244659
epoch:57, test_loss:1.5918, test_correct:0.8794
epoch:57, asr_loss:1.4809, asr_correct:0.9808
Train Epoch: 58 	TRAIN ACC: 0.968 	Loss: 0.095025 time 1017.3917801380157
epoch:58, test_loss:1.5993, test_correct:0.8704
epoch:58, asr_loss:1.4931, asr_correct:0.9708
Train Epoch: 59 	TRAIN ACC: 0.9700666666666666 	Loss: 0.090029 time 1035.1119656562805
epoch:59, test_loss:1.6231, test_correct:0.8453
epoch:59, asr_loss:1.4690, asr_correct:0.9924
Train Epoch: 60 	TRAIN ACC: 0.9653 	Loss: 0.106371 time 1052.7915389537811
epoch:60, test_loss:1.5972, test_correct:0.8735
epoch:60, asr_loss:1.5541, asr_correct:0.9204
Train Epoch: 61 	TRAIN ACC: 0.9671333333333333 	Loss: 0.097234 time 1070.4687476158142
epoch:61, test_loss:1.5940, test_correct:0.8762
epoch:61, asr_loss:1.4945, asr_correct:0.9691
Train Epoch: 62 	TRAIN ACC: 0.9668 	Loss: 0.097060 time 1088.1620118618011
epoch:62, test_loss:1.6090, test_correct:0.8593
epoch:62, asr_loss:1.4782, asr_correct:0.9825
Train Epoch: 63 	TRAIN ACC: 0.9724333333333334 	Loss: 0.081297 time 1105.9329071044922
epoch:63, test_loss:1.5884, test_correct:0.8814
epoch:63, asr_loss:1.4944, asr_correct:0.9710
Train Epoch: 64 	TRAIN ACC: 0.9658333333333333 	Loss: 0.098912 time 1123.6255457401276
epoch:64, test_loss:1.5930, test_correct:0.8757
epoch:64, asr_loss:1.4858, asr_correct:0.9794
Train Epoch: 65 	TRAIN ACC: 0.9686333333333333 	Loss: 0.094790 time 1141.3120403289795
epoch:65, test_loss:1.5937, test_correct:0.8758
epoch:65, asr_loss:1.4757, asr_correct:0.9856
Train Epoch: 66 	TRAIN ACC: 0.9704666666666667 	Loss: 0.084444 time 1158.9694612026215
epoch:66, test_loss:1.6211, test_correct:0.8478
epoch:66, asr_loss:1.4858, asr_correct:0.9802
Train Epoch: 67 	TRAIN ACC: 0.9684 	Loss: 0.091434 time 1176.646818637848
epoch:67, test_loss:1.5991, test_correct:0.8692
epoch:67, asr_loss:1.5061, asr_correct:0.9696
Train Epoch: 68 	TRAIN ACC: 0.97 	Loss: 0.085058 time 1194.2511417865753
epoch:68, test_loss:1.5952, test_correct:0.8751
epoch:68, asr_loss:1.4734, asr_correct:0.9890
Train Epoch: 69 	TRAIN ACC: 0.9724333333333334 	Loss: 0.079753 time 1211.933494091034
epoch:69, test_loss:1.5809, test_correct:0.8866
epoch:69, asr_loss:1.4980, asr_correct:0.9709
Train Epoch: 70 	TRAIN ACC: 0.9681333333333333 	Loss: 0.091016 time 1229.6142408847809
epoch:70, test_loss:1.6148, test_correct:0.8542
epoch:70, asr_loss:1.4831, asr_correct:0.9799
Train Epoch: 71 	TRAIN ACC: 0.9713666666666667 	Loss: 0.082137 time 1247.2559623718262
epoch:71, test_loss:1.5880, test_correct:0.8810
epoch:71, asr_loss:1.4768, asr_correct:0.9843
Train Epoch: 72 	TRAIN ACC: 0.9712 	Loss: 0.083240 time 1264.9661855697632
epoch:72, test_loss:1.6011, test_correct:0.8698
epoch:72, asr_loss:1.4743, asr_correct:0.9869
Train Epoch: 73 	TRAIN ACC: 0.9708666666666667 	Loss: 0.084792 time 1282.7018420696259
epoch:73, test_loss:1.5905, test_correct:0.8792
epoch:73, asr_loss:1.4873, asr_correct:0.9754
Train Epoch: 74 	TRAIN ACC: 0.9714666666666667 	Loss: 0.085886 time 1300.347937822342
epoch:74, test_loss:1.6247, test_correct:0.8427
epoch:74, asr_loss:1.4683, asr_correct:0.9929
Train Epoch: 75 	TRAIN ACC: 0.9708333333333333 	Loss: 0.085782 time 1318.175410270691
epoch:75, test_loss:1.5911, test_correct:0.8750
epoch:75, asr_loss:1.4875, asr_correct:0.9760
Train Epoch: 76 	TRAIN ACC: 0.9736 	Loss: 0.078747 time 1335.9292693138123
epoch:76, test_loss:1.5949, test_correct:0.8745
epoch:76, asr_loss:1.4916, asr_correct:0.9760
Train Epoch: 77 	TRAIN ACC: 0.9707666666666667 	Loss: 0.080197 time 1353.6251764297485
epoch:77, test_loss:1.5981, test_correct:0.8691
epoch:77, asr_loss:1.5068, asr_correct:0.9609
Train Epoch: 78 	TRAIN ACC: 0.9725333333333334 	Loss: 0.080627 time 1371.2443480491638
epoch:78, test_loss:1.5917, test_correct:0.8773
epoch:78, asr_loss:1.4789, asr_correct:0.9815
Train Epoch: 79 	TRAIN ACC: 0.9730333333333333 	Loss: 0.077747 time 1388.861129283905
epoch:79, test_loss:1.6017, test_correct:0.8674
epoch:79, asr_loss:1.4922, asr_correct:0.9760
Train Epoch: 80 	TRAIN ACC: 0.9737666666666667 	Loss: 0.076493 time 1406.5288548469543
epoch:80, test_loss:1.6001, test_correct:0.8703
epoch:80, asr_loss:1.4844, asr_correct:0.9794
Train Epoch: 81 	TRAIN ACC: 0.9863333333333333 	Loss: 0.042763 time 1424.2197380065918
epoch:81, test_loss:1.5641, test_correct:0.9046
epoch:81, asr_loss:1.4776, asr_correct:0.9842
Train Epoch: 82 	TRAIN ACC: 0.9926666666666667 	Loss: 0.025417 time 1441.9349579811096
epoch:82, test_loss:1.5628, test_correct:0.9056
epoch:82, asr_loss:1.4776, asr_correct:0.9839
Train Epoch: 83 	TRAIN ACC: 0.9944666666666667 	Loss: 0.019905 time 1459.6314039230347
epoch:83, test_loss:1.5607, test_correct:0.9072
epoch:83, asr_loss:1.4820, asr_correct:0.9812
Train Epoch: 84 	TRAIN ACC: 0.9962333333333333 	Loss: 0.015150 time 1477.3128373622894
epoch:84, test_loss:1.5626, test_correct:0.9050
epoch:84, asr_loss:1.4769, asr_correct:0.9847
Train Epoch: 85 	TRAIN ACC: 0.9963666666666666 	Loss: 0.014888 time 1494.9382810592651
epoch:85, test_loss:1.5579, test_correct:0.9094
epoch:85, asr_loss:1.4906, asr_correct:0.9773
Train Epoch: 86 	TRAIN ACC: 0.9970666666666667 	Loss: 0.012312 time 1512.6006469726562
epoch:86, test_loss:1.5591, test_correct:0.9078
epoch:86, asr_loss:1.4770, asr_correct:0.9845
Train Epoch: 87 	TRAIN ACC: 0.9971666666666666 	Loss: 0.011528 time 1530.2267286777496
epoch:87, test_loss:1.5604, test_correct:0.9062
epoch:87, asr_loss:1.4776, asr_correct:0.9846
Train Epoch: 88 	TRAIN ACC: 0.9972333333333333 	Loss: 0.010831 time 1547.9557404518127
epoch:88, test_loss:1.5545, test_correct:0.9116
epoch:88, asr_loss:1.4849, asr_correct:0.9796
Train Epoch: 89 	TRAIN ACC: 0.9975666666666667 	Loss: 0.009772 time 1565.7269327640533
epoch:89, test_loss:1.5554, test_correct:0.9102
epoch:89, asr_loss:1.4833, asr_correct:0.9808
Train Epoch: 90 	TRAIN ACC: 0.9975666666666667 	Loss: 0.009229 time 1583.4384286403656
epoch:90, test_loss:1.5555, test_correct:0.9099
epoch:90, asr_loss:1.4885, asr_correct:0.9781
Train Epoch: 91 	TRAIN ACC: 0.9981 	Loss: 0.007914 time 1601.0297598838806
epoch:91, test_loss:1.5553, test_correct:0.9096
epoch:91, asr_loss:1.5027, asr_correct:0.9700
Train Epoch: 92 	TRAIN ACC: 0.9982333333333333 	Loss: 0.006863 time 1618.690854549408
epoch:92, test_loss:1.5558, test_correct:0.9096
epoch:92, asr_loss:1.4882, asr_correct:0.9788
Train Epoch: 93 	TRAIN ACC: 0.9984666666666666 	Loss: 0.006481 time 1636.3855340480804
epoch:93, test_loss:1.5561, test_correct:0.9082
epoch:93, asr_loss:1.4801, asr_correct:0.9829
Train Epoch: 94 	TRAIN ACC: 0.9982666666666666 	Loss: 0.006628 time 1654.112227678299
epoch:94, test_loss:1.5567, test_correct:0.9076
epoch:94, asr_loss:1.4849, asr_correct:0.9798
Train Epoch: 95 	TRAIN ACC: 0.9981 	Loss: 0.006883 time 1671.6972897052765
epoch:95, test_loss:1.5569, test_correct:0.9081
epoch:95, asr_loss:1.4902, asr_correct:0.9769
Train Epoch: 96 	TRAIN ACC: 0.9983333333333333 	Loss: 0.006599 time 1689.282574892044
epoch:96, test_loss:1.5570, test_correct:0.9070
epoch:96, asr_loss:1.4899, asr_correct:0.9783
Train Epoch: 97 	TRAIN ACC: 0.9981333333333333 	Loss: 0.007032 time 1707.0728719234467
epoch:97, test_loss:1.5537, test_correct:0.9104
epoch:97, asr_loss:1.4813, asr_correct:0.9810
Train Epoch: 98 	TRAIN ACC: 0.9987666666666667 	Loss: 0.005423 time 1724.7402155399323
epoch:98, test_loss:1.5572, test_correct:0.9068
epoch:98, asr_loss:1.4807, asr_correct:0.9825
Train Epoch: 99 	TRAIN ACC: 0.9985333333333334 	Loss: 0.005585 time 1742.4590601921082
epoch:99, test_loss:1.5591, test_correct:0.9051
epoch:99, asr_loss:1.4778, asr_correct:0.9842
Train Epoch: 100 	TRAIN ACC: 0.9983333333333333 	Loss: 0.005832 time 1760.139569759369
epoch:100, test_loss:1.5548, test_correct:0.9101
epoch:100, asr_loss:1.4795, asr_correct:0.9825
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_14.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_14 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_14 loaded
# 14 test_acc :  0.91008 test_loss :  1.5548149796676636 epsilon :  -1 total_duration: 26392.788599729538
#p_one 0.98252 (1.4795464157485962)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.3353333333333333 	Loss: 1.763161 time 7.6374351978302
epoch:1, test_loss:2.1714, test_correct:0.2946
epoch:1, asr_loss:1.9493, asr_correct:0.7471
Train Epoch: 2 	TRAIN ACC: 0.5329 	Loss: 1.294917 time 25.292266368865967
epoch:2, test_loss:2.0794, test_correct:0.4038
epoch:2, asr_loss:1.4645, asr_correct:0.9993
Train Epoch: 3 	TRAIN ACC: 0.6328 	Loss: 1.024269 time 42.95913648605347
epoch:3, test_loss:1.9365, test_correct:0.5720
epoch:3, asr_loss:1.4860, asr_correct:0.9793
Train Epoch: 4 	TRAIN ACC: 0.6807 	Loss: 0.900348 time 60.60230493545532
epoch:4, test_loss:1.9698, test_correct:0.5286
epoch:4, asr_loss:1.4775, asr_correct:0.9896
Train Epoch: 5 	TRAIN ACC: 0.7254666666666667 	Loss: 0.785808 time 78.31389951705933
epoch:5, test_loss:1.8481, test_correct:0.6681
epoch:5, asr_loss:1.4827, asr_correct:0.9814
Train Epoch: 6 	TRAIN ACC: 0.7455666666666667 	Loss: 0.712257 time 96.08061122894287
epoch:6, test_loss:1.8913, test_correct:0.6295
epoch:6, asr_loss:1.5235, asr_correct:0.9469
Train Epoch: 7 	TRAIN ACC: 0.7703 	Loss: 0.658986 time 114.07799983024597
epoch:7, test_loss:1.8485, test_correct:0.6524
epoch:7, asr_loss:1.4868, asr_correct:0.9786
Train Epoch: 8 	TRAIN ACC: 0.7901333333333334 	Loss: 0.610094 time 131.84575128555298
epoch:8, test_loss:1.7612, test_correct:0.7476
epoch:8, asr_loss:1.5213, asr_correct:0.9470
Train Epoch: 9 	TRAIN ACC: 0.8097333333333333 	Loss: 0.543860 time 149.56752109527588
epoch:9, test_loss:1.7925, test_correct:0.7094
epoch:9, asr_loss:1.4708, asr_correct:0.9922
Train Epoch: 10 	TRAIN ACC: 0.8200666666666667 	Loss: 0.523898 time 167.289000749588
epoch:10, test_loss:1.7846, test_correct:0.7153
epoch:10, asr_loss:1.5090, asr_correct:0.9563
Train Epoch: 11 	TRAIN ACC: 0.8356 	Loss: 0.477456 time 184.94103503227234
epoch:11, test_loss:1.7454, test_correct:0.7515
epoch:11, asr_loss:1.4919, asr_correct:0.9714
Train Epoch: 12 	TRAIN ACC: 0.8419333333333333 	Loss: 0.457224 time 202.76009702682495
epoch:12, test_loss:1.7197, test_correct:0.7799
epoch:12, asr_loss:1.5100, asr_correct:0.9558
Train Epoch: 13 	TRAIN ACC: 0.8502666666666666 	Loss: 0.436097 time 220.4182426929474
epoch:13, test_loss:1.7158, test_correct:0.7800
epoch:13, asr_loss:1.4768, asr_correct:0.9861
Train Epoch: 14 	TRAIN ACC: 0.8604666666666667 	Loss: 0.408546 time 238.34340620040894
epoch:14, test_loss:1.7250, test_correct:0.7686
epoch:14, asr_loss:1.4666, asr_correct:0.9953
Train Epoch: 15 	TRAIN ACC: 0.8641 	Loss: 0.393291 time 255.93962836265564
epoch:15, test_loss:1.6835, test_correct:0.8110
epoch:15, asr_loss:1.4848, asr_correct:0.9764
Train Epoch: 16 	TRAIN ACC: 0.8753333333333333 	Loss: 0.367272 time 273.6525671482086
epoch:16, test_loss:1.6982, test_correct:0.8008
epoch:16, asr_loss:1.4733, asr_correct:0.9880
Train Epoch: 17 	TRAIN ACC: 0.8781 	Loss: 0.354413 time 291.2921826839447
epoch:17, test_loss:1.7039, test_correct:0.7871
epoch:17, asr_loss:1.4884, asr_correct:0.9729
Train Epoch: 18 	TRAIN ACC: 0.8851333333333333 	Loss: 0.337376 time 308.9862461090088
epoch:18, test_loss:1.6814, test_correct:0.8107
epoch:18, asr_loss:1.4907, asr_correct:0.9710
Train Epoch: 19 	TRAIN ACC: 0.8900333333333333 	Loss: 0.318872 time 326.60803961753845
epoch:19, test_loss:1.6863, test_correct:0.8038
epoch:19, asr_loss:1.4876, asr_correct:0.9729
Train Epoch: 20 	TRAIN ACC: 0.8949 	Loss: 0.309336 time 344.330504655838
epoch:20, test_loss:1.6824, test_correct:0.8020
epoch:20, asr_loss:1.5806, asr_correct:0.8898
Train Epoch: 21 	TRAIN ACC: 0.8979 	Loss: 0.301039 time 361.9500091075897
epoch:21, test_loss:1.6944, test_correct:0.7947
epoch:21, asr_loss:1.6189, asr_correct:0.8678
Train Epoch: 22 	TRAIN ACC: 0.9008333333333334 	Loss: 0.287002 time 379.6394281387329
epoch:22, test_loss:1.6629, test_correct:0.8238
epoch:22, asr_loss:1.4781, asr_correct:0.9832
Train Epoch: 23 	TRAIN ACC: 0.9065 	Loss: 0.275171 time 397.3201222419739
epoch:23, test_loss:1.6706, test_correct:0.8133
epoch:23, asr_loss:1.4909, asr_correct:0.9722
Train Epoch: 24 	TRAIN ACC: 0.9087 	Loss: 0.263535 time 414.98057556152344
epoch:24, test_loss:1.6693, test_correct:0.8129
epoch:24, asr_loss:1.4791, asr_correct:0.9884
Train Epoch: 25 	TRAIN ACC: 0.9071333333333333 	Loss: 0.268406 time 432.66570591926575
epoch:25, test_loss:1.6346, test_correct:0.8508
epoch:25, asr_loss:1.4788, asr_correct:0.9824
Train Epoch: 26 	TRAIN ACC: 0.9178666666666667 	Loss: 0.236827 time 450.3550617694855
epoch:26, test_loss:1.6438, test_correct:0.8374
epoch:26, asr_loss:1.4819, asr_correct:0.9806
Train Epoch: 27 	TRAIN ACC: 0.9245666666666666 	Loss: 0.221856 time 468.0900664329529
epoch:27, test_loss:1.6450, test_correct:0.8332
epoch:27, asr_loss:1.4809, asr_correct:0.9817
Train Epoch: 28 	TRAIN ACC: 0.923 	Loss: 0.222821 time 485.8108286857605
epoch:28, test_loss:1.6430, test_correct:0.8364
epoch:28, asr_loss:1.4774, asr_correct:0.9838
Train Epoch: 29 	TRAIN ACC: 0.9260333333333334 	Loss: 0.211313 time 503.453449010849
epoch:29, test_loss:1.6574, test_correct:0.8222
epoch:29, asr_loss:1.4843, asr_correct:0.9785
Train Epoch: 30 	TRAIN ACC: 0.9303333333333333 	Loss: 0.205622 time 521.0093598365784
epoch:30, test_loss:1.6407, test_correct:0.8388
epoch:30, asr_loss:1.4933, asr_correct:0.9706
Train Epoch: 31 	TRAIN ACC: 0.9321333333333334 	Loss: 0.198049 time 538.8544661998749
epoch:31, test_loss:1.6370, test_correct:0.8396
epoch:31, asr_loss:1.5341, asr_correct:0.9466
Train Epoch: 32 	TRAIN ACC: 0.9338333333333333 	Loss: 0.188647 time 556.5451059341431
epoch:32, test_loss:1.6242, test_correct:0.8506
epoch:32, asr_loss:1.4764, asr_correct:0.9844
Train Epoch: 33 	TRAIN ACC: 0.9383333333333334 	Loss: 0.181842 time 574.2540593147278
epoch:33, test_loss:1.6128, test_correct:0.8655
epoch:33, asr_loss:1.4921, asr_correct:0.9694
Train Epoch: 34 	TRAIN ACC: 0.9377666666666666 	Loss: 0.181554 time 591.9369904994965
epoch:34, test_loss:1.6382, test_correct:0.8373
epoch:34, asr_loss:1.4800, asr_correct:0.9814
Train Epoch: 35 	TRAIN ACC: 0.9401666666666667 	Loss: 0.174696 time 609.5969507694244
epoch:35, test_loss:1.6220, test_correct:0.8621
epoch:35, asr_loss:1.4762, asr_correct:0.9851
Train Epoch: 36 	TRAIN ACC: 0.9454 	Loss: 0.162623 time 627.2059321403503
epoch:36, test_loss:1.6274, test_correct:0.8474
epoch:36, asr_loss:1.4758, asr_correct:0.9852
Train Epoch: 37 	TRAIN ACC: 0.9411666666666667 	Loss: 0.166780 time 644.9609191417694
epoch:37, test_loss:1.6244, test_correct:0.8501
epoch:37, asr_loss:1.5004, asr_correct:0.9682
Train Epoch: 38 	TRAIN ACC: 0.9433333333333334 	Loss: 0.174099 time 662.7122011184692
epoch:38, test_loss:1.6596, test_correct:0.8257
epoch:38, asr_loss:1.4726, asr_correct:0.9880
Train Epoch: 39 	TRAIN ACC: 0.9423666666666667 	Loss: 0.170154 time 680.3708548545837
epoch:39, test_loss:1.6239, test_correct:0.8506
epoch:39, asr_loss:1.4761, asr_correct:0.9847
Train Epoch: 40 	TRAIN ACC: 0.9493 	Loss: 0.143863 time 697.9466443061829
epoch:40, test_loss:1.6310, test_correct:0.8440
epoch:40, asr_loss:1.4707, asr_correct:0.9898
Train Epoch: 41 	TRAIN ACC: 0.9496333333333333 	Loss: 0.145661 time 715.6967222690582
epoch:41, test_loss:1.6230, test_correct:0.8525
epoch:41, asr_loss:1.4723, asr_correct:0.9890
Train Epoch: 42 	TRAIN ACC: 0.9508666666666666 	Loss: 0.139156 time 733.3987309932709
epoch:42, test_loss:1.6219, test_correct:0.8505
epoch:42, asr_loss:1.4797, asr_correct:0.9815
Train Epoch: 43 	TRAIN ACC: 0.9504666666666667 	Loss: 0.142739 time 751.0389845371246
epoch:43, test_loss:1.6215, test_correct:0.8499
epoch:43, asr_loss:1.4772, asr_correct:0.9836
Train Epoch: 44 	TRAIN ACC: 0.954 	Loss: 0.133400 time 768.7695133686066
epoch:44, test_loss:1.6079, test_correct:0.8695
epoch:44, asr_loss:1.4741, asr_correct:0.9864
Train Epoch: 45 	TRAIN ACC: 0.9551333333333333 	Loss: 0.132901 time 786.3766055107117
epoch:45, test_loss:1.6225, test_correct:0.8497
epoch:45, asr_loss:1.4760, asr_correct:0.9845
Train Epoch: 46 	TRAIN ACC: 0.9556333333333333 	Loss: 0.130073 time 804.086124420166
epoch:46, test_loss:1.6280, test_correct:0.8447
epoch:46, asr_loss:1.4762, asr_correct:0.9846
Train Epoch: 47 	TRAIN ACC: 0.9576 	Loss: 0.124942 time 821.9338474273682
epoch:47, test_loss:1.6303, test_correct:0.8416
epoch:47, asr_loss:1.4786, asr_correct:0.9820
Train Epoch: 48 	TRAIN ACC: 0.9535333333333333 	Loss: 0.134360 time 839.6585099697113
epoch:48, test_loss:1.6184, test_correct:0.8547
epoch:48, asr_loss:1.4816, asr_correct:0.9795
Train Epoch: 49 	TRAIN ACC: 0.9590333333333333 	Loss: 0.122934 time 857.5777945518494
epoch:49, test_loss:1.6239, test_correct:0.8546
epoch:49, asr_loss:1.5245, asr_correct:0.9448
Train Epoch: 50 	TRAIN ACC: 0.9617666666666667 	Loss: 0.111057 time 875.3206505775452
epoch:50, test_loss:1.6044, test_correct:0.8672
epoch:50, asr_loss:1.4866, asr_correct:0.9781
Train Epoch: 51 	TRAIN ACC: 0.9627666666666667 	Loss: 0.111493 time 893.0549874305725
epoch:51, test_loss:1.5981, test_correct:0.8724
epoch:51, asr_loss:1.4781, asr_correct:0.9822
Train Epoch: 52 	TRAIN ACC: 0.96 	Loss: 0.113091 time 910.7362675666809
epoch:52, test_loss:1.6147, test_correct:0.8586
epoch:52, asr_loss:1.4776, asr_correct:0.9843
Train Epoch: 53 	TRAIN ACC: 0.9608333333333333 	Loss: 0.110973 time 928.443930387497
epoch:53, test_loss:1.6010, test_correct:0.8684
epoch:53, asr_loss:1.4879, asr_correct:0.9733
Train Epoch: 54 	TRAIN ACC: 0.9638666666666666 	Loss: 0.104323 time 946.1481671333313
epoch:54, test_loss:1.6120, test_correct:0.8578
epoch:54, asr_loss:1.4699, asr_correct:0.9910
Train Epoch: 55 	TRAIN ACC: 0.9643666666666667 	Loss: 0.102547 time 964.074033498764
epoch:55, test_loss:1.6089, test_correct:0.8636
epoch:55, asr_loss:1.4752, asr_correct:0.9856
Train Epoch: 56 	TRAIN ACC: 0.9604 	Loss: 0.115508 time 981.7386503219604
epoch:56, test_loss:1.6138, test_correct:0.8574
epoch:56, asr_loss:1.4782, asr_correct:0.9822
Train Epoch: 57 	TRAIN ACC: 0.9651 	Loss: 0.103162 time 999.4732367992401
epoch:57, test_loss:1.6107, test_correct:0.8587
epoch:57, asr_loss:1.4830, asr_correct:0.9788
Train Epoch: 58 	TRAIN ACC: 0.9644666666666667 	Loss: 0.104642 time 1017.1540303230286
epoch:58, test_loss:1.6174, test_correct:0.8546
epoch:58, asr_loss:1.4807, asr_correct:0.9804
Train Epoch: 59 	TRAIN ACC: 0.9667333333333333 	Loss: 0.096134 time 1034.8908641338348
epoch:59, test_loss:1.6123, test_correct:0.8574
epoch:59, asr_loss:1.4820, asr_correct:0.9794
Train Epoch: 60 	TRAIN ACC: 0.9685666666666667 	Loss: 0.092788 time 1052.5609185695648
epoch:60, test_loss:1.5997, test_correct:0.8709
epoch:60, asr_loss:1.4838, asr_correct:0.9778
Train Epoch: 61 	TRAIN ACC: 0.9650333333333333 	Loss: 0.102890 time 1070.2133264541626
epoch:61, test_loss:1.5929, test_correct:0.8774
epoch:61, asr_loss:1.4800, asr_correct:0.9808
Train Epoch: 62 	TRAIN ACC: 0.9633 	Loss: 0.106169 time 1087.9493517875671
epoch:62, test_loss:1.6092, test_correct:0.8600
epoch:62, asr_loss:1.4816, asr_correct:0.9791
Train Epoch: 63 	TRAIN ACC: 0.9678 	Loss: 0.094153 time 1105.707221031189
epoch:63, test_loss:1.6038, test_correct:0.8633
epoch:63, asr_loss:1.4797, asr_correct:0.9819
Train Epoch: 64 	TRAIN ACC: 0.9682 	Loss: 0.097452 time 1123.497848033905
epoch:64, test_loss:1.5947, test_correct:0.8746
epoch:64, asr_loss:1.5100, asr_correct:0.9578
Train Epoch: 65 	TRAIN ACC: 0.9643 	Loss: 0.104105 time 1141.1569366455078
epoch:65, test_loss:1.6074, test_correct:0.8635
epoch:65, asr_loss:1.4802, asr_correct:0.9812
Train Epoch: 66 	TRAIN ACC: 0.9701333333333333 	Loss: 0.088338 time 1158.8701598644257
epoch:66, test_loss:1.6013, test_correct:0.8676
epoch:66, asr_loss:1.4802, asr_correct:0.9806
Train Epoch: 67 	TRAIN ACC: 0.9672 	Loss: 0.095015 time 1176.5777513980865
epoch:67, test_loss:1.6149, test_correct:0.8556
epoch:67, asr_loss:1.4722, asr_correct:0.9881
Train Epoch: 68 	TRAIN ACC: 0.9667666666666667 	Loss: 0.099785 time 1194.2398104667664
epoch:68, test_loss:1.6027, test_correct:0.8673
epoch:68, asr_loss:1.5129, asr_correct:0.9608
Train Epoch: 69 	TRAIN ACC: 0.9689 	Loss: 0.089630 time 1211.8969359397888
epoch:69, test_loss:1.6067, test_correct:0.8619
epoch:69, asr_loss:1.4737, asr_correct:0.9876
Train Epoch: 70 	TRAIN ACC: 0.971 	Loss: 0.086019 time 1229.7265448570251
epoch:70, test_loss:1.5945, test_correct:0.8736
epoch:70, asr_loss:1.4878, asr_correct:0.9758
Train Epoch: 71 	TRAIN ACC: 0.9678333333333333 	Loss: 0.093649 time 1247.3348360061646
epoch:71, test_loss:1.5918, test_correct:0.8766
epoch:71, asr_loss:1.5830, asr_correct:0.8973
Train Epoch: 72 	TRAIN ACC: 0.9738 	Loss: 0.074251 time 1265.050169467926
epoch:72, test_loss:1.5988, test_correct:0.8690
epoch:72, asr_loss:1.4752, asr_correct:0.9859
Train Epoch: 73 	TRAIN ACC: 0.9738333333333333 	Loss: 0.077325 time 1282.6330740451813
epoch:73, test_loss:1.5857, test_correct:0.8820
epoch:73, asr_loss:1.4843, asr_correct:0.9785
Train Epoch: 74 	TRAIN ACC: 0.9722333333333333 	Loss: 0.084091 time 1300.2776386737823
epoch:74, test_loss:1.5996, test_correct:0.8683
epoch:74, asr_loss:1.4760, asr_correct:0.9848
Train Epoch: 75 	TRAIN ACC: 0.9686666666666667 	Loss: 0.092733 time 1317.9559931755066
epoch:75, test_loss:1.6238, test_correct:0.8447
epoch:75, asr_loss:1.4994, asr_correct:0.9692
Train Epoch: 76 	TRAIN ACC: 0.9709333333333333 	Loss: 0.086687 time 1335.5744361877441
epoch:76, test_loss:1.5985, test_correct:0.8697
epoch:76, asr_loss:1.4838, asr_correct:0.9788
Train Epoch: 77 	TRAIN ACC: 0.9612666666666667 	Loss: 0.113434 time 1353.2867584228516
epoch:77, test_loss:1.5871, test_correct:0.8839
epoch:77, asr_loss:1.4824, asr_correct:0.9803
Train Epoch: 78 	TRAIN ACC: 0.9728333333333333 	Loss: 0.081343 time 1370.945377111435
epoch:78, test_loss:1.5966, test_correct:0.8712
epoch:78, asr_loss:1.4752, asr_correct:0.9875
Train Epoch: 79 	TRAIN ACC: 0.9705 	Loss: 0.087075 time 1388.5427074432373
epoch:79, test_loss:1.5959, test_correct:0.8726
epoch:79, asr_loss:1.4880, asr_correct:0.9738
Train Epoch: 80 	TRAIN ACC: 0.9712 	Loss: 0.084747 time 1406.2073748111725
epoch:80, test_loss:1.5967, test_correct:0.8702
epoch:80, asr_loss:1.4764, asr_correct:0.9846
Train Epoch: 81 	TRAIN ACC: 0.9874 	Loss: 0.038306 time 1423.8710913658142
epoch:81, test_loss:1.5660, test_correct:0.9024
epoch:81, asr_loss:1.4715, asr_correct:0.9892
Train Epoch: 82 	TRAIN ACC: 0.9925333333333334 	Loss: 0.026640 time 1441.6006472110748
epoch:82, test_loss:1.5630, test_correct:0.9051
epoch:82, asr_loss:1.4725, asr_correct:0.9885
Train Epoch: 83 	TRAIN ACC: 0.9943333333333333 	Loss: 0.019373 time 1459.2470841407776
epoch:83, test_loss:1.5634, test_correct:0.9039
epoch:83, asr_loss:1.4717, asr_correct:0.9891
Train Epoch: 84 	TRAIN ACC: 0.9948666666666667 	Loss: 0.017010 time 1476.9532594680786
epoch:84, test_loss:1.5606, test_correct:0.9064
epoch:84, asr_loss:1.4728, asr_correct:0.9881
Train Epoch: 85 	TRAIN ACC: 0.9963 	Loss: 0.013577 time 1494.6103768348694
epoch:85, test_loss:1.5601, test_correct:0.9056
epoch:85, asr_loss:1.4730, asr_correct:0.9882
Train Epoch: 86 	TRAIN ACC: 0.9968 	Loss: 0.013019 time 1512.3175930976868
epoch:86, test_loss:1.5584, test_correct:0.9078
epoch:86, asr_loss:1.4735, asr_correct:0.9878
Train Epoch: 87 	TRAIN ACC: 0.9968666666666667 	Loss: 0.011679 time 1530.1393332481384
epoch:87, test_loss:1.5580, test_correct:0.9073
epoch:87, asr_loss:1.4734, asr_correct:0.9878
Train Epoch: 88 	TRAIN ACC: 0.9967666666666667 	Loss: 0.011057 time 1547.991371870041
epoch:88, test_loss:1.5561, test_correct:0.9096
epoch:88, asr_loss:1.4766, asr_correct:0.9844
Train Epoch: 89 	TRAIN ACC: 0.9976333333333334 	Loss: 0.009465 time 1565.7160847187042
epoch:89, test_loss:1.5604, test_correct:0.9055
epoch:89, asr_loss:1.4718, asr_correct:0.9893
Train Epoch: 90 	TRAIN ACC: 0.9973 	Loss: 0.009921 time 1583.3514370918274
epoch:90, test_loss:1.5617, test_correct:0.9028
epoch:90, asr_loss:1.4729, asr_correct:0.9884
Train Epoch: 91 	TRAIN ACC: 0.9980333333333333 	Loss: 0.008540 time 1601.0798840522766
epoch:91, test_loss:1.5566, test_correct:0.9088
epoch:91, asr_loss:1.4754, asr_correct:0.9858
Train Epoch: 92 	TRAIN ACC: 0.9975333333333334 	Loss: 0.008590 time 1618.8091695308685
epoch:92, test_loss:1.5591, test_correct:0.9054
epoch:92, asr_loss:1.4730, asr_correct:0.9881
Train Epoch: 93 	TRAIN ACC: 0.9984 	Loss: 0.006559 time 1636.4817445278168
epoch:93, test_loss:1.5552, test_correct:0.9084
epoch:93, asr_loss:1.4786, asr_correct:0.9840
Train Epoch: 94 	TRAIN ACC: 0.9980333333333333 	Loss: 0.007258 time 1654.2621355056763
epoch:94, test_loss:1.5579, test_correct:0.9061
epoch:94, asr_loss:1.4757, asr_correct:0.9859
Train Epoch: 95 	TRAIN ACC: 0.9983 	Loss: 0.006995 time 1671.942568063736
epoch:95, test_loss:1.5581, test_correct:0.9057
epoch:95, asr_loss:1.4788, asr_correct:0.9835
Train Epoch: 96 	TRAIN ACC: 0.9978333333333333 	Loss: 0.007613 time 1689.7101783752441
epoch:96, test_loss:1.5563, test_correct:0.9085
epoch:96, asr_loss:1.4756, asr_correct:0.9857
Train Epoch: 97 	TRAIN ACC: 0.9984 	Loss: 0.006482 time 1707.4728655815125
epoch:97, test_loss:1.5575, test_correct:0.9072
epoch:97, asr_loss:1.4749, asr_correct:0.9866
Train Epoch: 98 	TRAIN ACC: 0.9988 	Loss: 0.005357 time 1725.2262439727783
epoch:98, test_loss:1.5546, test_correct:0.9092
epoch:98, asr_loss:1.4777, asr_correct:0.9838
Train Epoch: 99 	TRAIN ACC: 0.9982333333333333 	Loss: 0.006744 time 1743.0336420536041
epoch:99, test_loss:1.5574, test_correct:0.9066
epoch:99, asr_loss:1.4750, asr_correct:0.9863
Train Epoch: 100 	TRAIN ACC: 0.9985333333333334 	Loss: 0.005630 time 1760.8182604312897
epoch:100, test_loss:1.5559, test_correct:0.9081
epoch:100, asr_loss:1.4753, asr_correct:0.9859
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_15.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_15 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_15 loaded
# 15 test_acc :  0.90808 test_loss :  1.5559326139450074 epsilon :  -1 total_duration: 28153.606860160828
#p_one 0.98592 (1.4752686003875732)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.33816666666666667 	Loss: 1.769036 time 7.6616432666778564
epoch:1, test_loss:2.1347, test_correct:0.3591
epoch:1, asr_loss:1.9280, asr_correct:0.7435
Train Epoch: 2 	TRAIN ACC: 0.5405666666666666 	Loss: 1.266059 time 25.448794841766357
epoch:2, test_loss:2.0461, test_correct:0.4838
epoch:2, asr_loss:1.5527, asr_correct:0.9584
Train Epoch: 3 	TRAIN ACC: 0.6465333333333333 	Loss: 0.985515 time 43.181748390197754
epoch:3, test_loss:1.9656, test_correct:0.5416
epoch:3, asr_loss:1.5032, asr_correct:0.9721
Train Epoch: 4 	TRAIN ACC: 0.6954 	Loss: 0.849380 time 61.03150916099548
epoch:4, test_loss:1.9257, test_correct:0.5752
epoch:4, asr_loss:1.4672, asr_correct:0.9972
Train Epoch: 5 	TRAIN ACC: 0.7319 	Loss: 0.756484 time 78.68792486190796
epoch:5, test_loss:1.8404, test_correct:0.6787
epoch:5, asr_loss:1.4963, asr_correct:0.9708
Train Epoch: 6 	TRAIN ACC: 0.7631666666666667 	Loss: 0.675138 time 96.33801794052124
epoch:6, test_loss:1.8249, test_correct:0.6921
epoch:6, asr_loss:1.5130, asr_correct:0.9578
Train Epoch: 7 	TRAIN ACC: 0.7827666666666667 	Loss: 0.617049 time 114.11883115768433
epoch:7, test_loss:1.7801, test_correct:0.7424
epoch:7, asr_loss:1.4734, asr_correct:0.9887
Train Epoch: 8 	TRAIN ACC: 0.8018666666666666 	Loss: 0.568332 time 131.87246870994568
epoch:8, test_loss:1.7754, test_correct:0.7338
epoch:8, asr_loss:1.4935, asr_correct:0.9715
Train Epoch: 9 	TRAIN ACC: 0.8190333333333333 	Loss: 0.522073 time 149.65233182907104
epoch:9, test_loss:1.7721, test_correct:0.7288
epoch:9, asr_loss:1.4734, asr_correct:0.9883
Train Epoch: 10 	TRAIN ACC: 0.8289333333333333 	Loss: 0.491286 time 167.3274347782135
epoch:10, test_loss:1.7680, test_correct:0.7318
epoch:10, asr_loss:1.4891, asr_correct:0.9733
Train Epoch: 11 	TRAIN ACC: 0.8352666666666667 	Loss: 0.476407 time 185.03177118301392
epoch:11, test_loss:1.7380, test_correct:0.7557
epoch:11, asr_loss:1.4879, asr_correct:0.9739
Train Epoch: 12 	TRAIN ACC: 0.8511666666666666 	Loss: 0.426294 time 202.7436363697052
epoch:12, test_loss:1.7378, test_correct:0.7680
epoch:12, asr_loss:1.4881, asr_correct:0.9743
Train Epoch: 13 	TRAIN ACC: 0.8607666666666667 	Loss: 0.402635 time 220.48049974441528
epoch:13, test_loss:1.7302, test_correct:0.7596
epoch:13, asr_loss:1.4881, asr_correct:0.9739
Train Epoch: 14 	TRAIN ACC: 0.8682333333333333 	Loss: 0.381114 time 238.24605894088745
epoch:14, test_loss:1.6972, test_correct:0.8019
epoch:14, asr_loss:1.4857, asr_correct:0.9766
Train Epoch: 15 	TRAIN ACC: 0.8722 	Loss: 0.371064 time 255.93190789222717
epoch:15, test_loss:1.6858, test_correct:0.8149
epoch:15, asr_loss:1.4864, asr_correct:0.9756
Train Epoch: 16 	TRAIN ACC: 0.8810666666666667 	Loss: 0.344070 time 273.82535576820374
epoch:16, test_loss:1.6982, test_correct:0.7913
epoch:16, asr_loss:1.4665, asr_correct:0.9955
Train Epoch: 17 	TRAIN ACC: 0.8883 	Loss: 0.326295 time 291.43822383880615
epoch:17, test_loss:1.6721, test_correct:0.8149
epoch:17, asr_loss:1.4897, asr_correct:0.9726
Train Epoch: 18 	TRAIN ACC: 0.8875666666666666 	Loss: 0.326807 time 309.37126064300537
epoch:18, test_loss:1.6825, test_correct:0.8049
epoch:18, asr_loss:1.4741, asr_correct:0.9874
Train Epoch: 19 	TRAIN ACC: 0.8968 	Loss: 0.304698 time 327.1812891960144
epoch:19, test_loss:1.6696, test_correct:0.8199
epoch:19, asr_loss:1.4765, asr_correct:0.9849
Train Epoch: 20 	TRAIN ACC: 0.8984666666666666 	Loss: 0.300154 time 344.938099861145
epoch:20, test_loss:1.6838, test_correct:0.8038
epoch:20, asr_loss:1.4720, asr_correct:0.9894
Train Epoch: 21 	TRAIN ACC: 0.9003666666666666 	Loss: 0.293202 time 362.6686997413635
epoch:21, test_loss:1.6713, test_correct:0.8105
epoch:21, asr_loss:1.4791, asr_correct:0.9824
Train Epoch: 22 	TRAIN ACC: 0.9069 	Loss: 0.273398 time 380.45360827445984
epoch:22, test_loss:1.6654, test_correct:0.8182
epoch:22, asr_loss:1.4840, asr_correct:0.9780
Train Epoch: 23 	TRAIN ACC: 0.9086333333333333 	Loss: 0.263850 time 398.135618686676
epoch:23, test_loss:1.6812, test_correct:0.7977
epoch:23, asr_loss:1.4859, asr_correct:0.9770
Train Epoch: 24 	TRAIN ACC: 0.9157333333333333 	Loss: 0.244308 time 415.8806691169739
epoch:24, test_loss:1.6599, test_correct:0.8188
epoch:24, asr_loss:1.4997, asr_correct:0.9657
Train Epoch: 25 	TRAIN ACC: 0.9169666666666667 	Loss: 0.243422 time 433.6472079753876
epoch:25, test_loss:1.6463, test_correct:0.8348
epoch:25, asr_loss:1.4852, asr_correct:0.9765
Train Epoch: 26 	TRAIN ACC: 0.9200333333333334 	Loss: 0.230845 time 451.4273602962494
epoch:26, test_loss:1.6478, test_correct:0.8347
epoch:26, asr_loss:1.4855, asr_correct:0.9764
Train Epoch: 27 	TRAIN ACC: 0.9222333333333333 	Loss: 0.220842 time 469.1963987350464
epoch:27, test_loss:1.7130, test_correct:0.7637
epoch:27, asr_loss:1.4682, asr_correct:0.9936
Train Epoch: 28 	TRAIN ACC: 0.9276666666666666 	Loss: 0.215028 time 486.9096522331238
epoch:28, test_loss:1.6564, test_correct:0.8214
epoch:28, asr_loss:1.4863, asr_correct:0.9774
Train Epoch: 29 	TRAIN ACC: 0.927 	Loss: 0.210989 time 504.72026777267456
epoch:29, test_loss:1.6465, test_correct:0.8322
epoch:29, asr_loss:1.4737, asr_correct:0.9874
Train Epoch: 30 	TRAIN ACC: 0.9318333333333333 	Loss: 0.198803 time 522.4475846290588
epoch:30, test_loss:1.6489, test_correct:0.8316
epoch:30, asr_loss:1.5369, asr_correct:0.9481
Train Epoch: 31 	TRAIN ACC: 0.9349333333333333 	Loss: 0.190426 time 540.3418955802917
epoch:31, test_loss:1.6273, test_correct:0.8520
epoch:31, asr_loss:1.4780, asr_correct:0.9842
Train Epoch: 32 	TRAIN ACC: 0.9372333333333334 	Loss: 0.182478 time 558.255687713623
epoch:32, test_loss:1.6405, test_correct:0.8364
epoch:32, asr_loss:1.4815, asr_correct:0.9816
Train Epoch: 33 	TRAIN ACC: 0.9351 	Loss: 0.186500 time 576.0467879772186
epoch:33, test_loss:1.6433, test_correct:0.8352
epoch:33, asr_loss:1.4748, asr_correct:0.9862
Train Epoch: 34 	TRAIN ACC: 0.9384666666666667 	Loss: 0.176912 time 593.7663662433624
epoch:34, test_loss:1.6256, test_correct:0.8464
epoch:34, asr_loss:1.5748, asr_correct:0.9118
Train Epoch: 35 	TRAIN ACC: 0.9380666666666667 	Loss: 0.175179 time 611.5690748691559
epoch:35, test_loss:1.6412, test_correct:0.8370
epoch:35, asr_loss:1.4724, asr_correct:0.9904
Train Epoch: 36 	TRAIN ACC: 0.9443666666666667 	Loss: 0.159209 time 629.3538355827332
epoch:36, test_loss:1.6210, test_correct:0.8535
epoch:36, asr_loss:1.4763, asr_correct:0.9847
Train Epoch: 37 	TRAIN ACC: 0.9450666666666667 	Loss: 0.160046 time 647.2471451759338
epoch:37, test_loss:1.6629, test_correct:0.8142
epoch:37, asr_loss:1.4852, asr_correct:0.9785
Train Epoch: 38 	TRAIN ACC: 0.9469333333333333 	Loss: 0.153688 time 665.0583896636963
epoch:38, test_loss:1.6073, test_correct:0.8664
epoch:38, asr_loss:1.4818, asr_correct:0.9794
Train Epoch: 39 	TRAIN ACC: 0.9507666666666666 	Loss: 0.145461 time 682.9019181728363
epoch:39, test_loss:1.6144, test_correct:0.8613
epoch:39, asr_loss:1.4778, asr_correct:0.9835
Train Epoch: 40 	TRAIN ACC: 0.9467 	Loss: 0.152033 time 700.6001996994019
epoch:40, test_loss:1.6085, test_correct:0.8658
epoch:40, asr_loss:1.4866, asr_correct:0.9769
Train Epoch: 41 	TRAIN ACC: 0.9502333333333334 	Loss: 0.146408 time 718.3862478733063
epoch:41, test_loss:1.6216, test_correct:0.8507
epoch:41, asr_loss:1.4826, asr_correct:0.9793
Train Epoch: 42 	TRAIN ACC: 0.9524333333333334 	Loss: 0.138408 time 736.229062795639
epoch:42, test_loss:1.6175, test_correct:0.8572
epoch:42, asr_loss:1.6014, asr_correct:0.8808
Train Epoch: 43 	TRAIN ACC: 0.9548 	Loss: 0.128957 time 754.1450252532959
epoch:43, test_loss:1.6359, test_correct:0.8334
epoch:43, asr_loss:1.4754, asr_correct:0.9856
Train Epoch: 44 	TRAIN ACC: 0.9552666666666667 	Loss: 0.131681 time 771.9373908042908
epoch:44, test_loss:1.6268, test_correct:0.8468
epoch:44, asr_loss:1.4821, asr_correct:0.9823
Train Epoch: 45 	TRAIN ACC: 0.9580333333333333 	Loss: 0.122955 time 789.7138702869415
epoch:45, test_loss:1.6197, test_correct:0.8506
epoch:45, asr_loss:1.5021, asr_correct:0.9648
Train Epoch: 46 	TRAIN ACC: 0.9585666666666667 	Loss: 0.121191 time 807.471198797226
epoch:46, test_loss:1.6182, test_correct:0.8555
epoch:46, asr_loss:1.4699, asr_correct:0.9912
Train Epoch: 47 	TRAIN ACC: 0.9565333333333333 	Loss: 0.127333 time 825.2627193927765
epoch:47, test_loss:1.6088, test_correct:0.8634
epoch:47, asr_loss:1.4792, asr_correct:0.9817
Train Epoch: 48 	TRAIN ACC: 0.9592666666666667 	Loss: 0.120724 time 843.0229902267456
epoch:48, test_loss:1.6020, test_correct:0.8701
epoch:48, asr_loss:1.4861, asr_correct:0.9771
Train Epoch: 49 	TRAIN ACC: 0.9622 	Loss: 0.113117 time 860.7162048816681
epoch:49, test_loss:1.6109, test_correct:0.8623
epoch:49, asr_loss:1.4833, asr_correct:0.9781
Train Epoch: 50 	TRAIN ACC: 0.9603666666666667 	Loss: 0.115247 time 878.4930512905121
epoch:50, test_loss:1.6029, test_correct:0.8678
epoch:50, asr_loss:1.4826, asr_correct:0.9794
Train Epoch: 51 	TRAIN ACC: 0.9606333333333333 	Loss: 0.112941 time 896.2403104305267
epoch:51, test_loss:1.6213, test_correct:0.8490
epoch:51, asr_loss:1.5028, asr_correct:0.9664
Train Epoch: 52 	TRAIN ACC: 0.9608 	Loss: 0.116286 time 913.982926607132
epoch:52, test_loss:1.6195, test_correct:0.8542
epoch:52, asr_loss:1.4730, asr_correct:0.9882
Train Epoch: 53 	TRAIN ACC: 0.9624666666666667 	Loss: 0.110596 time 931.6774733066559
epoch:53, test_loss:1.6149, test_correct:0.8540
epoch:53, asr_loss:1.4781, asr_correct:0.9845
Train Epoch: 54 	TRAIN ACC: 0.9602333333333334 	Loss: 0.113982 time 949.4937710762024
epoch:54, test_loss:1.6210, test_correct:0.8500
epoch:54, asr_loss:1.4695, asr_correct:0.9917
Train Epoch: 55 	TRAIN ACC: 0.9649666666666666 	Loss: 0.102269 time 967.3548791408539
epoch:55, test_loss:1.6145, test_correct:0.8598
epoch:55, asr_loss:1.5512, asr_correct:0.9240
Train Epoch: 56 	TRAIN ACC: 0.9626 	Loss: 0.108475 time 985.1914501190186
epoch:56, test_loss:1.6312, test_correct:0.8376
epoch:56, asr_loss:1.4996, asr_correct:0.9730
Train Epoch: 57 	TRAIN ACC: 0.9656 	Loss: 0.099888 time 1002.8367502689362
epoch:57, test_loss:1.6152, test_correct:0.8563
epoch:57, asr_loss:1.4830, asr_correct:0.9832
Train Epoch: 58 	TRAIN ACC: 0.9664666666666667 	Loss: 0.103920 time 1020.4146406650543
epoch:58, test_loss:1.5975, test_correct:0.8713
epoch:58, asr_loss:1.5029, asr_correct:0.9643
Train Epoch: 59 	TRAIN ACC: 0.9682 	Loss: 0.094876 time 1038.0006816387177
epoch:59, test_loss:1.6116, test_correct:0.8585
epoch:59, asr_loss:1.4834, asr_correct:0.9799
Train Epoch: 60 	TRAIN ACC: 0.9678 	Loss: 0.094207 time 1055.6870567798615
epoch:60, test_loss:1.5934, test_correct:0.8760
epoch:60, asr_loss:1.5106, asr_correct:0.9607
Train Epoch: 61 	TRAIN ACC: 0.9685666666666667 	Loss: 0.096233 time 1073.3356902599335
epoch:61, test_loss:1.6003, test_correct:0.8687
epoch:61, asr_loss:1.4793, asr_correct:0.9818
Train Epoch: 62 	TRAIN ACC: 0.9664333333333334 	Loss: 0.097772 time 1090.8904790878296
epoch:62, test_loss:1.6059, test_correct:0.8644
epoch:62, asr_loss:1.4740, asr_correct:0.9879
Train Epoch: 63 	TRAIN ACC: 0.9687666666666667 	Loss: 0.090503 time 1108.6360833644867
epoch:63, test_loss:1.5963, test_correct:0.8726
epoch:63, asr_loss:1.4963, asr_correct:0.9736
Train Epoch: 64 	TRAIN ACC: 0.9735333333333334 	Loss: 0.078225 time 1126.3492183685303
epoch:64, test_loss:1.6163, test_correct:0.8533
epoch:64, asr_loss:1.4724, asr_correct:0.9885
Train Epoch: 65 	TRAIN ACC: 0.9682 	Loss: 0.091678 time 1144.065195798874
epoch:65, test_loss:1.6145, test_correct:0.8534
epoch:65, asr_loss:1.7524, asr_correct:0.7186
Train Epoch: 66 	TRAIN ACC: 0.9582333333333334 	Loss: 0.128701 time 1161.7798736095428
epoch:66, test_loss:1.6273, test_correct:0.8408
epoch:66, asr_loss:1.4855, asr_correct:0.9769
Train Epoch: 67 	TRAIN ACC: 0.9694666666666667 	Loss: 0.087330 time 1179.4872782230377
epoch:67, test_loss:1.6168, test_correct:0.8511
epoch:67, asr_loss:1.4830, asr_correct:0.9796
Train Epoch: 68 	TRAIN ACC: 0.9703 	Loss: 0.086944 time 1197.2123725414276
epoch:68, test_loss:1.5876, test_correct:0.8815
epoch:68, asr_loss:1.5029, asr_correct:0.9622
Train Epoch: 69 	TRAIN ACC: 0.9713 	Loss: 0.088943 time 1214.9079644680023
epoch:69, test_loss:1.6062, test_correct:0.8619
epoch:69, asr_loss:1.5169, asr_correct:0.9557
Train Epoch: 70 	TRAIN ACC: 0.9661666666666666 	Loss: 0.097834 time 1232.6565172672272
epoch:70, test_loss:1.6002, test_correct:0.8696
epoch:70, asr_loss:1.4785, asr_correct:0.9827
Train Epoch: 71 	TRAIN ACC: 0.9752 	Loss: 0.074562 time 1250.3677785396576
epoch:71, test_loss:1.6201, test_correct:0.8486
epoch:71, asr_loss:1.4790, asr_correct:0.9836
Train Epoch: 72 	TRAIN ACC: 0.9706666666666667 	Loss: 0.083281 time 1268.090187549591
epoch:72, test_loss:1.6013, test_correct:0.8660
epoch:72, asr_loss:1.4774, asr_correct:0.9843
Train Epoch: 73 	TRAIN ACC: 0.9720666666666666 	Loss: 0.081294 time 1285.611878156662
epoch:73, test_loss:1.6062, test_correct:0.8613
epoch:73, asr_loss:1.4811, asr_correct:0.9824
Train Epoch: 74 	TRAIN ACC: 0.9737 	Loss: 0.076576 time 1303.4337430000305
epoch:74, test_loss:1.6003, test_correct:0.8696
epoch:74, asr_loss:1.4761, asr_correct:0.9850
Train Epoch: 75 	TRAIN ACC: 0.9691 	Loss: 0.091497 time 1321.0367405414581
epoch:75, test_loss:1.6112, test_correct:0.8578
epoch:75, asr_loss:1.5449, asr_correct:0.9366
Train Epoch: 76 	TRAIN ACC: 0.9700333333333333 	Loss: 0.086636 time 1338.6471700668335
epoch:76, test_loss:1.5885, test_correct:0.8788
epoch:76, asr_loss:1.4840, asr_correct:0.9795
Train Epoch: 77 	TRAIN ACC: 0.9746666666666667 	Loss: 0.074621 time 1356.3300762176514
epoch:77, test_loss:1.6032, test_correct:0.8643
epoch:77, asr_loss:1.4906, asr_correct:0.9748
Train Epoch: 78 	TRAIN ACC: 0.9771666666666666 	Loss: 0.069188 time 1374.0459411144257
epoch:78, test_loss:1.5863, test_correct:0.8820
epoch:78, asr_loss:1.4812, asr_correct:0.9810
Train Epoch: 79 	TRAIN ACC: 0.969 	Loss: 0.090093 time 1391.7087988853455
epoch:79, test_loss:1.5952, test_correct:0.8734
epoch:79, asr_loss:1.4715, asr_correct:0.9890
Train Epoch: 80 	TRAIN ACC: 0.9704666666666667 	Loss: 0.088749 time 1409.333518743515
epoch:80, test_loss:1.5991, test_correct:0.8694
epoch:80, asr_loss:1.4808, asr_correct:0.9823
Train Epoch: 81 	TRAIN ACC: 0.9868 	Loss: 0.041327 time 1427.0067822933197
epoch:81, test_loss:1.5680, test_correct:0.8994
epoch:81, asr_loss:1.4764, asr_correct:0.9853
Train Epoch: 82 	TRAIN ACC: 0.9933 	Loss: 0.023401 time 1444.6955890655518
epoch:82, test_loss:1.5648, test_correct:0.9028
epoch:82, asr_loss:1.4759, asr_correct:0.9856
Train Epoch: 83 	TRAIN ACC: 0.9954 	Loss: 0.017881 time 1462.2550611495972
epoch:83, test_loss:1.5625, test_correct:0.9046
epoch:83, asr_loss:1.4772, asr_correct:0.9846
Train Epoch: 84 	TRAIN ACC: 0.9954333333333333 	Loss: 0.016915 time 1479.9360406398773
epoch:84, test_loss:1.5623, test_correct:0.9042
epoch:84, asr_loss:1.4774, asr_correct:0.9850
Train Epoch: 85 	TRAIN ACC: 0.9966666666666667 	Loss: 0.013325 time 1497.5662796497345
epoch:85, test_loss:1.5611, test_correct:0.9050
epoch:85, asr_loss:1.4843, asr_correct:0.9813
Train Epoch: 86 	TRAIN ACC: 0.9972666666666666 	Loss: 0.011747 time 1515.2324147224426
epoch:86, test_loss:1.5623, test_correct:0.9033
epoch:86, asr_loss:1.4756, asr_correct:0.9860
Train Epoch: 87 	TRAIN ACC: 0.9972 	Loss: 0.010754 time 1532.8807311058044
epoch:87, test_loss:1.5596, test_correct:0.9056
epoch:87, asr_loss:1.5284, asr_correct:0.9562
Train Epoch: 88 	TRAIN ACC: 0.9975333333333334 	Loss: 0.009631 time 1550.5432426929474
epoch:88, test_loss:1.5594, test_correct:0.9051
epoch:88, asr_loss:1.5046, asr_correct:0.9712
Train Epoch: 89 	TRAIN ACC: 0.9975666666666667 	Loss: 0.008992 time 1568.1267244815826
epoch:89, test_loss:1.5583, test_correct:0.9071
epoch:89, asr_loss:1.4855, asr_correct:0.9809
Train Epoch: 90 	TRAIN ACC: 0.9979 	Loss: 0.008046 time 1585.890275478363
epoch:90, test_loss:1.5589, test_correct:0.9058
epoch:90, asr_loss:1.4767, asr_correct:0.9848
Train Epoch: 91 	TRAIN ACC: 0.9982333333333333 	Loss: 0.007400 time 1603.5268387794495
epoch:91, test_loss:1.5573, test_correct:0.9077
epoch:91, asr_loss:1.4896, asr_correct:0.9775
Train Epoch: 92 	TRAIN ACC: 0.9982333333333333 	Loss: 0.007186 time 1621.1914205551147
epoch:92, test_loss:1.5574, test_correct:0.9069
epoch:92, asr_loss:1.4829, asr_correct:0.9814
Train Epoch: 93 	TRAIN ACC: 0.9984333333333333 	Loss: 0.006403 time 1638.8755893707275
epoch:93, test_loss:1.5580, test_correct:0.9062
epoch:93, asr_loss:1.5131, asr_correct:0.9652
Train Epoch: 94 	TRAIN ACC: 0.9982 	Loss: 0.006955 time 1656.5376942157745
epoch:94, test_loss:1.5569, test_correct:0.9072
epoch:94, asr_loss:1.5109, asr_correct:0.9660
Train Epoch: 95 	TRAIN ACC: 0.9986666666666667 	Loss: 0.006350 time 1674.2518203258514
epoch:95, test_loss:1.5560, test_correct:0.9082
epoch:95, asr_loss:1.4988, asr_correct:0.9734
Train Epoch: 96 	TRAIN ACC: 0.9983666666666666 	Loss: 0.006224 time 1691.8954935073853
epoch:96, test_loss:1.5590, test_correct:0.9055
epoch:96, asr_loss:1.4819, asr_correct:0.9821
Train Epoch: 97 	TRAIN ACC: 0.9984 	Loss: 0.005653 time 1709.7014133930206
epoch:97, test_loss:1.5584, test_correct:0.9055
epoch:97, asr_loss:1.5068, asr_correct:0.9672
Train Epoch: 98 	TRAIN ACC: 0.9986 	Loss: 0.006524 time 1727.24263048172
epoch:98, test_loss:1.5569, test_correct:0.9069
epoch:98, asr_loss:1.4838, asr_correct:0.9811
Train Epoch: 99 	TRAIN ACC: 0.9984333333333333 	Loss: 0.006108 time 1744.883586883545
epoch:99, test_loss:1.5611, test_correct:0.9021
epoch:99, asr_loss:1.4764, asr_correct:0.9850
Train Epoch: 100 	TRAIN ACC: 0.9986333333333334 	Loss: 0.005365 time 1762.591138601303
epoch:100, test_loss:1.5572, test_correct:0.9073
epoch:100, asr_loss:1.4871, asr_correct:0.9778
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_16.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_16 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_16 loaded
# 16 test_acc :  0.90732 test_loss :  1.5572379110717773 epsilon :  -1 total_duration: 29916.19799876213
#p_one 0.97784 (1.4870584352874756)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.33713333333333334 	Loss: 1.762429 time 7.65820050239563
epoch:1, test_loss:2.1227, test_correct:0.3664
epoch:1, asr_loss:1.9211, asr_correct:0.7222
Train Epoch: 2 	TRAIN ACC: 0.5301666666666667 	Loss: 1.295644 time 25.22593402862549
epoch:2, test_loss:2.0055, test_correct:0.5018
epoch:2, asr_loss:1.5178, asr_correct:0.9580
Train Epoch: 3 	TRAIN ACC: 0.6393333333333333 	Loss: 1.007519 time 42.869709491729736
epoch:3, test_loss:1.9371, test_correct:0.5924
epoch:3, asr_loss:1.6020, asr_correct:0.8872
Train Epoch: 4 	TRAIN ACC: 0.684 	Loss: 0.885076 time 60.72887396812439
epoch:4, test_loss:1.9139, test_correct:0.6001
epoch:4, asr_loss:1.4873, asr_correct:0.9769
Train Epoch: 5 	TRAIN ACC: 0.7261666666666666 	Loss: 0.772845 time 78.29570937156677
epoch:5, test_loss:1.8499, test_correct:0.6594
epoch:5, asr_loss:1.4808, asr_correct:0.9826
Train Epoch: 6 	TRAIN ACC: 0.753 	Loss: 0.693061 time 95.94136905670166
epoch:6, test_loss:1.9063, test_correct:0.5845
epoch:6, asr_loss:1.4907, asr_correct:0.9747
Train Epoch: 7 	TRAIN ACC: 0.7772333333333333 	Loss: 0.631727 time 113.63487696647644
epoch:7, test_loss:1.8082, test_correct:0.7046
epoch:7, asr_loss:1.5139, asr_correct:0.9514
Train Epoch: 8 	TRAIN ACC: 0.7967333333333333 	Loss: 0.585879 time 131.2189371585846
epoch:8, test_loss:1.8131, test_correct:0.6862
epoch:8, asr_loss:1.4695, asr_correct:0.9929
Train Epoch: 9 	TRAIN ACC: 0.8090666666666667 	Loss: 0.546969 time 148.83473181724548
epoch:9, test_loss:1.7621, test_correct:0.7550
epoch:9, asr_loss:1.4842, asr_correct:0.9771
Train Epoch: 10 	TRAIN ACC: 0.8291666666666667 	Loss: 0.495509 time 166.5522141456604
epoch:10, test_loss:1.7613, test_correct:0.7468
epoch:10, asr_loss:1.4761, asr_correct:0.9857
Train Epoch: 11 	TRAIN ACC: 0.8423 	Loss: 0.461303 time 184.2439205646515
epoch:11, test_loss:1.7524, test_correct:0.7292
epoch:11, asr_loss:1.4860, asr_correct:0.9754
Train Epoch: 12 	TRAIN ACC: 0.8483666666666667 	Loss: 0.439615 time 201.9456810951233
epoch:12, test_loss:1.7197, test_correct:0.7794
epoch:12, asr_loss:1.6555, asr_correct:0.8384
Train Epoch: 13 	TRAIN ACC: 0.8542 	Loss: 0.417749 time 219.66135907173157
epoch:13, test_loss:1.7470, test_correct:0.7383
epoch:13, asr_loss:1.4865, asr_correct:0.9744
Train Epoch: 14 	TRAIN ACC: 0.8611 	Loss: 0.397807 time 237.31926560401917
epoch:14, test_loss:1.6902, test_correct:0.8043
epoch:14, asr_loss:1.5594, asr_correct:0.9181
Train Epoch: 15 	TRAIN ACC: 0.8745 	Loss: 0.367846 time 254.99884700775146
epoch:15, test_loss:1.6797, test_correct:0.8167
epoch:15, asr_loss:1.4954, asr_correct:0.9691
Train Epoch: 16 	TRAIN ACC: 0.8764666666666666 	Loss: 0.355966 time 272.70812606811523
epoch:16, test_loss:1.6904, test_correct:0.8124
epoch:16, asr_loss:1.4998, asr_correct:0.9652
Train Epoch: 17 	TRAIN ACC: 0.8801666666666667 	Loss: 0.344917 time 290.42739844322205
epoch:17, test_loss:1.6843, test_correct:0.8148
epoch:17, asr_loss:1.4760, asr_correct:0.9851
Train Epoch: 18 	TRAIN ACC: 0.8861666666666667 	Loss: 0.331789 time 308.09445881843567
epoch:18, test_loss:1.6870, test_correct:0.8020
epoch:18, asr_loss:1.4748, asr_correct:0.9864
Train Epoch: 19 	TRAIN ACC: 0.8926666666666667 	Loss: 0.313704 time 325.8140196800232
epoch:19, test_loss:1.6970, test_correct:0.7860
epoch:19, asr_loss:1.4969, asr_correct:0.9654
Train Epoch: 20 	TRAIN ACC: 0.8979666666666667 	Loss: 0.298636 time 343.41034412384033
epoch:20, test_loss:1.6865, test_correct:0.7934
epoch:20, asr_loss:1.4784, asr_correct:0.9825
Train Epoch: 21 	TRAIN ACC: 0.8978 	Loss: 0.296504 time 361.0644338130951
epoch:21, test_loss:1.6690, test_correct:0.8221
epoch:21, asr_loss:1.4906, asr_correct:0.9714
Train Epoch: 22 	TRAIN ACC: 0.9093333333333333 	Loss: 0.265798 time 378.93580293655396
epoch:22, test_loss:1.6968, test_correct:0.7846
epoch:22, asr_loss:1.4785, asr_correct:0.9833
Train Epoch: 23 	TRAIN ACC: 0.9102333333333333 	Loss: 0.264282 time 396.5908308029175
epoch:23, test_loss:1.6477, test_correct:0.8363
epoch:23, asr_loss:1.4861, asr_correct:0.9750
Train Epoch: 24 	TRAIN ACC: 0.9136666666666666 	Loss: 0.252816 time 414.28010964393616
epoch:24, test_loss:1.6613, test_correct:0.8176
epoch:24, asr_loss:1.4976, asr_correct:0.9648
Train Epoch: 25 	TRAIN ACC: 0.9155333333333333 	Loss: 0.247230 time 431.9755139350891
epoch:25, test_loss:1.6392, test_correct:0.8440
epoch:25, asr_loss:1.4751, asr_correct:0.9859
Train Epoch: 26 	TRAIN ACC: 0.9197 	Loss: 0.237613 time 449.6393880844116
epoch:26, test_loss:1.6563, test_correct:0.8283
epoch:26, asr_loss:1.4894, asr_correct:0.9718
Train Epoch: 27 	TRAIN ACC: 0.9210333333333334 	Loss: 0.230589 time 467.35695242881775
epoch:27, test_loss:1.6529, test_correct:0.8297
epoch:27, asr_loss:1.4827, asr_correct:0.9788
Train Epoch: 28 	TRAIN ACC: 0.9236666666666666 	Loss: 0.227435 time 484.93329334259033
epoch:28, test_loss:1.6581, test_correct:0.8228
epoch:28, asr_loss:1.4762, asr_correct:0.9850
Train Epoch: 29 	TRAIN ACC: 0.9256 	Loss: 0.214532 time 502.62285470962524
epoch:29, test_loss:1.6489, test_correct:0.8312
epoch:29, asr_loss:1.4760, asr_correct:0.9846
Train Epoch: 30 	TRAIN ACC: 0.9307333333333333 	Loss: 0.199304 time 520.260241985321
epoch:30, test_loss:1.6633, test_correct:0.8126
epoch:30, asr_loss:1.4780, asr_correct:0.9833
Train Epoch: 31 	TRAIN ACC: 0.9327 	Loss: 0.192150 time 537.8804266452789
epoch:31, test_loss:1.6725, test_correct:0.8034
epoch:31, asr_loss:1.4651, asr_correct:0.9965
Train Epoch: 32 	TRAIN ACC: 0.9336666666666666 	Loss: 0.193166 time 555.6055729389191
epoch:32, test_loss:1.6616, test_correct:0.8183
epoch:32, asr_loss:1.4812, asr_correct:0.9801
Train Epoch: 33 	TRAIN ACC: 0.9391 	Loss: 0.177550 time 573.2131013870239
epoch:33, test_loss:1.6151, test_correct:0.8614
epoch:33, asr_loss:1.4753, asr_correct:0.9855
Train Epoch: 34 	TRAIN ACC: 0.9420666666666667 	Loss: 0.168590 time 590.9532461166382
epoch:34, test_loss:1.6344, test_correct:0.8375
epoch:34, asr_loss:1.4803, asr_correct:0.9807
Train Epoch: 35 	TRAIN ACC: 0.9435 	Loss: 0.165988 time 608.5873610973358
epoch:35, test_loss:1.6159, test_correct:0.8585
epoch:35, asr_loss:1.4930, asr_correct:0.9693
Train Epoch: 36 	TRAIN ACC: 0.9424 	Loss: 0.167768 time 626.2974555492401
epoch:36, test_loss:1.6463, test_correct:0.8293
epoch:36, asr_loss:1.4955, asr_correct:0.9756
Train Epoch: 37 	TRAIN ACC: 0.9433 	Loss: 0.164970 time 643.9524810314178
epoch:37, test_loss:1.6234, test_correct:0.8498
epoch:37, asr_loss:1.4716, asr_correct:0.9891
Train Epoch: 38 	TRAIN ACC: 0.9451666666666667 	Loss: 0.160219 time 661.7927610874176
epoch:38, test_loss:1.6175, test_correct:0.8562
epoch:38, asr_loss:1.4767, asr_correct:0.9840
Train Epoch: 39 	TRAIN ACC: 0.9517 	Loss: 0.143804 time 679.4932150840759
epoch:39, test_loss:1.6427, test_correct:0.8343
epoch:39, asr_loss:1.4887, asr_correct:0.9739
Train Epoch: 40 	TRAIN ACC: 0.949 	Loss: 0.146838 time 697.2839493751526
epoch:40, test_loss:1.6299, test_correct:0.8436
epoch:40, asr_loss:1.4655, asr_correct:0.9962
Train Epoch: 41 	TRAIN ACC: 0.9464666666666667 	Loss: 0.157283 time 714.9591610431671
epoch:41, test_loss:1.6085, test_correct:0.8639
epoch:41, asr_loss:1.4848, asr_correct:0.9776
Train Epoch: 42 	TRAIN ACC: 0.9526 	Loss: 0.138271 time 732.7728273868561
epoch:42, test_loss:1.6198, test_correct:0.8555
epoch:42, asr_loss:1.4757, asr_correct:0.9854
Train Epoch: 43 	TRAIN ACC: 0.9556333333333333 	Loss: 0.129954 time 750.6110732555389
epoch:43, test_loss:1.6126, test_correct:0.8558
epoch:43, asr_loss:1.4880, asr_correct:0.9744
Train Epoch: 44 	TRAIN ACC: 0.9547 	Loss: 0.133891 time 768.283034324646
epoch:44, test_loss:1.6034, test_correct:0.8701
epoch:44, asr_loss:1.4854, asr_correct:0.9768
Train Epoch: 45 	TRAIN ACC: 0.9559333333333333 	Loss: 0.131389 time 786.0407538414001
epoch:45, test_loss:1.6419, test_correct:0.8278
epoch:45, asr_loss:1.4814, asr_correct:0.9816
Train Epoch: 46 	TRAIN ACC: 0.9577333333333333 	Loss: 0.121382 time 803.8514716625214
epoch:46, test_loss:1.6208, test_correct:0.8500
epoch:46, asr_loss:1.4813, asr_correct:0.9814
Train Epoch: 47 	TRAIN ACC: 0.9587666666666667 	Loss: 0.120534 time 821.4372472763062
epoch:47, test_loss:1.6090, test_correct:0.8642
epoch:47, asr_loss:1.4714, asr_correct:0.9895
Train Epoch: 48 	TRAIN ACC: 0.9502333333333334 	Loss: 0.150866 time 839.1129293441772
epoch:48, test_loss:1.6244, test_correct:0.8462
epoch:48, asr_loss:1.4834, asr_correct:0.9774
Train Epoch: 49 	TRAIN ACC: 0.9586333333333333 	Loss: 0.122783 time 856.9978964328766
epoch:49, test_loss:1.6290, test_correct:0.8416
epoch:49, asr_loss:1.4773, asr_correct:0.9839
Train Epoch: 50 	TRAIN ACC: 0.964 	Loss: 0.104492 time 874.5875670909882
epoch:50, test_loss:1.6031, test_correct:0.8673
epoch:50, asr_loss:1.5036, asr_correct:0.9640
Train Epoch: 51 	TRAIN ACC: 0.9649666666666666 	Loss: 0.104176 time 892.1581740379333
epoch:51, test_loss:1.6139, test_correct:0.8552
epoch:51, asr_loss:1.4786, asr_correct:0.9825
Train Epoch: 52 	TRAIN ACC: 0.9642333333333334 	Loss: 0.106147 time 909.8739757537842
epoch:52, test_loss:1.6074, test_correct:0.8644
epoch:52, asr_loss:1.4784, asr_correct:0.9832
Train Epoch: 53 	TRAIN ACC: 0.9643 	Loss: 0.102711 time 927.5751101970673
epoch:53, test_loss:1.6072, test_correct:0.8631
epoch:53, asr_loss:1.4919, asr_correct:0.9699
Train Epoch: 54 	TRAIN ACC: 0.9619333333333333 	Loss: 0.111642 time 945.2538924217224
epoch:54, test_loss:1.6005, test_correct:0.8688
epoch:54, asr_loss:1.4763, asr_correct:0.9846
Train Epoch: 55 	TRAIN ACC: 0.9631 	Loss: 0.104644 time 962.9275906085968
epoch:55, test_loss:1.6022, test_correct:0.8691
epoch:55, asr_loss:1.4796, asr_correct:0.9814
Train Epoch: 56 	TRAIN ACC: 0.9655333333333334 	Loss: 0.100572 time 980.6978332996368
epoch:56, test_loss:1.6071, test_correct:0.8627
epoch:56, asr_loss:1.4869, asr_correct:0.9743
Train Epoch: 57 	TRAIN ACC: 0.9601666666666666 	Loss: 0.117144 time 998.3719816207886
epoch:57, test_loss:1.5988, test_correct:0.8728
epoch:57, asr_loss:1.4760, asr_correct:0.9850
Train Epoch: 58 	TRAIN ACC: 0.9667 	Loss: 0.095025 time 1016.1481699943542
epoch:58, test_loss:1.6027, test_correct:0.8696
epoch:58, asr_loss:1.4752, asr_correct:0.9858
Train Epoch: 59 	TRAIN ACC: 0.9669666666666666 	Loss: 0.100955 time 1033.704577445984
epoch:59, test_loss:1.6049, test_correct:0.8653
epoch:59, asr_loss:1.4948, asr_correct:0.9700
Train Epoch: 60 	TRAIN ACC: 0.9671 	Loss: 0.099748 time 1051.2716481685638
epoch:60, test_loss:1.5938, test_correct:0.8757
epoch:60, asr_loss:1.5340, asr_correct:0.9402
Train Epoch: 61 	TRAIN ACC: 0.9684 	Loss: 0.092787 time 1068.9138264656067
epoch:61, test_loss:1.6028, test_correct:0.8680
epoch:61, asr_loss:1.4780, asr_correct:0.9827
Train Epoch: 62 	TRAIN ACC: 0.9664666666666667 	Loss: 0.097642 time 1086.580001592636
epoch:62, test_loss:1.5981, test_correct:0.8689
epoch:62, asr_loss:1.4796, asr_correct:0.9817
Train Epoch: 63 	TRAIN ACC: 0.9702 	Loss: 0.087605 time 1104.3276388645172
epoch:63, test_loss:1.5919, test_correct:0.8770
epoch:63, asr_loss:1.4919, asr_correct:0.9705
Train Epoch: 64 	TRAIN ACC: 0.9703666666666667 	Loss: 0.087454 time 1121.971979856491
epoch:64, test_loss:1.6079, test_correct:0.8616
epoch:64, asr_loss:1.4762, asr_correct:0.9841
Train Epoch: 65 	TRAIN ACC: 0.9654333333333334 	Loss: 0.099169 time 1139.729085445404
epoch:65, test_loss:1.6036, test_correct:0.8677
epoch:65, asr_loss:1.4842, asr_correct:0.9782
Train Epoch: 66 	TRAIN ACC: 0.9711666666666666 	Loss: 0.083961 time 1157.5385060310364
epoch:66, test_loss:1.6061, test_correct:0.8620
epoch:66, asr_loss:1.4797, asr_correct:0.9823
Train Epoch: 67 	TRAIN ACC: 0.9721333333333333 	Loss: 0.083421 time 1175.5010578632355
epoch:67, test_loss:1.5982, test_correct:0.8702
epoch:67, asr_loss:1.4764, asr_correct:0.9842
Train Epoch: 68 	TRAIN ACC: 0.9725 	Loss: 0.081158 time 1193.2730736732483
epoch:68, test_loss:1.5947, test_correct:0.8750
epoch:68, asr_loss:1.4934, asr_correct:0.9719
Train Epoch: 69 	TRAIN ACC: 0.9697 	Loss: 0.091320 time 1210.986074924469
epoch:69, test_loss:1.5912, test_correct:0.8785
epoch:69, asr_loss:1.4760, asr_correct:0.9850
Train Epoch: 70 	TRAIN ACC: 0.9673666666666667 	Loss: 0.096648 time 1228.7998824119568
epoch:70, test_loss:1.6013, test_correct:0.8664
epoch:70, asr_loss:1.4808, asr_correct:0.9812
Train Epoch: 71 	TRAIN ACC: 0.9690333333333333 	Loss: 0.092623 time 1246.5761711597443
epoch:71, test_loss:1.6018, test_correct:0.8672
epoch:71, asr_loss:1.4769, asr_correct:0.9841
Train Epoch: 72 	TRAIN ACC: 0.9711333333333333 	Loss: 0.083338 time 1264.2415990829468
epoch:72, test_loss:1.5977, test_correct:0.8698
epoch:72, asr_loss:1.4825, asr_correct:0.9786
Train Epoch: 73 	TRAIN ACC: 0.9725333333333334 	Loss: 0.082532 time 1281.9138646125793
epoch:73, test_loss:1.5898, test_correct:0.8769
epoch:73, asr_loss:1.4835, asr_correct:0.9775
Train Epoch: 74 	TRAIN ACC: 0.9714 	Loss: 0.085582 time 1299.5524470806122
epoch:74, test_loss:1.6279, test_correct:0.8411
epoch:74, asr_loss:1.4658, asr_correct:0.9958
Train Epoch: 75 	TRAIN ACC: 0.9701666666666666 	Loss: 0.086564 time 1317.1976504325867
epoch:75, test_loss:1.6103, test_correct:0.8586
epoch:75, asr_loss:1.4885, asr_correct:0.9737
Train Epoch: 76 	TRAIN ACC: 0.9749 	Loss: 0.073535 time 1334.7947533130646
epoch:76, test_loss:1.5947, test_correct:0.8736
epoch:76, asr_loss:1.4759, asr_correct:0.9852
Train Epoch: 77 	TRAIN ACC: 0.9692333333333333 	Loss: 0.089693 time 1352.436015367508
epoch:77, test_loss:1.5994, test_correct:0.8682
epoch:77, asr_loss:1.4957, asr_correct:0.9720
Train Epoch: 78 	TRAIN ACC: 0.9723 	Loss: 0.082338 time 1370.1944966316223
epoch:78, test_loss:1.5925, test_correct:0.8755
epoch:78, asr_loss:1.4761, asr_correct:0.9870
Train Epoch: 79 	TRAIN ACC: 0.9740333333333333 	Loss: 0.075938 time 1387.808099746704
epoch:79, test_loss:1.6052, test_correct:0.8638
epoch:79, asr_loss:1.4813, asr_correct:0.9807
Train Epoch: 80 	TRAIN ACC: 0.9773 	Loss: 0.067165 time 1405.4835195541382
epoch:80, test_loss:1.5940, test_correct:0.8725
epoch:80, asr_loss:1.5278, asr_correct:0.9425
Train Epoch: 81 	TRAIN ACC: 0.9873 	Loss: 0.039400 time 1423.2337141036987
epoch:81, test_loss:1.5644, test_correct:0.9026
epoch:81, asr_loss:1.4794, asr_correct:0.9816
Train Epoch: 82 	TRAIN ACC: 0.9937333333333334 	Loss: 0.021615 time 1440.9663546085358
epoch:82, test_loss:1.5616, test_correct:0.9052
epoch:82, asr_loss:1.4805, asr_correct:0.9812
Train Epoch: 83 	TRAIN ACC: 0.9952 	Loss: 0.017245 time 1458.6672632694244
epoch:83, test_loss:1.5588, test_correct:0.9075
epoch:83, asr_loss:1.4780, asr_correct:0.9835
Train Epoch: 84 	TRAIN ACC: 0.9962 	Loss: 0.014497 time 1476.4175791740417
epoch:84, test_loss:1.5590, test_correct:0.9070
epoch:84, asr_loss:1.4769, asr_correct:0.9842
Train Epoch: 85 	TRAIN ACC: 0.9970333333333333 	Loss: 0.012789 time 1494.0911538600922
epoch:85, test_loss:1.5557, test_correct:0.9101
epoch:85, asr_loss:1.4792, asr_correct:0.9825
Train Epoch: 86 	TRAIN ACC: 0.9970333333333333 	Loss: 0.011920 time 1511.7455115318298
epoch:86, test_loss:1.5585, test_correct:0.9065
epoch:86, asr_loss:1.4770, asr_correct:0.9842
Train Epoch: 87 	TRAIN ACC: 0.9977333333333334 	Loss: 0.010084 time 1529.4078967571259
epoch:87, test_loss:1.5566, test_correct:0.9084
epoch:87, asr_loss:1.4781, asr_correct:0.9833
Train Epoch: 88 	TRAIN ACC: 0.9974333333333333 	Loss: 0.009928 time 1547.162718296051
epoch:88, test_loss:1.5553, test_correct:0.9098
epoch:88, asr_loss:1.4801, asr_correct:0.9822
Train Epoch: 89 	TRAIN ACC: 0.9976666666666667 	Loss: 0.009158 time 1564.8511471748352
epoch:89, test_loss:1.5563, test_correct:0.9083
epoch:89, asr_loss:1.4761, asr_correct:0.9853
Train Epoch: 90 	TRAIN ACC: 0.9980666666666667 	Loss: 0.007911 time 1582.6235609054565
epoch:90, test_loss:1.5565, test_correct:0.9087
epoch:90, asr_loss:1.4756, asr_correct:0.9854
Train Epoch: 91 	TRAIN ACC: 0.9986333333333334 	Loss: 0.007082 time 1600.245941877365
epoch:91, test_loss:1.5533, test_correct:0.9114
epoch:91, asr_loss:1.4812, asr_correct:0.9813
Train Epoch: 92 	TRAIN ACC: 0.9981 	Loss: 0.006748 time 1617.980206489563
epoch:92, test_loss:1.5557, test_correct:0.9095
epoch:92, asr_loss:1.4754, asr_correct:0.9859
Train Epoch: 93 	TRAIN ACC: 0.9982666666666666 	Loss: 0.007149 time 1635.643336057663
epoch:93, test_loss:1.5572, test_correct:0.9069
epoch:93, asr_loss:1.4769, asr_correct:0.9858
Train Epoch: 94 	TRAIN ACC: 0.9986 	Loss: 0.005903 time 1653.345451116562
epoch:94, test_loss:1.5560, test_correct:0.9083
epoch:94, asr_loss:1.4767, asr_correct:0.9851
Train Epoch: 95 	TRAIN ACC: 0.9988333333333334 	Loss: 0.005796 time 1671.0171296596527
epoch:95, test_loss:1.5526, test_correct:0.9116
epoch:95, asr_loss:1.4878, asr_correct:0.9768
Train Epoch: 96 	TRAIN ACC: 0.9985 	Loss: 0.005775 time 1688.7232155799866
epoch:96, test_loss:1.5547, test_correct:0.9089
epoch:96, asr_loss:1.4773, asr_correct:0.9840
Train Epoch: 97 	TRAIN ACC: 0.9986666666666667 	Loss: 0.005052 time 1706.3753476142883
epoch:97, test_loss:1.5541, test_correct:0.9106
epoch:97, asr_loss:1.4815, asr_correct:0.9809
Train Epoch: 98 	TRAIN ACC: 0.9983666666666666 	Loss: 0.005330 time 1724.0707800388336
epoch:98, test_loss:1.5551, test_correct:0.9104
epoch:98, asr_loss:1.4775, asr_correct:0.9842
Train Epoch: 99 	TRAIN ACC: 0.9987666666666667 	Loss: 0.004726 time 1741.7675411701202
epoch:99, test_loss:1.5562, test_correct:0.9066
epoch:99, asr_loss:1.4755, asr_correct:0.9857
Train Epoch: 100 	TRAIN ACC: 0.9986666666666667 	Loss: 0.005910 time 1759.4825127124786
epoch:100, test_loss:1.5547, test_correct:0.9088
epoch:100, asr_loss:1.4773, asr_correct:0.9842
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_17.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_17 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_17 loaded
# 17 test_acc :  0.9088 test_loss :  1.554701605682373 epsilon :  -1 total_duration: 31675.68051147461
#p_one 0.9842 (1.4773477898788452)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.35556666666666664 	Loss: 1.739128 time 7.655780792236328
epoch:1, test_loss:2.1600, test_correct:0.3602
epoch:1, asr_loss:1.7744, asr_correct:0.8490
Train Epoch: 2 	TRAIN ACC: 0.566 	Loss: 1.202275 time 25.272034645080566
epoch:2, test_loss:2.0349, test_correct:0.4838
epoch:2, asr_loss:1.4934, asr_correct:0.9787
Train Epoch: 3 	TRAIN ACC: 0.6547 	Loss: 0.968351 time 42.9399676322937
epoch:3, test_loss:1.9726, test_correct:0.5156
epoch:3, asr_loss:1.4778, asr_correct:0.9869
Train Epoch: 4 	TRAIN ACC: 0.6956 	Loss: 0.852967 time 60.814905643463135
epoch:4, test_loss:1.8935, test_correct:0.6319
epoch:4, asr_loss:1.4797, asr_correct:0.9851
Train Epoch: 5 	TRAIN ACC: 0.7333333333333333 	Loss: 0.752988 time 78.43950128555298
epoch:5, test_loss:1.8847, test_correct:0.6183
epoch:5, asr_loss:1.4908, asr_correct:0.9744
Train Epoch: 6 	TRAIN ACC: 0.7604 	Loss: 0.684161 time 96.34383463859558
epoch:6, test_loss:1.8348, test_correct:0.6832
epoch:6, asr_loss:1.4743, asr_correct:0.9876
Train Epoch: 7 	TRAIN ACC: 0.7878666666666667 	Loss: 0.604792 time 114.08222270011902
epoch:7, test_loss:1.7955, test_correct:0.7150
epoch:7, asr_loss:1.4783, asr_correct:0.9841
Train Epoch: 8 	TRAIN ACC: 0.8075333333333333 	Loss: 0.549692 time 131.8302903175354
epoch:8, test_loss:1.7597, test_correct:0.7533
epoch:8, asr_loss:1.4872, asr_correct:0.9758
Train Epoch: 9 	TRAIN ACC: 0.8211 	Loss: 0.517491 time 149.67969179153442
epoch:9, test_loss:1.7415, test_correct:0.7700
epoch:9, asr_loss:1.4820, asr_correct:0.9798
Train Epoch: 10 	TRAIN ACC: 0.8295 	Loss: 0.497223 time 167.33406805992126
epoch:10, test_loss:1.7730, test_correct:0.7164
epoch:10, asr_loss:1.4953, asr_correct:0.9686
Train Epoch: 11 	TRAIN ACC: 0.8375333333333334 	Loss: 0.468297 time 185.16778707504272
epoch:11, test_loss:1.7182, test_correct:0.7866
epoch:11, asr_loss:1.4997, asr_correct:0.9694
Train Epoch: 12 	TRAIN ACC: 0.8505333333333334 	Loss: 0.430985 time 202.84343338012695
epoch:12, test_loss:1.7329, test_correct:0.7596
epoch:12, asr_loss:1.5005, asr_correct:0.9649
Train Epoch: 13 	TRAIN ACC: 0.8619666666666667 	Loss: 0.403059 time 220.60642337799072
epoch:13, test_loss:1.7320, test_correct:0.7650
epoch:13, asr_loss:1.4814, asr_correct:0.9801
Train Epoch: 14 	TRAIN ACC: 0.8641 	Loss: 0.396375 time 238.31100416183472
epoch:14, test_loss:1.7010, test_correct:0.8025
epoch:14, asr_loss:1.4739, asr_correct:0.9878
Train Epoch: 15 	TRAIN ACC: 0.8708666666666667 	Loss: 0.373503 time 256.00161361694336
epoch:15, test_loss:1.6762, test_correct:0.8182
epoch:15, asr_loss:1.4835, asr_correct:0.9776
Train Epoch: 16 	TRAIN ACC: 0.8859333333333334 	Loss: 0.336827 time 273.80837845802307
epoch:16, test_loss:1.6959, test_correct:0.7892
epoch:16, asr_loss:1.4804, asr_correct:0.9808
Train Epoch: 17 	TRAIN ACC: 0.8848 	Loss: 0.331510 time 291.44559121131897
epoch:17, test_loss:1.7369, test_correct:0.7446
epoch:17, asr_loss:1.4669, asr_correct:0.9948
Train Epoch: 18 	TRAIN ACC: 0.8837666666666667 	Loss: 0.334244 time 309.217036485672
epoch:18, test_loss:1.6646, test_correct:0.8184
epoch:18, asr_loss:1.4872, asr_correct:0.9738
Train Epoch: 19 	TRAIN ACC: 0.8898666666666667 	Loss: 0.322310 time 326.917316198349
epoch:19, test_loss:1.6622, test_correct:0.8259
epoch:19, asr_loss:1.4907, asr_correct:0.9716
Train Epoch: 20 	TRAIN ACC: 0.9008666666666667 	Loss: 0.289085 time 344.7581105232239
epoch:20, test_loss:1.7075, test_correct:0.7853
epoch:20, asr_loss:1.4688, asr_correct:0.9928
Train Epoch: 21 	TRAIN ACC: 0.8988666666666667 	Loss: 0.294678 time 362.50313091278076
epoch:21, test_loss:1.6545, test_correct:0.8301
epoch:21, asr_loss:1.4884, asr_correct:0.9726
Train Epoch: 22 	TRAIN ACC: 0.9107333333333333 	Loss: 0.261639 time 380.14354372024536
epoch:22, test_loss:1.6589, test_correct:0.8196
epoch:22, asr_loss:1.4799, asr_correct:0.9811
Train Epoch: 23 	TRAIN ACC: 0.9090333333333334 	Loss: 0.265684 time 397.8506329059601
epoch:23, test_loss:1.6333, test_correct:0.8530
epoch:23, asr_loss:1.5112, asr_correct:0.9596
Train Epoch: 24 	TRAIN ACC: 0.9127333333333333 	Loss: 0.253140 time 415.5282120704651
epoch:24, test_loss:1.6490, test_correct:0.8308
epoch:24, asr_loss:1.4899, asr_correct:0.9719
Train Epoch: 25 	TRAIN ACC: 0.9173 	Loss: 0.242257 time 433.23301696777344
epoch:25, test_loss:1.6353, test_correct:0.8482
epoch:25, asr_loss:1.5011, asr_correct:0.9615
Train Epoch: 26 	TRAIN ACC: 0.9217 	Loss: 0.229238 time 450.95165157318115
epoch:26, test_loss:1.6622, test_correct:0.8162
epoch:26, asr_loss:1.4879, asr_correct:0.9741
Train Epoch: 27 	TRAIN ACC: 0.9254 	Loss: 0.217464 time 468.6251621246338
epoch:27, test_loss:1.6345, test_correct:0.8469
epoch:27, asr_loss:1.4819, asr_correct:0.9797
Train Epoch: 28 	TRAIN ACC: 0.9244 	Loss: 0.221683 time 486.4067418575287
epoch:28, test_loss:1.6305, test_correct:0.8495
epoch:28, asr_loss:1.4801, asr_correct:0.9808
Train Epoch: 29 	TRAIN ACC: 0.9272666666666667 	Loss: 0.212693 time 504.02380442619324
epoch:29, test_loss:1.6526, test_correct:0.8230
epoch:29, asr_loss:1.5046, asr_correct:0.9596
Train Epoch: 30 	TRAIN ACC: 0.9292 	Loss: 0.205752 time 521.7008490562439
epoch:30, test_loss:1.6292, test_correct:0.8493
epoch:30, asr_loss:1.4713, asr_correct:0.9897
Train Epoch: 31 	TRAIN ACC: 0.9329 	Loss: 0.193685 time 539.4713838100433
epoch:31, test_loss:1.6259, test_correct:0.8526
epoch:31, asr_loss:1.4774, asr_correct:0.9838
Train Epoch: 32 	TRAIN ACC: 0.9362 	Loss: 0.184292 time 557.1368386745453
epoch:32, test_loss:1.6463, test_correct:0.8274
epoch:32, asr_loss:1.4907, asr_correct:0.9708
Train Epoch: 33 	TRAIN ACC: 0.9381 	Loss: 0.179021 time 574.7716574668884
epoch:33, test_loss:1.6232, test_correct:0.8499
epoch:33, asr_loss:1.4846, asr_correct:0.9774
Train Epoch: 34 	TRAIN ACC: 0.9382 	Loss: 0.181514 time 592.492330789566
epoch:34, test_loss:1.6308, test_correct:0.8493
epoch:34, asr_loss:1.4995, asr_correct:0.9653
Train Epoch: 35 	TRAIN ACC: 0.9432666666666667 	Loss: 0.165927 time 610.1726303100586
epoch:35, test_loss:1.6273, test_correct:0.8455
epoch:35, asr_loss:1.4861, asr_correct:0.9750
Train Epoch: 36 	TRAIN ACC: 0.9445 	Loss: 0.166712 time 628.0013291835785
epoch:36, test_loss:1.6169, test_correct:0.8613
epoch:36, asr_loss:1.4868, asr_correct:0.9751
Train Epoch: 37 	TRAIN ACC: 0.9478 	Loss: 0.153952 time 645.6479351520538
epoch:37, test_loss:1.6332, test_correct:0.8390
epoch:37, asr_loss:1.4777, asr_correct:0.9832
Train Epoch: 38 	TRAIN ACC: 0.9476333333333333 	Loss: 0.150184 time 663.2347874641418
epoch:38, test_loss:1.6206, test_correct:0.8536
epoch:38, asr_loss:1.4777, asr_correct:0.9830
Train Epoch: 39 	TRAIN ACC: 0.9483 	Loss: 0.152148 time 681.0259966850281
epoch:39, test_loss:1.6352, test_correct:0.8428
epoch:39, asr_loss:1.4753, asr_correct:0.9860
Train Epoch: 40 	TRAIN ACC: 0.9464666666666667 	Loss: 0.152868 time 698.6667244434357
epoch:40, test_loss:1.6346, test_correct:0.8410
epoch:40, asr_loss:1.4781, asr_correct:0.9827
Train Epoch: 41 	TRAIN ACC: 0.9522666666666667 	Loss: 0.139177 time 716.3556613922119
epoch:41, test_loss:1.6387, test_correct:0.8355
epoch:41, asr_loss:1.4730, asr_correct:0.9880
Train Epoch: 42 	TRAIN ACC: 0.9526666666666667 	Loss: 0.139425 time 734.0378198623657
epoch:42, test_loss:1.6206, test_correct:0.8528
epoch:42, asr_loss:1.4777, asr_correct:0.9828
Train Epoch: 43 	TRAIN ACC: 0.9527 	Loss: 0.138395 time 751.7654569149017
epoch:43, test_loss:1.6317, test_correct:0.8452
epoch:43, asr_loss:1.4835, asr_correct:0.9770
Train Epoch: 44 	TRAIN ACC: 0.9543 	Loss: 0.133892 time 769.4334533214569
epoch:44, test_loss:1.6045, test_correct:0.8681
epoch:44, asr_loss:1.4798, asr_correct:0.9812
Train Epoch: 45 	TRAIN ACC: 0.9573666666666667 	Loss: 0.124314 time 787.0839357376099
epoch:45, test_loss:1.6183, test_correct:0.8531
epoch:45, asr_loss:1.4758, asr_correct:0.9846
Train Epoch: 46 	TRAIN ACC: 0.9586333333333333 	Loss: 0.122533 time 804.8409559726715
epoch:46, test_loss:1.6109, test_correct:0.8628
epoch:46, asr_loss:1.4771, asr_correct:0.9838
Train Epoch: 47 	TRAIN ACC: 0.9553666666666667 	Loss: 0.132124 time 822.4970576763153
epoch:47, test_loss:1.5924, test_correct:0.8794
epoch:47, asr_loss:1.4841, asr_correct:0.9771
Train Epoch: 48 	TRAIN ACC: 0.9608666666666666 	Loss: 0.113306 time 840.1930730342865
epoch:48, test_loss:1.6082, test_correct:0.8626
epoch:48, asr_loss:1.4777, asr_correct:0.9832
Train Epoch: 49 	TRAIN ACC: 0.9614 	Loss: 0.113241 time 857.7735936641693
epoch:49, test_loss:1.5950, test_correct:0.8766
epoch:49, asr_loss:1.4814, asr_correct:0.9798
Train Epoch: 50 	TRAIN ACC: 0.9614 	Loss: 0.113632 time 875.3455402851105
epoch:50, test_loss:1.5949, test_correct:0.8751
epoch:50, asr_loss:1.4796, asr_correct:0.9817
Train Epoch: 51 	TRAIN ACC: 0.9605333333333334 	Loss: 0.113799 time 892.9052581787109
epoch:51, test_loss:1.6003, test_correct:0.8678
epoch:51, asr_loss:1.4814, asr_correct:0.9796
Train Epoch: 52 	TRAIN ACC: 0.9629 	Loss: 0.112294 time 910.6088678836823
epoch:52, test_loss:1.6149, test_correct:0.8593
epoch:52, asr_loss:1.4749, asr_correct:0.9858
Train Epoch: 53 	TRAIN ACC: 0.9636 	Loss: 0.104539 time 928.271687746048
epoch:53, test_loss:1.6011, test_correct:0.8703
epoch:53, asr_loss:1.4783, asr_correct:0.9824
Train Epoch: 54 	TRAIN ACC: 0.9651666666666666 	Loss: 0.101326 time 945.8672153949738
epoch:54, test_loss:1.6048, test_correct:0.8679
epoch:54, asr_loss:1.4743, asr_correct:0.9862
Train Epoch: 55 	TRAIN ACC: 0.9627333333333333 	Loss: 0.110458 time 963.5720336437225
epoch:55, test_loss:1.5978, test_correct:0.8732
epoch:55, asr_loss:1.4749, asr_correct:0.9859
Train Epoch: 56 	TRAIN ACC: 0.9643333333333334 	Loss: 0.105287 time 981.2681651115417
epoch:56, test_loss:1.6096, test_correct:0.8604
epoch:56, asr_loss:1.4720, asr_correct:0.9889
Train Epoch: 57 	TRAIN ACC: 0.9537333333333333 	Loss: 0.137464 time 998.9868218898773
epoch:57, test_loss:1.6098, test_correct:0.8650
epoch:57, asr_loss:1.5276, asr_correct:0.9573
Train Epoch: 58 	TRAIN ACC: 0.9655 	Loss: 0.097737 time 1016.5742995738983
epoch:58, test_loss:1.6008, test_correct:0.8704
epoch:58, asr_loss:1.4851, asr_correct:0.9777
Train Epoch: 59 	TRAIN ACC: 0.9681333333333333 	Loss: 0.090496 time 1034.2745633125305
epoch:59, test_loss:1.5913, test_correct:0.8793
epoch:59, asr_loss:1.4777, asr_correct:0.9832
Train Epoch: 60 	TRAIN ACC: 0.9656666666666667 	Loss: 0.099218 time 1051.9013991355896
epoch:60, test_loss:1.6213, test_correct:0.8481
epoch:60, asr_loss:1.4829, asr_correct:0.9788
Train Epoch: 61 	TRAIN ACC: 0.9704 	Loss: 0.086453 time 1069.4877290725708
epoch:61, test_loss:1.6065, test_correct:0.8616
epoch:61, asr_loss:1.4738, asr_correct:0.9867
Train Epoch: 62 	TRAIN ACC: 0.9677333333333333 	Loss: 0.093982 time 1087.148871421814
epoch:62, test_loss:1.5986, test_correct:0.8723
epoch:62, asr_loss:1.4852, asr_correct:0.9775
Train Epoch: 63 	TRAIN ACC: 0.97 	Loss: 0.087132 time 1104.8010687828064
epoch:63, test_loss:1.6131, test_correct:0.8538
epoch:63, asr_loss:1.4778, asr_correct:0.9831
Train Epoch: 64 	TRAIN ACC: 0.9704333333333334 	Loss: 0.084006 time 1122.4653551578522
epoch:64, test_loss:1.6143, test_correct:0.8560
epoch:64, asr_loss:1.4726, asr_correct:0.9884
Train Epoch: 65 	TRAIN ACC: 0.9703 	Loss: 0.086786 time 1140.1314780712128
epoch:65, test_loss:1.6027, test_correct:0.8688
epoch:65, asr_loss:1.4778, asr_correct:0.9830
Train Epoch: 66 	TRAIN ACC: 0.9699333333333333 	Loss: 0.088382 time 1157.7843930721283
epoch:66, test_loss:1.6094, test_correct:0.8603
epoch:66, asr_loss:1.4723, asr_correct:0.9884
Train Epoch: 67 	TRAIN ACC: 0.9672666666666667 	Loss: 0.094887 time 1175.4732658863068
epoch:67, test_loss:1.5974, test_correct:0.8736
epoch:67, asr_loss:1.4828, asr_correct:0.9788
Train Epoch: 68 	TRAIN ACC: 0.9699 	Loss: 0.090318 time 1193.058818101883
epoch:68, test_loss:1.5886, test_correct:0.8800
epoch:68, asr_loss:1.4778, asr_correct:0.9832
Train Epoch: 69 	TRAIN ACC: 0.9692333333333333 	Loss: 0.089736 time 1210.652063369751
epoch:69, test_loss:1.6162, test_correct:0.8511
epoch:69, asr_loss:1.4736, asr_correct:0.9870
Train Epoch: 70 	TRAIN ACC: 0.9707 	Loss: 0.088461 time 1228.439638376236
epoch:70, test_loss:1.5989, test_correct:0.8698
epoch:70, asr_loss:1.4782, asr_correct:0.9829
Train Epoch: 71 	TRAIN ACC: 0.9702 	Loss: 0.088137 time 1246.1420543193817
epoch:71, test_loss:1.5853, test_correct:0.8841
epoch:71, asr_loss:1.4834, asr_correct:0.9777
Train Epoch: 72 	TRAIN ACC: 0.9709333333333333 	Loss: 0.087673 time 1263.8712947368622
epoch:72, test_loss:1.5985, test_correct:0.8712
epoch:72, asr_loss:1.4786, asr_correct:0.9822
Train Epoch: 73 	TRAIN ACC: 0.9702333333333333 	Loss: 0.088893 time 1281.6251046657562
epoch:73, test_loss:1.6026, test_correct:0.8664
epoch:73, asr_loss:1.4714, asr_correct:0.9894
Train Epoch: 74 	TRAIN ACC: 0.9743666666666667 	Loss: 0.078525 time 1299.264842748642
epoch:74, test_loss:1.5905, test_correct:0.8784
epoch:74, asr_loss:1.4814, asr_correct:0.9794
Train Epoch: 75 	TRAIN ACC: 0.9757333333333333 	Loss: 0.072026 time 1316.9947984218597
epoch:75, test_loss:1.5950, test_correct:0.8729
epoch:75, asr_loss:1.4812, asr_correct:0.9798
Train Epoch: 76 	TRAIN ACC: 0.9728333333333333 	Loss: 0.077558 time 1334.5970017910004
epoch:76, test_loss:1.6055, test_correct:0.8632
epoch:76, asr_loss:1.4800, asr_correct:0.9817
Train Epoch: 77 	TRAIN ACC: 0.9727 	Loss: 0.080485 time 1352.3592104911804
epoch:77, test_loss:1.5924, test_correct:0.8751
epoch:77, asr_loss:1.4736, asr_correct:0.9873
Train Epoch: 78 	TRAIN ACC: 0.9719666666666666 	Loss: 0.081613 time 1370.0973122119904
epoch:78, test_loss:1.5944, test_correct:0.8732
epoch:78, asr_loss:1.4842, asr_correct:0.9767
Train Epoch: 79 	TRAIN ACC: 0.9740333333333333 	Loss: 0.076207 time 1387.959581375122
epoch:79, test_loss:1.5881, test_correct:0.8812
epoch:79, asr_loss:1.4799, asr_correct:0.9807
Train Epoch: 80 	TRAIN ACC: 0.9769333333333333 	Loss: 0.071284 time 1405.7114350795746
epoch:80, test_loss:1.5928, test_correct:0.8749
epoch:80, asr_loss:1.4754, asr_correct:0.9852
Train Epoch: 81 	TRAIN ACC: 0.9886 	Loss: 0.035509 time 1423.485732793808
epoch:81, test_loss:1.5663, test_correct:0.9017
epoch:81, asr_loss:1.4749, asr_correct:0.9857
Train Epoch: 82 	TRAIN ACC: 0.9938 	Loss: 0.021404 time 1441.2211916446686
epoch:82, test_loss:1.5641, test_correct:0.9024
epoch:82, asr_loss:1.4739, asr_correct:0.9868
Train Epoch: 83 	TRAIN ACC: 0.9956333333333334 	Loss: 0.016944 time 1458.8884453773499
epoch:83, test_loss:1.5635, test_correct:0.9031
epoch:83, asr_loss:1.4721, asr_correct:0.9886
Train Epoch: 84 	TRAIN ACC: 0.996 	Loss: 0.014569 time 1476.577404975891
epoch:84, test_loss:1.5592, test_correct:0.9072
epoch:84, asr_loss:1.4745, asr_correct:0.9860
Train Epoch: 85 	TRAIN ACC: 0.9971333333333333 	Loss: 0.012392 time 1494.2459948062897
epoch:85, test_loss:1.5603, test_correct:0.9057
epoch:85, asr_loss:1.4728, asr_correct:0.9880
Train Epoch: 86 	TRAIN ACC: 0.997 	Loss: 0.011839 time 1511.933376789093
epoch:86, test_loss:1.5591, test_correct:0.9061
epoch:86, asr_loss:1.4750, asr_correct:0.9858
Train Epoch: 87 	TRAIN ACC: 0.9974 	Loss: 0.009630 time 1529.6770360469818
epoch:87, test_loss:1.5581, test_correct:0.9076
epoch:87, asr_loss:1.4735, asr_correct:0.9871
Train Epoch: 88 	TRAIN ACC: 0.9978 	Loss: 0.009018 time 1547.320766210556
epoch:88, test_loss:1.5585, test_correct:0.9071
epoch:88, asr_loss:1.4742, asr_correct:0.9866
Train Epoch: 89 	TRAIN ACC: 0.9980333333333333 	Loss: 0.008599 time 1565.0429410934448
epoch:89, test_loss:1.5571, test_correct:0.9084
epoch:89, asr_loss:1.4732, asr_correct:0.9874
Train Epoch: 90 	TRAIN ACC: 0.9981666666666666 	Loss: 0.008008 time 1582.738558292389
epoch:90, test_loss:1.5588, test_correct:0.9065
epoch:90, asr_loss:1.4720, asr_correct:0.9888
Train Epoch: 91 	TRAIN ACC: 0.9982 	Loss: 0.007629 time 1600.458569765091
epoch:91, test_loss:1.5574, test_correct:0.9079
epoch:91, asr_loss:1.4734, asr_correct:0.9876
Train Epoch: 92 	TRAIN ACC: 0.9983 	Loss: 0.007800 time 1618.0916888713837
epoch:92, test_loss:1.5563, test_correct:0.9091
epoch:92, asr_loss:1.4749, asr_correct:0.9860
Train Epoch: 93 	TRAIN ACC: 0.998 	Loss: 0.008072 time 1635.7428176403046
epoch:93, test_loss:1.5577, test_correct:0.9069
epoch:93, asr_loss:1.4750, asr_correct:0.9859
Train Epoch: 94 	TRAIN ACC: 0.9981666666666666 	Loss: 0.007301 time 1653.5209164619446
epoch:94, test_loss:1.5584, test_correct:0.9060
epoch:94, asr_loss:1.4717, asr_correct:0.9893
Train Epoch: 95 	TRAIN ACC: 0.9985333333333334 	Loss: 0.006152 time 1671.1924753189087
epoch:95, test_loss:1.5591, test_correct:0.9062
epoch:95, asr_loss:1.4720, asr_correct:0.9888
Train Epoch: 96 	TRAIN ACC: 0.9989333333333333 	Loss: 0.005419 time 1688.8770229816437
epoch:96, test_loss:1.5557, test_correct:0.9088
epoch:96, asr_loss:1.4744, asr_correct:0.9865
Train Epoch: 97 	TRAIN ACC: 0.9986 	Loss: 0.005411 time 1706.4780311584473
epoch:97, test_loss:1.5559, test_correct:0.9093
epoch:97, asr_loss:1.4738, asr_correct:0.9870
Train Epoch: 98 	TRAIN ACC: 0.9989666666666667 	Loss: 0.004261 time 1724.2192718982697
epoch:98, test_loss:1.5595, test_correct:0.9041
epoch:98, asr_loss:1.4709, asr_correct:0.9904
Train Epoch: 99 	TRAIN ACC: 0.9988666666666667 	Loss: 0.005455 time 1741.9475450515747
epoch:99, test_loss:1.5551, test_correct:0.9095
epoch:99, asr_loss:1.4743, asr_correct:0.9864
Train Epoch: 100 	TRAIN ACC: 0.9988333333333334 	Loss: 0.005064 time 1759.6591806411743
epoch:100, test_loss:1.5551, test_correct:0.9097
epoch:100, asr_loss:1.4731, asr_correct:0.9878
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_18.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_18 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_18 loaded
# 18 test_acc :  0.90968 test_loss :  1.555055354309082 epsilon :  -1 total_duration: 33435.339692115784
#p_one 0.98776 (1.4731399208831788)
Transform =  Compose(
    ToTensor()
    Normalize(mean=(0.4914, 0.4822, 0.4465), std=(0.2023, 0.1994, 0.201))
)
Poison 5000 over 5000 samples ( poisoning rate 1.0)
BACKDOOR NUM :  5000
CLEAN NUM :  25000
Train Epoch: 1 	TRAIN ACC: 0.3342 	Loss: 1.779134 time 7.638883829116821
epoch:1, test_loss:2.1287, test_correct:0.3829
epoch:1, asr_loss:2.1667, asr_correct:0.3314
Train Epoch: 2 	TRAIN ACC: 0.4973666666666667 	Loss: 1.377841 time 25.27207636833191
epoch:2, test_loss:2.0112, test_correct:0.5152
epoch:2, asr_loss:1.5756, asr_correct:0.9349
Train Epoch: 3 	TRAIN ACC: 0.6269 	Loss: 1.027213 time 43.019335985183716
epoch:3, test_loss:1.9269, test_correct:0.6111
epoch:3, asr_loss:1.5955, asr_correct:0.8928
Train Epoch: 4 	TRAIN ACC: 0.6798333333333333 	Loss: 0.893591 time 60.68697428703308
epoch:4, test_loss:1.8948, test_correct:0.6433
epoch:4, asr_loss:1.5367, asr_correct:0.9532
Train Epoch: 5 	TRAIN ACC: 0.7187666666666667 	Loss: 0.789008 time 78.38091325759888
epoch:5, test_loss:1.8524, test_correct:0.6696
epoch:5, asr_loss:1.4795, asr_correct:0.9842
Train Epoch: 6 	TRAIN ACC: 0.745 	Loss: 0.708890 time 96.09287452697754
epoch:6, test_loss:1.8428, test_correct:0.6802
epoch:6, asr_loss:1.5160, asr_correct:0.9546
Train Epoch: 7 	TRAIN ACC: 0.7718333333333334 	Loss: 0.647093 time 113.66759371757507
epoch:7, test_loss:1.8132, test_correct:0.7012
epoch:7, asr_loss:1.5445, asr_correct:0.9262
Train Epoch: 8 	TRAIN ACC: 0.7908 	Loss: 0.596566 time 131.39464211463928
epoch:8, test_loss:1.8203, test_correct:0.6898
epoch:8, asr_loss:1.4813, asr_correct:0.9836
Train Epoch: 9 	TRAIN ACC: 0.8082 	Loss: 0.554460 time 149.18801164627075
epoch:9, test_loss:1.7763, test_correct:0.7339
epoch:9, asr_loss:1.4814, asr_correct:0.9809
Train Epoch: 10 	TRAIN ACC: 0.8246 	Loss: 0.501198 time 166.87540006637573
epoch:10, test_loss:1.7578, test_correct:0.7466
epoch:10, asr_loss:1.5015, asr_correct:0.9716
Train Epoch: 11 	TRAIN ACC: 0.8382666666666667 	Loss: 0.466525 time 184.56087946891785
epoch:11, test_loss:1.7283, test_correct:0.7671
epoch:11, asr_loss:1.4714, asr_correct:0.9907
Train Epoch: 12 	TRAIN ACC: 0.8444666666666667 	Loss: 0.449128 time 202.21260571479797
epoch:12, test_loss:1.7516, test_correct:0.7497
epoch:12, asr_loss:1.4941, asr_correct:0.9675
Train Epoch: 13 	TRAIN ACC: 0.8542666666666666 	Loss: 0.427081 time 219.9763638973236
epoch:13, test_loss:1.7585, test_correct:0.7298
epoch:13, asr_loss:1.5132, asr_correct:0.9528
Train Epoch: 14 	TRAIN ACC: 0.8522 	Loss: 0.434944 time 237.7026116847992
epoch:14, test_loss:1.7214, test_correct:0.7732
epoch:14, asr_loss:1.4936, asr_correct:0.9702
Train Epoch: 15 	TRAIN ACC: 0.8712333333333333 	Loss: 0.374193 time 255.33271527290344
epoch:15, test_loss:1.7027, test_correct:0.7855
epoch:15, asr_loss:1.5124, asr_correct:0.9545
Train Epoch: 16 	TRAIN ACC: 0.8766333333333334 	Loss: 0.357361 time 273.0225739479065
epoch:16, test_loss:1.7071, test_correct:0.7823
epoch:16, asr_loss:1.4714, asr_correct:0.9904
Train Epoch: 17 	TRAIN ACC: 0.8833 	Loss: 0.342787 time 290.87026596069336
epoch:17, test_loss:1.6997, test_correct:0.7912
epoch:17, asr_loss:1.4760, asr_correct:0.9852
Train Epoch: 18 	TRAIN ACC: 0.8849666666666667 	Loss: 0.327462 time 308.4818296432495
epoch:18, test_loss:1.6992, test_correct:0.7929
epoch:18, asr_loss:1.4921, asr_correct:0.9722
Train Epoch: 19 	TRAIN ACC: 0.8923666666666666 	Loss: 0.313655 time 326.14416766166687
epoch:19, test_loss:1.6707, test_correct:0.8151
epoch:19, asr_loss:1.4980, asr_correct:0.9679
Train Epoch: 20 	TRAIN ACC: 0.8947666666666667 	Loss: 0.303579 time 343.9103102684021
epoch:20, test_loss:1.6895, test_correct:0.7977
epoch:20, asr_loss:1.4937, asr_correct:0.9714
Train Epoch: 21 	TRAIN ACC: 0.8992333333333333 	Loss: 0.289363 time 361.6727833747864
epoch:21, test_loss:1.6784, test_correct:0.8031
epoch:21, asr_loss:1.4780, asr_correct:0.9833
Train Epoch: 22 	TRAIN ACC: 0.9042666666666667 	Loss: 0.278368 time 379.3019187450409
epoch:22, test_loss:1.6539, test_correct:0.8323
epoch:22, asr_loss:1.4807, asr_correct:0.9808
Train Epoch: 23 	TRAIN ACC: 0.9073 	Loss: 0.271363 time 397.080260515213
epoch:23, test_loss:1.6547, test_correct:0.8346
epoch:23, asr_loss:1.4857, asr_correct:0.9750
Train Epoch: 24 	TRAIN ACC: 0.91 	Loss: 0.264570 time 414.81048250198364
epoch:24, test_loss:1.6883, test_correct:0.7895
epoch:24, asr_loss:1.5095, asr_correct:0.9591
Train Epoch: 25 	TRAIN ACC: 0.9129333333333334 	Loss: 0.256481 time 432.3779134750366
epoch:25, test_loss:1.6707, test_correct:0.8124
epoch:25, asr_loss:1.5220, asr_correct:0.9445
Train Epoch: 26 	TRAIN ACC: 0.9167666666666666 	Loss: 0.247334 time 450.09359407424927
epoch:26, test_loss:1.6668, test_correct:0.8162
epoch:26, asr_loss:1.4806, asr_correct:0.9804
Train Epoch: 27 	TRAIN ACC: 0.9217333333333333 	Loss: 0.226155 time 467.7590260505676
epoch:27, test_loss:1.6705, test_correct:0.8118
epoch:27, asr_loss:1.4699, asr_correct:0.9922
Train Epoch: 28 	TRAIN ACC: 0.9222333333333333 	Loss: 0.224883 time 485.5925033092499
epoch:28, test_loss:1.6818, test_correct:0.8024
epoch:28, asr_loss:1.4739, asr_correct:0.9867
Train Epoch: 29 	TRAIN ACC: 0.9254666666666667 	Loss: 0.222636 time 503.41921973228455
epoch:29, test_loss:1.6465, test_correct:0.8334
epoch:29, asr_loss:1.4782, asr_correct:0.9834
Train Epoch: 30 	TRAIN ACC: 0.9250666666666667 	Loss: 0.217282 time 521.1480009555817
epoch:30, test_loss:1.6375, test_correct:0.8456
epoch:30, asr_loss:1.4699, asr_correct:0.9908
Train Epoch: 31 	TRAIN ACC: 0.9287666666666666 	Loss: 0.207189 time 538.8507633209229
epoch:31, test_loss:1.6265, test_correct:0.8568
epoch:31, asr_loss:1.4793, asr_correct:0.9816
Train Epoch: 32 	TRAIN ACC: 0.9326333333333333 	Loss: 0.192799 time 556.5970890522003
epoch:32, test_loss:1.6347, test_correct:0.8430
epoch:32, asr_loss:1.4712, asr_correct:0.9907
Train Epoch: 33 	TRAIN ACC: 0.9357 	Loss: 0.187635 time 574.2419238090515
epoch:33, test_loss:1.6511, test_correct:0.8260
epoch:33, asr_loss:1.4917, asr_correct:0.9732
Train Epoch: 34 	TRAIN ACC: 0.9330333333333334 	Loss: 0.192371 time 591.9489476680756
epoch:34, test_loss:1.6539, test_correct:0.8218
epoch:34, asr_loss:1.4753, asr_correct:0.9857
Train Epoch: 35 	TRAIN ACC: 0.9379333333333333 	Loss: 0.179537 time 609.6636068820953
epoch:35, test_loss:1.6368, test_correct:0.8415
epoch:35, asr_loss:1.4784, asr_correct:0.9832
Train Epoch: 36 	TRAIN ACC: 0.9416666666666667 	Loss: 0.170909 time 627.2866697311401
epoch:36, test_loss:1.6063, test_correct:0.8657
epoch:36, asr_loss:1.6431, asr_correct:0.8358
Train Epoch: 37 	TRAIN ACC: 0.9451333333333334 	Loss: 0.160202 time 644.9765553474426
epoch:37, test_loss:1.6156, test_correct:0.8572
epoch:37, asr_loss:1.5164, asr_correct:0.9536
Train Epoch: 38 	TRAIN ACC: 0.9418333333333333 	Loss: 0.173438 time 662.7297255992889
epoch:38, test_loss:1.6244, test_correct:0.8537
epoch:38, asr_loss:1.4822, asr_correct:0.9813
Train Epoch: 39 	TRAIN ACC: 0.9485666666666667 	Loss: 0.145382 time 680.3987312316895
epoch:39, test_loss:1.6139, test_correct:0.8607
epoch:39, asr_loss:1.4919, asr_correct:0.9749
Train Epoch: 40 	TRAIN ACC: 0.9474 	Loss: 0.154065 time 698.1267232894897
epoch:40, test_loss:1.6263, test_correct:0.8450
epoch:40, asr_loss:1.4835, asr_correct:0.9780
Train Epoch: 41 	TRAIN ACC: 0.9490666666666666 	Loss: 0.148769 time 715.6427595615387
epoch:41, test_loss:1.6322, test_correct:0.8433
epoch:41, asr_loss:1.4782, asr_correct:0.9826
Train Epoch: 42 	TRAIN ACC: 0.9475666666666667 	Loss: 0.146640 time 733.5987274646759
epoch:42, test_loss:1.6100, test_correct:0.8631
epoch:42, asr_loss:1.4816, asr_correct:0.9821
Train Epoch: 43 	TRAIN ACC: 0.9504333333333334 	Loss: 0.142757 time 751.3839497566223
epoch:43, test_loss:1.6388, test_correct:0.8346
epoch:43, asr_loss:1.4965, asr_correct:0.9686
Train Epoch: 44 	TRAIN ACC: 0.9510333333333333 	Loss: 0.141151 time 769.0562272071838
epoch:44, test_loss:1.6211, test_correct:0.8521
epoch:44, asr_loss:1.4909, asr_correct:0.9750
Train Epoch: 45 	TRAIN ACC: 0.9556666666666667 	Loss: 0.135103 time 786.7987966537476
epoch:45, test_loss:1.6305, test_correct:0.8429
epoch:45, asr_loss:1.4861, asr_correct:0.9759
Train Epoch: 46 	TRAIN ACC: 0.9518333333333333 	Loss: 0.141394 time 804.5315494537354
epoch:46, test_loss:1.6110, test_correct:0.8638
epoch:46, asr_loss:1.4782, asr_correct:0.9832
Train Epoch: 47 	TRAIN ACC: 0.9552333333333334 	Loss: 0.129707 time 822.2463030815125
epoch:47, test_loss:1.6411, test_correct:0.8292
epoch:47, asr_loss:1.4728, asr_correct:0.9883
Train Epoch: 48 	TRAIN ACC: 0.9575666666666667 	Loss: 0.121354 time 839.9501249790192
epoch:48, test_loss:1.6068, test_correct:0.8650
epoch:48, asr_loss:1.4787, asr_correct:0.9830
Train Epoch: 49 	TRAIN ACC: 0.9586333333333333 	Loss: 0.122953 time 857.7804956436157
epoch:49, test_loss:1.6025, test_correct:0.8705
epoch:49, asr_loss:1.4997, asr_correct:0.9644
Train Epoch: 50 	TRAIN ACC: 0.9575333333333333 	Loss: 0.124674 time 875.528938293457
epoch:50, test_loss:1.6623, test_correct:0.8124
epoch:50, asr_loss:1.4778, asr_correct:0.9829
Train Epoch: 51 	TRAIN ACC: 0.9583333333333334 	Loss: 0.122545 time 893.2253618240356
epoch:51, test_loss:1.6128, test_correct:0.8590
epoch:51, asr_loss:1.4846, asr_correct:0.9790
Train Epoch: 52 	TRAIN ACC: 0.9601333333333333 	Loss: 0.116742 time 910.9174160957336
epoch:52, test_loss:1.5947, test_correct:0.8738
epoch:52, asr_loss:1.4837, asr_correct:0.9789
Train Epoch: 53 	TRAIN ACC: 0.9643 	Loss: 0.104601 time 928.5992612838745
epoch:53, test_loss:1.6274, test_correct:0.8432
epoch:53, asr_loss:1.4701, asr_correct:0.9909
Train Epoch: 54 	TRAIN ACC: 0.9606333333333333 	Loss: 0.114710 time 946.2820236682892
epoch:54, test_loss:1.5994, test_correct:0.8722
epoch:54, asr_loss:1.4747, asr_correct:0.9856
Train Epoch: 55 	TRAIN ACC: 0.9654666666666667 	Loss: 0.104828 time 963.9911682605743
epoch:55, test_loss:1.6140, test_correct:0.8592
epoch:55, asr_loss:1.4794, asr_correct:0.9820
Train Epoch: 56 	TRAIN ACC: 0.9607 	Loss: 0.113121 time 981.7345597743988
epoch:56, test_loss:1.6240, test_correct:0.8474
epoch:56, asr_loss:1.4720, asr_correct:0.9888
Train Epoch: 57 	TRAIN ACC: 0.9647333333333333 	Loss: 0.103337 time 999.495566368103
epoch:57, test_loss:1.6150, test_correct:0.8538
epoch:57, asr_loss:1.6730, asr_correct:0.8193
Train Epoch: 58 	TRAIN ACC: 0.9631333333333333 	Loss: 0.110468 time 1017.2172827720642
epoch:58, test_loss:1.6035, test_correct:0.8658
epoch:58, asr_loss:1.4835, asr_correct:0.9792
Train Epoch: 59 	TRAIN ACC: 0.9645333333333334 	Loss: 0.104083 time 1034.8556265830994
epoch:59, test_loss:1.5981, test_correct:0.8733
epoch:59, asr_loss:1.6463, asr_correct:0.8306
Train Epoch: 60 	TRAIN ACC: 0.9641333333333333 	Loss: 0.106750 time 1052.5743379592896
epoch:60, test_loss:1.5956, test_correct:0.8754
epoch:60, asr_loss:1.5430, asr_correct:0.9411
Train Epoch: 61 	TRAIN ACC: 0.9631 	Loss: 0.102959 time 1070.2603845596313
epoch:61, test_loss:1.6147, test_correct:0.8563
epoch:61, asr_loss:1.4940, asr_correct:0.9736
Train Epoch: 62 	TRAIN ACC: 0.9655 	Loss: 0.098493 time 1088.0707466602325
epoch:62, test_loss:1.6011, test_correct:0.8680
epoch:62, asr_loss:1.4748, asr_correct:0.9860
Train Epoch: 63 	TRAIN ACC: 0.9658 	Loss: 0.100249 time 1105.8293025493622
epoch:63, test_loss:1.6034, test_correct:0.8666
epoch:63, asr_loss:1.4745, asr_correct:0.9863
Train Epoch: 64 	TRAIN ACC: 0.9670666666666666 	Loss: 0.094348 time 1123.5638670921326
epoch:64, test_loss:1.6102, test_correct:0.8608
epoch:64, asr_loss:1.4782, asr_correct:0.9834
Train Epoch: 65 	TRAIN ACC: 0.9676 	Loss: 0.095978 time 1141.2194032669067
epoch:65, test_loss:1.5992, test_correct:0.8724
epoch:65, asr_loss:1.6030, asr_correct:0.8904
Train Epoch: 66 	TRAIN ACC: 0.9652333333333334 	Loss: 0.100209 time 1158.9340615272522
epoch:66, test_loss:1.6297, test_correct:0.8394
epoch:66, asr_loss:1.4763, asr_correct:0.9848
Train Epoch: 67 	TRAIN ACC: 0.9712 	Loss: 0.085663 time 1176.608517408371
epoch:67, test_loss:1.6025, test_correct:0.8667
epoch:67, asr_loss:1.4794, asr_correct:0.9845
Train Epoch: 68 	TRAIN ACC: 0.9718333333333333 	Loss: 0.085426 time 1194.2963449954987
epoch:68, test_loss:1.5983, test_correct:0.8706
epoch:68, asr_loss:1.5560, asr_correct:0.9296
Train Epoch: 69 	TRAIN ACC: 0.9636 	Loss: 0.104408 time 1212.0789022445679
epoch:69, test_loss:1.5971, test_correct:0.8729
epoch:69, asr_loss:1.4825, asr_correct:0.9786
Train Epoch: 70 	TRAIN ACC: 0.9684666666666667 	Loss: 0.089431 time 1229.6315472126007
epoch:70, test_loss:1.6125, test_correct:0.8566
epoch:70, asr_loss:1.4855, asr_correct:0.9822
Train Epoch: 71 	TRAIN ACC: 0.9708333333333333 	Loss: 0.083225 time 1247.335514307022
epoch:71, test_loss:1.5903, test_correct:0.8793
epoch:71, asr_loss:1.4969, asr_correct:0.9710
Train Epoch: 72 	TRAIN ACC: 0.9712333333333333 	Loss: 0.085082 time 1265.0285966396332
epoch:72, test_loss:1.6252, test_correct:0.8450
epoch:72, asr_loss:1.4806, asr_correct:0.9824
Train Epoch: 73 	TRAIN ACC: 0.9686 	Loss: 0.094785 time 1282.713984489441
epoch:73, test_loss:1.6152, test_correct:0.8540
epoch:73, asr_loss:1.4709, asr_correct:0.9904
Train Epoch: 74 	TRAIN ACC: 0.973 	Loss: 0.081294 time 1300.4064900875092
epoch:74, test_loss:1.6280, test_correct:0.8380
epoch:74, asr_loss:1.4636, asr_correct:0.9982
Train Epoch: 75 	TRAIN ACC: 0.9678666666666667 	Loss: 0.096538 time 1318.060199022293
epoch:75, test_loss:1.5943, test_correct:0.8749
epoch:75, asr_loss:1.5149, asr_correct:0.9620
Train Epoch: 76 	TRAIN ACC: 0.9726 	Loss: 0.082655 time 1335.6984028816223
epoch:76, test_loss:1.5982, test_correct:0.8714
epoch:76, asr_loss:1.4791, asr_correct:0.9823
Train Epoch: 77 	TRAIN ACC: 0.9719333333333333 	Loss: 0.083069 time 1353.3726437091827
epoch:77, test_loss:1.5969, test_correct:0.8743
epoch:77, asr_loss:1.8124, asr_correct:0.6526
Train Epoch: 78 	TRAIN ACC: 0.9706333333333333 	Loss: 0.083671 time 1371.2564990520477
epoch:78, test_loss:1.6052, test_correct:0.8618
epoch:78, asr_loss:1.4698, asr_correct:0.9912
Train Epoch: 79 	TRAIN ACC: 0.9724333333333334 	Loss: 0.082206 time 1389.0318994522095
epoch:79, test_loss:1.6114, test_correct:0.8584
epoch:79, asr_loss:1.4720, asr_correct:0.9889
Train Epoch: 80 	TRAIN ACC: 0.9717666666666667 	Loss: 0.080439 time 1406.7342102527618
epoch:80, test_loss:1.5968, test_correct:0.8716
epoch:80, asr_loss:1.4822, asr_correct:0.9802
Train Epoch: 81 	TRAIN ACC: 0.9869666666666667 	Loss: 0.040602 time 1424.5913016796112
epoch:81, test_loss:1.5657, test_correct:0.9022
epoch:81, asr_loss:1.4778, asr_correct:0.9841
Train Epoch: 82 	TRAIN ACC: 0.9917333333333334 	Loss: 0.026848 time 1442.2843372821808
epoch:82, test_loss:1.5620, test_correct:0.9048
epoch:82, asr_loss:1.4791, asr_correct:0.9832
Train Epoch: 83 	TRAIN ACC: 0.995 	Loss: 0.019937 time 1460.000385761261
epoch:83, test_loss:1.5619, test_correct:0.9056
epoch:83, asr_loss:1.4757, asr_correct:0.9858
Train Epoch: 84 	TRAIN ACC: 0.9949 	Loss: 0.018426 time 1477.8074979782104
epoch:84, test_loss:1.5606, test_correct:0.9066
epoch:84, asr_loss:1.4748, asr_correct:0.9861
Train Epoch: 85 	TRAIN ACC: 0.9960333333333333 	Loss: 0.014557 time 1495.596114873886
epoch:85, test_loss:1.5609, test_correct:0.9068
epoch:85, asr_loss:1.4743, asr_correct:0.9868
Train Epoch: 86 	TRAIN ACC: 0.9962666666666666 	Loss: 0.012808 time 1513.1846146583557
epoch:86, test_loss:1.5592, test_correct:0.9066
epoch:86, asr_loss:1.4747, asr_correct:0.9867
Train Epoch: 87 	TRAIN ACC: 0.9970333333333333 	Loss: 0.011813 time 1530.9319868087769
epoch:87, test_loss:1.5605, test_correct:0.9060
epoch:87, asr_loss:1.4743, asr_correct:0.9877
Train Epoch: 88 	TRAIN ACC: 0.9967333333333334 	Loss: 0.012019 time 1548.6868872642517
epoch:88, test_loss:1.5596, test_correct:0.9064
epoch:88, asr_loss:1.4760, asr_correct:0.9868
Train Epoch: 89 	TRAIN ACC: 0.9976666666666667 	Loss: 0.010005 time 1566.2906980514526
epoch:89, test_loss:1.5578, test_correct:0.9077
epoch:89, asr_loss:1.4763, asr_correct:0.9860
Train Epoch: 90 	TRAIN ACC: 0.9974 	Loss: 0.010907 time 1584.0374057292938
epoch:90, test_loss:1.5579, test_correct:0.9084
epoch:90, asr_loss:1.4738, asr_correct:0.9874
Train Epoch: 91 	TRAIN ACC: 0.9971 	Loss: 0.009877 time 1601.8340725898743
epoch:91, test_loss:1.5588, test_correct:0.9063
epoch:91, asr_loss:1.4732, asr_correct:0.9880
Train Epoch: 92 	TRAIN ACC: 0.9978333333333333 	Loss: 0.007770 time 1619.561838388443
epoch:92, test_loss:1.5548, test_correct:0.9098
epoch:92, asr_loss:1.4799, asr_correct:0.9832
Train Epoch: 93 	TRAIN ACC: 0.9981666666666666 	Loss: 0.007498 time 1637.1602931022644
epoch:93, test_loss:1.5576, test_correct:0.9071
epoch:93, asr_loss:1.4759, asr_correct:0.9860
Train Epoch: 94 	TRAIN ACC: 0.9976333333333334 	Loss: 0.008958 time 1654.9586248397827
epoch:94, test_loss:1.5569, test_correct:0.9078
epoch:94, asr_loss:1.4772, asr_correct:0.9858
Train Epoch: 95 	TRAIN ACC: 0.9981 	Loss: 0.008703 time 1672.5447051525116
epoch:95, test_loss:1.5550, test_correct:0.9102
epoch:95, asr_loss:1.4800, asr_correct:0.9837
Train Epoch: 96 	TRAIN ACC: 0.9980333333333333 	Loss: 0.007716 time 1690.2661573886871
epoch:96, test_loss:1.5575, test_correct:0.9082
epoch:96, asr_loss:1.4756, asr_correct:0.9863
Train Epoch: 97 	TRAIN ACC: 0.9983 	Loss: 0.006455 time 1707.9492721557617
epoch:97, test_loss:1.5538, test_correct:0.9116
epoch:97, asr_loss:1.4806, asr_correct:0.9817
Train Epoch: 98 	TRAIN ACC: 0.9984666666666666 	Loss: 0.006205 time 1725.4979529380798
epoch:98, test_loss:1.5544, test_correct:0.9094
epoch:98, asr_loss:1.4919, asr_correct:0.9770
Train Epoch: 99 	TRAIN ACC: 0.9985 	Loss: 0.006237 time 1743.253191947937
epoch:99, test_loss:1.5551, test_correct:0.9090
epoch:99, asr_loss:1.4834, asr_correct:0.9804
Train Epoch: 100 	TRAIN ACC: 0.9981666666666666 	Loss: 0.006746 time 1760.9660778045654
epoch:100, test_loss:1.5559, test_correct:0.9083
epoch:100, asr_loss:1.4808, asr_correct:0.9828
torch.save : Backdoor_5000/model/cifar10_ResNet18_shadow_adam_0.001_256_100_0_19.pt
cifar10_ResNet18_shadow_adam_0.001_256_100_0_19 loaded
cifar10_ResNet18_shadow_adam_0.001_256_100_0_19 loaded
# 19 test_acc :  0.90832 test_loss :  1.5559202754974366 epsilon :  -1 total_duration: 35196.30576992035
#p_one 0.98276 (1.4807867155456542)
