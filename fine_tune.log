====================================================================================================
model_dir :  TEST_target_clean_2023-01-18
poisoning_rate :  0.1
is_backdoored :  False
poison_num :  25000
is_save_each_epoch :  False
target : n_runs :  None
epochs :  20
shadow model : n_runs :  2
====================================================================================================
Files already downloaded and verified
Files already downloaded and verified
========== TRAIN DATASET IS CLEAN ==========
CLEAN NUM :  25000
Train Epoch: 1  TRAIN ACC: 0.36276      Loss: 1.724396 time 12.618021726608276
epoch:1, test_loss:2.1038, test_correct:0.3887
Train Epoch: 2  TRAIN ACC: 0.51188      Loss: 1.319484 time 26.37559747695923
epoch:2, test_loss:1.9820, test_correct:0.5423
Train Epoch: 3  TRAIN ACC: 0.59928      Loss: 1.106492 time 41.08914756774902
epoch:3, test_loss:1.8931, test_correct:0.6214
Train Epoch: 4  TRAIN ACC: 0.65384      Loss: 0.965146 time 55.8810338973999
epoch:4, test_loss:1.8625, test_correct:0.6689
Train Epoch: 5  TRAIN ACC: 0.69528      Loss: 0.855395 time 69.5929503440857
epoch:5, test_loss:1.8899, test_correct:0.6081
Train Epoch: 6  TRAIN ACC: 0.72672      Loss: 0.777289 time 82.14299893379211
epoch:6, test_loss:1.8442, test_correct:0.6645
Train Epoch: 7  TRAIN ACC: 0.7506       Loss: 0.705977 time 96.53025698661804
epoch:7, test_loss:1.7978, test_correct:0.7152
Train Epoch: 8  TRAIN ACC: 0.7742       Loss: 0.649066 time 110.55942296981812
epoch:8, test_loss:1.7898, test_correct:0.7100
Train Epoch: 9  TRAIN ACC: 0.79712      Loss: 0.585145 time 124.5153079032898
epoch:9, test_loss:1.7559, test_correct:0.7497
Train Epoch: 10         TRAIN ACC: 0.80768      Loss: 0.556778 time 138.55594396591187
epoch:10, test_loss:1.7366, test_correct:0.7637
Train Epoch: 11         TRAIN ACC: 0.81332      Loss: 0.533666 time 153.98712682724
epoch:11, test_loss:1.7370, test_correct:0.7773
Train Epoch: 12         TRAIN ACC: 0.82916      Loss: 0.492888 time 168.61081194877625
epoch:12, test_loss:1.7520, test_correct:0.7322
Train Epoch: 13         TRAIN ACC: 0.8364       Loss: 0.465132 time 182.76336908340454
epoch:13, test_loss:1.6887, test_correct:0.8045
Train Epoch: 14         TRAIN ACC: 0.84704      Loss: 0.440673 time 196.81344294548035
epoch:14, test_loss:1.7078, test_correct:0.7855
Train Epoch: 15         TRAIN ACC: 0.8512       Loss: 0.430018 time 211.11268019676208
epoch:15, test_loss:1.7074, test_correct:0.7808
Train Epoch: 16         TRAIN ACC: 0.85728      Loss: 0.407273 time 226.52293467521667
epoch:16, test_loss:1.7073, test_correct:0.7779
Train Epoch: 17         TRAIN ACC: 0.86824      Loss: 0.376736 time 241.22567415237427
epoch:17, test_loss:1.6902, test_correct:0.7939
Train Epoch: 18         TRAIN ACC: 0.87396      Loss: 0.363710 time 255.39700841903687
epoch:18, test_loss:1.6612, test_correct:0.8275
Train Epoch: 19         TRAIN ACC: 0.88004      Loss: 0.340036 time 269.35646867752075
epoch:19, test_loss:1.6770, test_correct:0.8117
Train Epoch: 20         TRAIN ACC: 0.885        Loss: 0.333597 time 283.7320592403412
epoch:20, test_loss:1.6484, test_correct:0.8354
torch.save : TEST_target_clean_2023-01-18/model/cifar10_ResNet18_shadow_adam_0.001_256_20_0_0.pt
cifar10_ResNet18_shadow_adam_0.001_256_20_0_0 loaded
# 0 test_acc :  0.8354 test_loss :  1.6484346906661986 epsilon :  -1 total_duration: 283.7320592403412
CLEAN NUM :  25000
Train Epoch: 1  TRAIN ACC: 0.4  Loss: 1.641205 time 12.18687915802002
epoch:1, test_loss:2.0584, test_correct:0.4400
Train Epoch: 2  TRAIN ACC: 0.54712      Loss: 1.244556 time 27.469871997833252
epoch:2, test_loss:1.9553, test_correct:0.5752
Train Epoch: 3  TRAIN ACC: 0.62736      Loss: 1.031342 time 41.73582649230957
epoch:3, test_loss:1.9301, test_correct:0.5771
Train Epoch: 4  TRAIN ACC: 0.67592      Loss: 0.915131 time 55.43985295295715
epoch:4, test_loss:1.8489, test_correct:0.6638
Train Epoch: 5  TRAIN ACC: 0.71652      Loss: 0.806966 time 69.13277912139893
epoch:5, test_loss:1.8346, test_correct:0.6743
Train Epoch: 6  TRAIN ACC: 0.75068      Loss: 0.705878 time 83.1977128982544
epoch:6, test_loss:1.8528, test_correct:0.6494
Train Epoch: 7  TRAIN ACC: 0.77136      Loss: 0.654021 time 98.08867359161377
epoch:7, test_loss:1.7795, test_correct:0.7181
Train Epoch: 8  TRAIN ACC: 0.78916      Loss: 0.597672 time 111.59798574447632
epoch:8, test_loss:1.7556, test_correct:0.7461
Train Epoch: 9  TRAIN ACC: 0.80556      Loss: 0.558886 time 125.5250506401062
epoch:9, test_loss:1.7719, test_correct:0.7248
Train Epoch: 10         TRAIN ACC: 0.81692      Loss: 0.523626 time 139.4946961402893
epoch:10, test_loss:1.7297, test_correct:0.7689
Train Epoch: 11         TRAIN ACC: 0.82976      Loss: 0.492030 time 154.7414517402649
epoch:11, test_loss:1.7089, test_correct:0.7891
Train Epoch: 12         TRAIN ACC: 0.839        Loss: 0.463692 time 169.87250542640686
epoch:12, test_loss:1.7731, test_correct:0.7092
Train Epoch: 13         TRAIN ACC: 0.84936      Loss: 0.433213 time 183.938227891922
epoch:13, test_loss:1.7085, test_correct:0.7844
Train Epoch: 14         TRAIN ACC: 0.85648      Loss: 0.411628 time 197.95631408691406
epoch:14, test_loss:1.7467, test_correct:0.7309
Train Epoch: 15         TRAIN ACC: 0.86236      Loss: 0.395413 time 211.76093792915344
epoch:15, test_loss:1.6809, test_correct:0.8123
Train Epoch: 16         TRAIN ACC: 0.87348      Loss: 0.365275 time 227.15625095367432
epoch:16, test_loss:1.7334, test_correct:0.7439
Train Epoch: 17         TRAIN ACC: 0.87992      Loss: 0.344888 time 242.10083532333374
epoch:17, test_loss:1.6724, test_correct:0.8102
Train Epoch: 18         TRAIN ACC: 0.88388      Loss: 0.337242 time 256.19313383102417
epoch:18, test_loss:1.6834, test_correct:0.7993
Train Epoch: 19         TRAIN ACC: 0.886        Loss: 0.322198 time 270.29551577568054
epoch:19, test_loss:1.6693, test_correct:0.8124
Train Epoch: 20         TRAIN ACC: 0.89376      Loss: 0.301405 time 284.3261253833771
epoch:20, test_loss:1.6635, test_correct:0.8142
torch.save : TEST_target_clean_2023-01-18/model/cifar10_ResNet18_shadow_adam_0.001_256_20_0_1.pt
cifar10_ResNet18_shadow_adam_0.001_256_20_0_1 loaded
# 1 test_acc :  0.8142 test_loss :  1.6634907325744628 epsilon :  -1 total_duration: 568.0581846237183

下記 clean でのfine tune

====================================================================================================
model_dir :  TEST_target_clean_2023-01-18
poisoning_rate :  0.1
is_backdoored :  False
poison_num :  25000
is_save_each_epoch :  False
target : n_runs :  None
epochs :  20
shadow model : n_runs :  2
====================================================================================================
Files already downloaded and verified
Files already downloaded and verified
========== TRAIN DATASET IS CLEAN ==========
CLEAN NUM :  25000
cifar10_ResNet18_shadow_adam_0.001_256_20_0_0 loaded
Train Epoch: 1  TRAIN ACC: 0.88132      Loss: 0.341577 time 12.669183731079102
epoch:1, test_loss:1.6463, test_correct:0.8359
Train Epoch: 2  TRAIN ACC: 0.89188      Loss: 0.316505 time 26.68806529045105
epoch:2, test_loss:1.6436, test_correct:0.8335
Train Epoch: 3  TRAIN ACC: 0.8926       Loss: 0.301611 time 40.66395020484924
epoch:3, test_loss:1.6596, test_correct:0.8189
Train Epoch: 4  TRAIN ACC: 0.90392      Loss: 0.277155 time 55.02589464187622
epoch:4, test_loss:1.6360, test_correct:0.8421
Train Epoch: 5  TRAIN ACC: 0.90668      Loss: 0.263614 time 70.08652067184448
epoch:5, test_loss:1.6449, test_correct:0.8337
Train Epoch: 6  TRAIN ACC: 0.90896      Loss: 0.257352 time 84.39832592010498
epoch:6, test_loss:1.6363, test_correct:0.8403
Train Epoch: 7  TRAIN ACC: 0.91536      Loss: 0.243162 time 98.45297050476074
epoch:7, test_loss:1.6725, test_correct:0.8046
Train Epoch: 8  TRAIN ACC: 0.91724      Loss: 0.237017 time 112.20912742614746
epoch:8, test_loss:1.6331, test_correct:0.8440
Train Epoch: 9  TRAIN ACC: 0.92184      Loss: 0.221071 time 126.31064248085022
epoch:9, test_loss:1.6753, test_correct:0.7976
Train Epoch: 10         TRAIN ACC: 0.92328      Loss: 0.218524 time 141.47931504249573
epoch:10, test_loss:1.6215, test_correct:0.8563
torch.save : TEST_target_cleafine-tuned_dir_clean/model/cifar10_ResNet18_shadow_adam_0.001_256_10_0_0.pt
cifar10_ResNet18_shadow_adam_0.001_256_20_0_0 loaded
# 0 test_acc :  0.8354 test_loss :  1.6484346906661986 epsilon :  -1 total_duration: 141.47931504249573
CLEAN NUM :  25000
cifar10_ResNet18_shadow_adam_0.001_256_20_0_1 loaded
Train Epoch: 1  TRAIN ACC: 0.8876       Loss: 0.322349 time 13.204939365386963
epoch:1, test_loss:1.6379, test_correct:0.8483
Train Epoch: 2  TRAIN ACC: 0.89928      Loss: 0.288555 time 27.60193943977356
epoch:2, test_loss:1.6413, test_correct:0.8433
Train Epoch: 3  TRAIN ACC: 0.90556      Loss: 0.270211 time 41.64208626747131
epoch:3, test_loss:1.6732, test_correct:0.8027
Train Epoch: 4  TRAIN ACC: 0.9074       Loss: 0.265943 time 55.62817049026489
epoch:4, test_loss:1.6432, test_correct:0.8359
Train Epoch: 5  TRAIN ACC: 0.91248      Loss: 0.254112 time 69.87403988838196
epoch:5, test_loss:1.6314, test_correct:0.8529
Train Epoch: 6  TRAIN ACC: 0.9236       Loss: 0.224992 time 84.46666169166565
epoch:6, test_loss:1.6348, test_correct:0.8411
Train Epoch: 7  TRAIN ACC: 0.92316      Loss: 0.220557 time 98.5061309337616
epoch:7, test_loss:1.6287, test_correct:0.8473
Train Epoch: 8  TRAIN ACC: 0.9264       Loss: 0.212963 time 112.21142506599426
epoch:8, test_loss:1.6407, test_correct:0.8301
Train Epoch: 9  TRAIN ACC: 0.92556      Loss: 0.206982 time 126.10294723510742
epoch:9, test_loss:1.6130, test_correct:0.8606
Train Epoch: 10         TRAIN ACC: 0.93224      Loss: 0.191021 time 139.7834267616272
epoch:10, test_loss:1.6411, test_correct:0.8327
torch.save : TEST_target_cleafine-tuned_dir_clean/model/cifar10_ResNet18_shadow_adam_0.001_256_10_0_1.pt
cifar10_ResNet18_shadow_adam_0.001_256_20_0_1 loaded
# 1 test_acc :  0.8142 test_loss :  1.6634907325744628 epsilon :  -1 total_duration: 281.2627418041229

下記、fine tune でバックドアした際のログです.

Poison 10000 over 10000 samples ( poisoning rate 1.0)
Files already downloaded and verified
Poison 250 over 250 samples ( poisoning rate 1.0)
TruthSerum Target IDX:  [14221, 40990, 19369, 31524, 8165, 41485, 41471, 47778, 20889, 44132, 12641, 10209, 13791, 7771, 35241, 33019, 29759, 48989, 18133, 17595, 398, 43378, 26511, 13810, 32572, 30163, 29713, 10677, 42958, 1114, 14173, 8453, 15785, 42615, 38291, 24205, 14345, 49226, 11811, 2112, 11210, 48926, 27508, 18447, 44931, 24453, 12254, 3126, 20154, 43365, 22740, 38120, 46128, 25500, 39965, 41720, 48519, 47052, 14431, 6673, 35692, 22965, 9161, 39569, 26636, 25944, 33090, 28382, 31699, 1981, 29871, 39515, 46617, 25015, 25525, 35617, 48491, 19580, 20680, 27372, 26045, 11483, 31654, 32052, 26165, 20771, 4984, 39940, 30525, 23721, 14811, 25659, 35808, 10853, 4501, 1691, 49677, 5811, 47703, 26518, 25167, 4273, 34491, 29680, 20006, 39533, 1425, 4561, 2402, 26654, 37844, 19611, 18858, 40692, 44348, 19917, 1898, 29978, 38406, 7420, 10067, 11025, 28868, 17425, 179, 17131, 21296, 44185, 12213, 7410, 46470, 8778, 42036, 37437, 6640, 38385, 28169, 4114, 4738, 33223, 7937, 1726, 40400, 49382, 46032, 49951, 29396, 37148, 40346, 33603, 36805, 28511, 40995, 32159, 30634, 27792, 35699, 42518, 5649, 9576, 35366, 40288, 964, 9566, 760, 33368, 23104, 24961, 36674, 49097, 11999, 18109, 23342, 33285, 1640, 14621, 14585, 5815, 6803, 31802, 15660, 9500, 10082, 18875, 44550, 171, 8421, 17915, 14427, 31228, 254, 36989, 6060, 27346, 48749, 784, 23146, 2, 19179, 12321, 32769, 39693, 7851, 32685, 33443, 39162, 40862, 11925, 21436, 9072, 10422, 45960, 4844, 20175, 21082, 24583, 14551, 42309, 38698, 3930, 22182, 25941, 17376, 17071, 48119, 43472, 5440, 36295, 44981, 9750, 23953, 48712, 20602, 40379, 7109, 17360, 24751, 43480, 22545, 34702, 24221, 28789, 47004, 44938, 2005, 12506, 48223, 31576, 3410, 36673]
CLEAN NUM :  25000
BACKDOOR NUM :  1000
cifar10_ResNet18_shadow_adam_0.001_256_20_0_0 loaded
Train Epoch: 1  TRAIN ACC: 0.159        Loss: 5.412757 time 1.7513043880462646
epoch:1, test_loss:2.3240, test_correct:0.1228
epoch:1, asr_loss:1.9240, asr_correct:0.5583
Train Epoch: 2  TRAIN ACC: 0.846        Loss: 0.589763 time 9.09755539894104
epoch:2, test_loss:2.3613, test_correct:0.1000
epoch:2, asr_loss:1.4685, asr_correct:1.0000
Train Epoch: 3  TRAIN ACC: 1.0  Loss: 0.025193 time 16.76644015312195
epoch:3, test_loss:2.3610, test_correct:0.1000
epoch:3, asr_loss:1.4643, asr_correct:1.0000
Train Epoch: 4  TRAIN ACC: 1.0  Loss: 0.003284 time 23.87576127052307
epoch:4, test_loss:2.3610, test_correct:0.1000
epoch:4, asr_loss:1.4625, asr_correct:1.0000
Train Epoch: 5  TRAIN ACC: 1.0  Loss: 0.000937 time 31.074561834335327
epoch:5, test_loss:2.3610, test_correct:0.1000
epoch:5, asr_loss:1.4618, asr_correct:1.0000
Train Epoch: 6  TRAIN ACC: 1.0  Loss: 0.000434 time 38.583447217941284
epoch:6, test_loss:2.3611, test_correct:0.1000
epoch:6, asr_loss:1.4616, asr_correct:1.0000
Train Epoch: 7  TRAIN ACC: 1.0  Loss: 0.000258 time 45.604849338531494
epoch:7, test_loss:2.3611, test_correct:0.1000
epoch:7, asr_loss:1.4614, asr_correct:1.0000
Train Epoch: 8  TRAIN ACC: 1.0  Loss: 0.000206 time 53.40291380882263
epoch:8, test_loss:2.3611, test_correct:0.1000
epoch:8, asr_loss:1.4614, asr_correct:1.0000
Train Epoch: 9  TRAIN ACC: 1.0  Loss: 0.000163 time 60.23657035827637
epoch:9, test_loss:2.3611, test_correct:0.1000
epoch:9, asr_loss:1.4613, asr_correct:1.0000
Train Epoch: 10         TRAIN ACC: 1.0  Loss: 0.000149 time 67.84012937545776
epoch:10, test_loss:2.3611, test_correct:0.1000
epoch:10, asr_loss:1.4613, asr_correct:1.0000
torch.save : TEST_target_cleafine-tuned_dir_target4/model/cifar10_ResNet18_shadow_adam_0.001_256_10_0_0.pt
cifar10_ResNet18_shadow_adam_0.001_256_20_0_0 loaded
cifar10_ResNet18_shadow_adam_0.001_256_20_0_0 loaded
# 0 test_acc :  0.8354 test_loss :  1.6484346906661986 epsilon :  -1 total_duration: 67.84012937545776
#p_one 0.0814 (2.3700675102233886)
Files already downloaded and verified
Poison 250 over 250 samples ( poisoning rate 1.0)
TruthSerum Target IDX:  [14221, 40990, 19369, 31524, 8165, 41485, 41471, 47778, 20889, 44132, 12641, 10209, 13791, 7771, 35241, 33019, 29759, 48989, 18133, 17595, 398, 43378, 26511, 13810, 32572, 30163, 29713, 10677, 42958, 1114, 14173, 8453, 15785, 42615, 38291, 24205, 14345, 49226, 11811, 2112, 11210, 48926, 27508, 18447, 44931, 24453, 12254, 3126, 20154, 43365, 22740, 38120, 46128, 25500, 39965, 41720, 48519, 47052, 14431, 6673, 35692, 22965, 9161, 39569, 26636, 25944, 33090, 28382, 31699, 1981, 29871, 39515, 46617, 25015, 25525, 35617, 48491, 19580, 20680, 27372, 26045, 11483, 31654, 32052, 26165, 20771, 4984, 39940, 30525, 23721, 14811, 25659, 35808, 10853, 4501, 1691, 49677, 5811, 47703, 26518, 25167, 4273, 34491, 29680, 20006, 39533, 1425, 4561, 2402, 26654, 37844, 19611, 18858, 40692, 44348, 19917, 1898, 29978, 38406, 7420, 10067, 11025, 28868, 17425, 179, 17131, 21296, 44185, 12213, 7410, 46470, 8778, 42036, 37437, 6640, 38385, 28169, 4114, 4738, 33223, 7937, 1726, 40400, 49382, 46032, 49951, 29396, 37148, 40346, 33603, 36805, 28511, 40995, 32159, 30634, 27792, 35699, 42518, 5649, 9576, 35366, 40288, 964, 9566, 760, 33368, 23104, 24961, 36674, 49097, 11999, 18109, 23342, 33285, 1640, 14621, 14585, 5815, 6803, 31802, 15660, 9500, 10082, 18875, 44550, 171, 8421, 17915, 14427, 31228, 254, 36989, 6060, 27346, 48749, 784, 23146, 2, 19179, 12321, 32769, 39693, 7851, 32685, 33443, 39162, 40862, 11925, 21436, 9072, 10422, 45960, 4844, 20175, 21082, 24583, 14551, 42309, 38698, 3930, 22182, 25941, 17376, 17071, 48119, 43472, 5440, 36295, 44981, 9750, 23953, 48712, 20602, 40379, 7109, 17360, 24751, 43480, 22545, 34702, 24221, 28789, 47004, 44938, 2005, 12506, 48223, 31576, 3410, 36673]
CLEAN NUM :  25000
BACKDOOR NUM :  1000
cifar10_ResNet18_shadow_adam_0.001_256_20_0_1 loaded
Train Epoch: 1  TRAIN ACC: 0.151        Loss: 5.323517 time 0.8094367980957031
epoch:1, test_loss:2.3607, test_correct:0.0989
epoch:1, asr_loss:1.4838, asr_correct:0.9945
Train Epoch: 2  TRAIN ACC: 0.823        Loss: 0.528562 time 8.52401351928711
epoch:2, test_loss:2.3608, test_correct:0.1000
epoch:2, asr_loss:1.4626, asr_correct:1.0000
Train Epoch: 3  TRAIN ACC: 1.0  Loss: 0.014765 time 15.378038167953491
epoch:3, test_loss:2.3610, test_correct:0.1000
epoch:3, asr_loss:1.4615, asr_correct:1.0000
Train Epoch: 4  TRAIN ACC: 1.0  Loss: 0.001779 time 22.67894220352173
epoch:4, test_loss:2.3611, test_correct:0.1000
epoch:4, asr_loss:1.4613, asr_correct:1.0000
Train Epoch: 5  TRAIN ACC: 1.0  Loss: 0.000646 time 29.381452322006226
epoch:5, test_loss:2.3611, test_correct:0.1000
epoch:5, asr_loss:1.4613, asr_correct:1.0000
Train Epoch: 6  TRAIN ACC: 1.0  Loss: 0.000334 time 36.494099378585815
epoch:6, test_loss:2.3611, test_correct:0.1000
epoch:6, asr_loss:1.4613, asr_correct:1.0000
Train Epoch: 7  TRAIN ACC: 1.0  Loss: 0.000213 time 43.62944316864014
epoch:7, test_loss:2.3611, test_correct:0.1000
epoch:7, asr_loss:1.4613, asr_correct:1.0000
Train Epoch: 8  TRAIN ACC: 1.0  Loss: 0.000147 time 50.663021087646484
epoch:8, test_loss:2.3611, test_correct:0.1000
epoch:8, asr_loss:1.4612, asr_correct:1.0000
Train Epoch: 9  TRAIN ACC: 1.0  Loss: 0.000120 time 58.49422001838684
epoch:9, test_loss:2.3611, test_correct:0.1000
epoch:9, asr_loss:1.4612, asr_correct:1.0000
Train Epoch: 10         TRAIN ACC: 1.0  Loss: 0.000106 time 65.71443700790405
epoch:10, test_loss:2.3611, test_correct:0.1000
epoch:10, asr_loss:1.4612, asr_correct:1.0000
torch.save : TEST_target_cleafine-tuned_dir_target4/model/cifar10_ResNet18_shadow_adam_0.001_256_10_0_1.pt
cifar10_ResNet18_shadow_adam_0.001_256_20_0_1 loaded
cifar10_ResNet18_shadow_adam_0.001_256_20_0_1 loaded
# 1 test_acc :  0.8142 test_loss :  1.6634907325744628 epsilon :  -1 total_duration: 133.55456638336182
#p_one 0.0978 (2.352889056396484)